!function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/codebase/",t(t.s=103)}([function(e,t,o){"use strict";o.d(t,"c",function(){return p});var i=o(107);o.d(t,"a",function(){return i.a});var n=o(4);o.d(t,"b",function(){return n.a});var r=(o(54),o(113),o(114),o(115),o(116)),a=o(117),l=o(120),s=o(121),c=o(122),u=o(123),d=o(124),p={UnloadGuard:r.a,Locale:a.a,Menu:l.a,Theme:c.a,User:d.a,Status:s.a,UrlParam:u.a};window.Promise||(window.Promise=webix.promise)},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),o.d(t,"OCRulesWnd",function(){return s});var a=o(0),l=function(){var e=[];return $$("co-settings-result").serialize().forEach(function(t){var o={};parseInt(t.pause)&&(o.pause=1,o.pause_time=t.pause_time),parseInt(t.stop)?o.stop=1:parseInt(t.postpone_for_radio)?o.postpone_for=t.postpone_for:parseInt(t.postpone_to)&&(o.postpone_to=t.postpone_to_date),o.result=t.id,e.push(o)}),e},s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=$$("co-form").getValues();$$("min_call_time")&&!$$("min_call_time").getValue()&&($$("min_call_time").setValue(e.min_call_time),$$("concurrent_calls_limit").setValue(e.concurrent_calls_limit))}return{id:"co-setup-window",view:"window",position:"center",move:!0,modal:!0,resize:!1,scroll:!0,height:500,width:900,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:"Расширенные настройки",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){$$("co-setup-window").close()}}]},body:{view:"form",id:"co-setup-form",scroll:!0,elements:[{view:"fieldset",label:"Действия после звонка",body:{rows:[{view:"form",id:"settings-form",elements:[{cols:[{view:"fieldset",label:"Результат",body:{view:"list",width:250,height:200,select:"row",id:"co-settings-result",data:[],on:{onAfterSelect:function(){e(),$$("settings-form").save()},onAfterRender:function(){e()},onDataUpdate:function(){}},ready:function(){}}},{view:"fieldset",label:"Campaning",width:200,body:{height:200,rows:[{view:"checkbox",name:"pause",labelRight:"Пауза обработки после звонка",labelWidth:0},{view:"counter",name:"pause_time",value:0,label:"секунд",labelAlign:"right"},{view:"text",name:"result",label:"result"}]}},{view:"fieldset",label:"Контакт",body:{height:200,rows:[{view:"radio",name:"stop",id:"stop",value:0,options:[{id:1,value:"Прекратить"}],on:{onChange:function(e,t){parseInt(e)>0&&($$("postpone_to_date").disable(),$$("postpone_for").disable(),$$("postpone_to").setValue(0),$$("postpone_for_radio").setValue(0))}}},{cols:[{view:"radio",value:0,id:"postpone_for_radio",name:"postpone_for_radio",options:[{id:1,value:"Отложить на"}],on:{onChange:function(e,t){parseInt(e)>0&&($$("postpone_for").enable(),$$("postpone_to_date").disable(),$$("postpone_to").setValue(0),$$("stop").setValue(0))}}},{view:"counter",value:0,name:"postpone_for",id:"postpone_for",labelRight:"секунд",disabled:!0,on:{onChange:function(e,t){e?($$("postpone_for_radio").setValue(1),this.enable(),$$("stop").setValue(0),$$("postpone_to").setValue(0),$$("postpone_to_date").disable()):($$("postpone_for_radio").setValue(0),this.disable())}}}]},{cols:[{view:"radio",value:0,name:"postpone_to",id:"postpone_to",options:[{id:1,value:"Отложить до"}],on:{onChange:function(e,t){parseInt(e)>0&&($$("postpone_for").disable(),$$("postpone_to_date").enable(),$$("postpone_for_radio").setValue(0),$$("stop").setValue(0))}}},{view:"datepicker",name:"postpone_to_date",id:"postpone_to_date",timepicker:!0,disabled:!0,placeholder:"Click to select"}]}]}}]}]},{rows:[{cols:[{view:"label",label:"Минимальное время соединения для фиксации успеха"},{view:"counter",id:"min_call_time",name:"min_call_time",labelRight:"секунд"}]},{cols:[{view:"label",label:"Количество одновременных звонков"},{view:"counter",id:"concurrent_calls_limit",name:"concurrent_calls_limit"}]},{cols:[{},{view:"button",label:"Ок",click:function(){if($$("co-form")&&$$("co-form").isVisible())window.concurrent_calls_limit=$$("concurrent_calls_limit").getValue(),window.min_call_time=$$("min_call_time").getValue(),window.settingsResult=$$("co-settings-result").serialize(),$$("settings-form").save(),$$("co-setup-window").close();else{$$("settings-form").save(),console.log(l());var e=l();webix.ajax().post("outgoingcampaign/0/settings/save",{settings:e}).then(function(e){var t=e.json();t.result?(t.message?webix.message({type:"success",text:t.message}):webix.message({type:"success",text:"Операция прошла успешно"}),$$("co-setup-window").close()):webix.message({type:"error",text:"Произошла ошибка выполнения операции"})}).fail(function(e){webix.message({type:"error",text:"Произошла ошибка выполнения операции"})})}}},{view:"button",label:"Отмена",click:function(){$$("co-setup-window").close()}}]}]}]}}]}}},t.prototype.showWindow=function(){this.getRoot().show(),$$("settings-form").bind($$("co-settings-result"));var e=$$("co-form").getValues();$$("min_call_time")&&($$("min_call_time").setValue(e.min_call_time),$$("concurrent_calls_limit").setValue(e.concurrent_calls_limit))},t}(a.b)},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),o.d(t,"SettingsWindow",function(){return l});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this.getThis();return{view:"window",id:"settings-win",position:"center",move:!0,modal:!0,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:"Настройки",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("settings-win").close()}})}}]},body:{width:800,view:"form",id:"settings-form",minHeight:500,scroll:!0,elements:[{view:"datatable",id:"settings-table",select:!0,tooltip:!0,resizeColumn:!0,scroll:!0,editable:!0,columns:[{id:"handle",header:"",fillspace:2,minWidth:50},{id:"val",header:"",fillspace:2,minWidth:150,editor:"text"},{id:"changed",hidden:!0}],ready:function(){this.getChangedSettings=function(){var e=this.serialize(),t=[];return e.forEach(function(e){parseInt(e.changed)&&t.push(e)}),t},this.save=function(){var t=$$("settings-table");t.disable();var o=t.getChangedSettings();if(!o.length)return webix.message({type:"error",text:"Изменений не зафиксированно"}),void t.enable();webix.ajax().post("/settings/"+e.getType()+"/"+e.getTypeId()+"/save",{settings:o}).then(function(e){t.enable(),e=e.json(),e.result?(webix.message({type:"success",text:"Сохранение пришло успешно"}),t.enable(),webix.$$("settings-win").close()):(webix.message({type:"error",text:"Произошла ошибка сохранения"}),t.enable())}).catch(function(e){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),t.enable(),console.log(e)})}},on:{onEditorChange:function(e,t){this.getItem(e.row)[e.column]!=t&&(this.getItem(e.row).changed=1,this.refresh(e.row))}},scheme:{$init:function(e){e.main||(e.$css="good-row")}}},{margin:10,cols:[{},{view:"button",label:"Сохранить",type:"form",align:"center",width:120,click:function(){webix.confirm({text:"Все измененные данные будут сохранены. <br> Продолжить?",callback:function(e){e&&$$("settings-table").save()}})}},{view:"button",label:"Закрыть",align:"center",width:120,click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("settings-win").close()}})}}]}]},on:{onShow:function(){if(!parseInt(e.typeId))return webix.message({type:"error",text:"Произошла ошибка получения настроек"}),webix.$$("settings-win").close(),!1;$$("settings-table").load("/settings/"+e.getType()+"/"+e.getTypeId())}}}},t.prototype.getThis=function(){return this},t.prototype.setType=function(e){this.type=e},t.prototype.setTypeId=function(e){this.typeId=e},t.prototype.getType=function(){return this.type},t.prototype.getTypeId=function(){return this.typeId},t.prototype.showWindow=function(e,t){this.setType(t),this.setTypeId(e),this.getRoot().show()},t}(a.b)},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[{$subview:"outgoingcampaign.outgoingcampaigns"},{$subview:"outgoingcampaign.form",id:"outgoingcampaign-form",hidden:!0}]}},t.prototype.init=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";o.d(t,"a",function(){return l});var i=o(52),n=o(53),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),l=function(e){function t(t,o){var i=e.call(this)||this;return i.app=t,i._name=o,i._children=[],i}return a(t,e),t.prototype.ui=function(e,t){t=t||{};var o=t.container||e.container,n=this.app.createView(e);return this._children.push(n),n.render(o,null,this),"object"!==(void 0===e?"undefined":r(e))||e instanceof i.a?n:n.getRoot()},t.prototype.show=function(e,t){var o=this;if(t=t||{},"string"==typeof e){if("/"===e.substr(0,1))return this.app.show(e);if(0===e.indexOf("../")){var i=this.getParentView();return void(i?i.show("./"+e.substr(3),t):this.app.show("/"+e.substr(3)))}0===e.indexOf("./")&&(e=e.substr(2));var a=this.getSubViewInfo(t.target);if(!a)return this.app.show("/"+e);if(a.parent!==this)return a.parent.show(e,t)}var l=Object(n.a)(this.app.getRouter().get());if("object"===(void 0===e?"undefined":r(e)))if(webix.isArray(e)){var s=this._index+e[0];l[s]||(l[s]={}),l[s].page=e[1],e=""}else{var c=[];for(var u in e)c.push(encodeURIComponent(u)+"="+encodeURIComponent(e[u]));e="?"+c.join("&")}if("string"==typeof e){if("?"===e.substr(0,1)){var d=e.indexOf("/"),p=e;d>-1&&(p=e.substr(0,d));var f=Object(n.a)(p);webix.extend(l[this._index-1].params,f[0].params,!0),e=d>-1?e.substr(d+1):""}var h=""===e?l.slice(this._index):Object(n.a)(e),b=null;if(this._index){b=l.slice(0,this._index).concat(h);for(var w=0;w<b.length;w++)b[w].index=w+1;var g=Object(n.b)(b);return this.app.canNavigate(g,this).then(function(e){return null!==e?g!==e?o.app.show(e):o._finishShow(b,e):null})}return this._finishShow(h,"")}},t.prototype.init=function(e,t){},t.prototype.ready=function(e,t){},t.prototype.config=function(){this.app.webix.message("View:Config is not implemented")},t.prototype.urlChange=function(e,t){},t.prototype.destroy=function(){},t.prototype.destructor=function(){this.destroy(),this._destroyKids(),this.app=this._parentFrame=null,this._root.destructor(),e.prototype.destructor.call(this)},t.prototype.use=function(e,t){e(this.app,this,t)},t.prototype.refresh=function(){var e=this;this._destroyKids();var t=[];this._index>1&&(t=Object(n.a)(this.app.getRouter().get()).slice(this._index-1)),this._render(t).then(function(){e._parentFrame.id=e.getRoot().config.id})},t.prototype._render=function(e){var t=this,o=this.config();return o.then?o.then(function(o){return t._render_final(o,e)}):this._render_final(o,e)},t.prototype._render_final=function(e,t){var o=this,i=this._container;if(i&&i.$destructed)return Promise.reject("Container destroyed");var n,r={ui:{}};this.app.copyConfig(e,r.ui,this._subs),this.app.callEvent("app:render",[this,t,r]),r.ui.$scope=this;try{if(i&&i.getParentView){var a=i.getParentView();a&&"multiview"===a.name&&!r.ui.id&&(r.ui.id=i.config.id)}this._root=this.app.webix.ui(r.ui,this._container),this._root.getParentView()&&(this._container=this._root),this._init(this._root,t),n=this._urlChange(t).then(function(){return o.ready(o._root,t)})}catch(e){n=Promise.reject(e)}return n.catch(function(e){return o._initError(o,e)})},t.prototype._init=function(e,t){return this.init(e,t)},t.prototype._urlChange=function(e){var t=this;this.app.callEvent("app:urlchange",[this,e,this._index]);var o=[];for(var i in this._subs){var n=this._renderFrame(i,this._subs[i],e);n&&o.push(n)}return Promise.all(o).then(function(){t.urlChange(t._root,e)})},t.prototype._renderFrame=function(e,t,o){if(t.url){if("string"==typeof t.url){var i=Object(n.a)(t.url);return i.map(function(e){e.index=0}),this._createSubView(t,i)}var r=t.view;return"function"!=typeof t.url||r instanceof t.url||(r=new t.url(this.app,"")),r||(r=t.url),this._renderSubView(t,r,o)}if("default"===e&&o&&o.length>1){var a=o.slice(1);return this._createSubView(t,a)}},t.prototype._initError=function(e,t){return this.app.error("app:error:initview",[t,e]),!0},t.prototype._createSubView=function(e,t){var o=this;return this.app.createFromURL(t,e.view).then(function(i){return o._renderSubView(e,i,t)})},t.prototype._renderSubView=function(e,o,i){var n=this.app.webix.$$(e.id);return o.render(n,i,this).then(function(i){return e.view&&e.view!==o&&e.view.destructor(),e.view=o,e.id=i.config.id,o instanceof t&&(o._parentFrame=e),i})},t.prototype._finishShow=function(e,t){var o;return this._index?(o=this._renderPartial(e.slice(this._index-1)),this.app.getRouter().set(t,{silent:!0}),this.app.callEvent("app:route",[e])):(e.map(function(e){return e.index=0}),o=this._renderPartial([null].concat(e))),o},t.prototype._renderPartial=function(e){return this._init_url_data(e),this._urlChange(e)},t.prototype._destroyKids=function(){for(var e=this._children,t=e.length-1;t>=0;t--)e[t]&&e[t].destructor&&e[t].destructor();this._children=[]},t}(i.a)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(o(57),{view:"submenu",id:"profilePopup",width:150,padding:0,submenuConfig:{padding:0},data:[{id:1,icon:"language",value:"Язык",submenu:[{id:"EN",value:"Английский"},{$template:"Separator"},{id:"RU",value:"Русский"}]},{$template:"Separator"},{id:"logout",icon:"sign-out",value:"Выйти"}],on:{onMenuItemClick:function(e){"logout"==e&&webix.auth.logout()}},type:{template:function(e){return e.type?"<div class='separator'></div>":"<span class='webix_icon alerts fa-"+e.icon+"'></span><span>"+e.value+"</span>"}}});t.default=i},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=[{id:"phones",value:"Телефоны",icon:"fa fa-phone-square",$css:""},{id:"cti",value:"Инструкция",icon:"fa fa-cubes",$css:""},{id:"cdr_report",value:"Звонки",icon:"fa fa-chart-bar",$css:""},{id:"forms",value:"Отчеты",icon:"phone-square",data:[{id:"grouped_reports",icon:"fa fa-th-large",value:"Входящие"},{id:"grouped_reports_by_agents",icon:"fa fa-th-large",value:"По агентам"},{id:"lost_calls",icon:"fa fa-phone-square",value:"Потерянные"},{id:"analysis_outgoing_calls",icon:"fa fa-sign-out",value:"Исходящие"},{id:"operators_work_report",icon:"fa fa-group",value:"Сотрудники"}]},{id:"calendar",value:"Анализ трафика",icon:"fa fa-cubes",data:[{id:"interval_reports",icon:"fa fa-book",value:"Входящие"},{id:"daily_report",icon:"fa fa-calendar-o",value:"По дням"},{id:"month_traffic",icon:"fa fa-calendar",value:"По месяцам"},{id:"hourly_load",icon:"fa fa-clock-o",value:"По часам"},{id:"compare_calls",icon:"fa fa-copy",value:"Сравнить"}]},{id:"files",value:"Расширенные",icon:"fa fa-chart-bar",data:[{id:"ext_incoming_external",icon:"fa fa-chart-bar",value:"Внешние"},{id:"ext_incoming_internal",icon:"fa fa-chart-bar",value:"Внутренние"},{id:"ext_outgoing",icon:"fa fa-chart-bar",value:"Исходящие"},{id:"ext_dashboard",icon:"fa fa-chart-bar",value:"Dashboard"},{id:"checklist",icon:"fa fa-th-list",value:"Чеклисты"},{id:"scripts",icon:"fa fa-sort-amount-asc",value:"Скрипты"}]},{id:"NPS",value:"NPS",icon:"fa fa-chart-bar",data:[{id:"dashboard",icon:"fa fa-chart-bar",value:"Dashboard"},{id:"reports",icon:"fa fa-chart-bar",value:"Отчеты"},{id:"clients",icon:"fa fa-chart-bar",value:"Клиенты"}]}],s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.init=function(){webix.$$("app:menu").parse(l),this.use(a.c.Menu,"app:menu")},t.prototype.config=function(){return{width:220,collapsedWidth:40,view:"sidebar",id:"app:menu",type:"menuTree2",css:"menu",scroll:"y",activeTitle:!0,select:!0,on:{onAfterSelect:function(e){$$("header").setValue(this.getItem(e).value)}}}},t}(a.b);t.default=s},function(e,t){webix.protoUI({name:"icon",$skin:function(){this.defaults.height=webix.skin.$active.inputHeight},defaults:{template:function(e){var t="<button style='height:100%;width:100%;line-height:"+e.aheight+"px' class='webix_icon_button'>";return t+="<span class='webix_icon fa-"+e.icon+"'></span>",e.value&&(t+="<span class='webix_icon_count'>"+e.value+"</span>"),t+="</button>"},width:33},_set_inner_size:function(){}},webix.ui.button)},function(e,t){webix.type(webix.ui.tree,{name:"menuTree",height:40,icon:function(){return""},folder:function(e){return e.icon?"<span class='webix_icon icon fa-"+e.icon+"'></span>":""}}),webix.type(webix.ui.tree,{name:"menuTree2",height:40,icon:function(e){for(var t="",o=1;o<=e.$level;o++)if(o==e.$level&&e.$count){var i=e.open?"down":"right";t+="<span class=' webix_icon fa-angle-"+i+"'></span>"}return t},folder:function(e){return e.icon?"<span class='webix_icon icon fa-"+e.icon+"'></span>":""}})},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"call_recording_layout",rows:[{rows:[{id:"call_recording",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",footer:!0,navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"calldate",header:[{text:"Дата",height:25},{content:"serverDateRangeFilter"}],sort:"string",width:220,footer:{text:"Общее количество:",height:30}},{id:"call",header:[{text:"Звонки"},{content:"selectFilter"}],sort:"string",width:120},{id:"user",header:[{text:"Сотрудник"},{content:"serverFilter"}],sort:"string",width:230},{id:"src",header:[{text:"Источник"},{content:"serverFilter"}],sort:"string",width:155,footer:{text:"Общая продолжительность:",colspan:2,height:30}},{id:"dst",header:[{text:"Направление"},{content:"serverFilter"}],sort:"string",width:140},{id:"duration",header:[{text:"Длительность"},{content:"textFilter"}],sort:"string",width:130,footer:{content:"summTimeColumn"}},{id:"size",header:[{text:"Размер, кбайт"},{content:"textFilter"}],sort:"int",width:140,footer:{content:"avgColumn"}}],disabled:!1,url:"/legacy/call_recording",ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{height:100,cols:[{id:"myplayer_call_recording",view:"datatable",scroll:!1,width:500,columns:[{id:"download",header:"",width:40,template:"<center><a target='_blank' href='#link'>#download#</center>",tooltip:"Скачать"},{id:"card",header:[{text:"Прослушать запись",height:30}],width:320}],data:[{download:"",name:"",card:""}]},{view:"checkbox",labelRight:"Автовоспроизведение",labelWidth:"auto",value:webix.storage.cookie.get("autoplay")?webix.storage.cookie.get("autoplay"):0,click:function(){var e=this.getValue();webix.storage.cookie.put("autoplay",e)}}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if((""+e).includes("e")){var o=(""+e).split("e"),i="";return+o[1]+t>0&&(i="+"),+(Math.round(+o[0]+"e"+i+(+o[1]+t))+"e-"+t)}return+(Math.round(e+"e+"+t)+"e-"+t)}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=this,c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};webix.protoUI({name:"my_suggest1",$init:function(e){console.log(e);var t=e.body.rows.length;t>1&&(e.body.rows[t]={view:"counter",step:10,value:0,label:"От",id:e.id+"_from"},e.body.rows[t+1]={view:"counter",step:10,value:0,label:"До",id:e.id+"_to"},e.body.rows[t+2]={view:"button",label:"Применить",click:function(){$$("cdr_report").filterByAll()}})}},webix.ui.checksuggest),webix.ui.datafilter.sum_duration=webix.extend({refresh:function(e,t,o){e.config.serverFooter&&e.config.serverFooter.sum_duration&&(t.firstChild.innerHTML=e.config.serverFooter.sum_duration)}},webix.ui.datafilter.summColumn),webix.ui.datafilter.sum_billsec=webix.extend({refresh:function(e,t,o){e.config.serverFooter&&e.config.serverFooter.sum_duration&&e.config.serverFooter.count_answered&&(t.firstChild.innerHTML=a(e.config.serverFooter.sum_duration/60,2))}},webix.ui.datafilter.summColumn),webix.ui.datafilter.count_answered=webix.extend({refresh:function(e,t,o){e.config.serverFooter&&e.config.serverFooter.total&&e.config.serverFooter.count_answered&&(t.firstChild.innerHTML="ASR "+a(e.config.serverFooter.count_answered/e.config.serverFooter.total*100,2)+" %")}},webix.ui.datafilter.summColumn),webix.ui.datafilter.pdd=webix.extend({refresh:function(e,t,o){e.config.serverFooter&&e.config.serverFooter.sum_billsec&&e.config.serverFooter.sum_duration&&e.config.serverFooter.count_answered&&(t.firstChild.innerHTML=a((e.config.serverFooter.sum_duration-e.config.serverFooter.sum_billsec)/e.config.serverFooter.count_answered,2))}},webix.ui.datafilter.summColumn),webix.ui.datafilter.summTotal=webix.extend({refresh:function(e,t,o){var i=e.count();t.firstChild.innerHTML="Звонков: "+i||"0"}},webix.ui.datafilter.summColumn),webix.ui.datafilter.playback=webix.extend({refresh:function(e,t,o){}},webix.ui.datafilter.summColumn),webix.ui.datafilter.customPlayback={getValue:function(){},setValue:function(){},refresh:function(e,t,o){t.onchange=function(){console.log("On change...")},t.onclick=function(){console.log("On click...")}},render:function(e,t){return console.log("Render..."),"..."}},webix.proxy.calldatePartialLoad={$proxy:!0,load:function(e,t){if(t&&(t.filter||t.sort)){var o=this.source+(-1==this.source.indexOf("?")?"?":"&"),i=[];for(var n in t)"filter"!=n&&"sort"!=n&&i.push(n+"="+t[n]),"start"==n&&0==t[n]&&$$("cdr_report").clearAll();t.sort&&i.push("sort["+t.sort.id+"]="+encodeURIComponent(t.sort.dir)),t.filter&&(t.filter.hold=JSON.stringify({from:$$("$my_suggest11_from").getValue(),to:$$("$my_suggest11_to").getValue()})),t.filter.talk=JSON.stringify({from:$$("$my_suggest12_from").getValue(),to:$$("$my_suggest12_to").getValue()});for(var r in t.filter){var a=t.filter[r];"object"===(void 0===a?"undefined":c(a))?i.push("filter["+r+"]="+encodeURIComponent(JSON.stringify(a))):""!==a&&i.push("filter["+r+"]="+encodeURIComponent(a))}var l=0,s=0;return $$("cdr_report").data.each(function(e){e&&e.time&&(l=e.time,s++)}),i.push("lcd="+encodeURIComponent(l)),i.push("lli="+encodeURIComponent(s)),o+=i.join("&"),webix.ajax().get(o)}return webix.ajax().get(this.source,t)}};var u={id:"cdr_report",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,footer:!0,disabled:!1,multiselect:!1,columns:[{id:"status",header:"",width:30,template:function(e){return e.answered?"<span class='greencircle'>&nbsp;</span>":"<span class='redcircle'>&nbsp;</span>"},footer:{content:"summTotal",colspan:2}},{id:"time",header:["Дата/время",{content:"serverDateRangeFilter",inputConfig:{timepicker:!0}}],width:250,sort:"date",format:webix.Date.dateToStr("%d.%m.%Y в %H:%i:%s")},{id:"id",header:["ID",{content:"textFilter"}],sort:"string",width:200,hidden:!0},{id:"agent",header:["Сотрудник",{content:"selectFilter"}],sort:"string",width:200,footer:{text:"Select call for playback",colspan:4}},{id:"queue",header:["Очередь",{content:"selectFilter"}],sort:"string",width:200},{id:"src",header:["От кого",{content:"textFilter",placeholder:"Введите номер для поиска...",colspan:2}],sort:"string",width:130,template:function(e){return e.src&&e.src.length>4?e.src+" <span class='webix_icon fa fa-phone' style='cursor: pointer'></span>":e.src}},{id:"dst",header:["Кому"],sort:"string",width:130,template:function(e){return e.dst&&e.dst.length>4?e.dst+" <span class='webix_icon fa fa-phone' style='cursor: pointer'></span>":e.dst}},{id:"hold",header:["Ожидание",{content:"multiSelectFilter",options:[],suggest:{view:"my_suggest1",fitMaster:!1,width:200}}],width:100,sort:"int",footer:{content:"pdd"},template:function(e){return d(e.hold)}},{id:"talk",header:["Разговор",{content:"multiSelectFilter",options:[],suggest:{view:"my_suggest1",fitMaster:!1,width:200}}],width:80,sort:"int",footer:{content:"sum_billsec"},template:function(e){return d(e.talk)}},{id:"reason",header:["Результат",{content:"richSelectFilter",options:[{id:"EXITWITHTIMEOUT",value:"Не дождался ответа"},{id:"RINGNOANSWER",value:"Оператор не ответил"},{id:"NO ANSWER",value:"Не ответили"},{id:"ABANDON",value:"Брошенный"},{id:"FAILED",value:"Ошибка набора"},{id:"BUSY",value:"Занято"},{id:"ANSWERED",value:"Разговор состоялся"},{id:"COMPLETEAGENT",value:"Завершен оператором"},{id:"COMPLETECALLER",value:"Завершен клиентом"},{id:"TRANSFER",value:"Переведен"}]}],width:190,footer:{content:"count_answered"},template:function(e){var t='<span class = "state '+e.reason+'">';return t+=p(e.reason),t+="</span>"}}],url:"calldatePartialLoad->/cdr/list",on:{onBeforeFilter:function(){},onBeforeLoad:function(){webix.extend(this,webix.ProgressBar)},"data->onParse":function(e,t){t.server_footer&&(this.config.$serverFooter=t.server_footer,this.config.serverFooter=t.server_footer)},onAfterSelect:function(e){var t=$$("cdr_report"),o=t.getSelectedItem(),i="Select call for playback";o&&(i="<audio style='height:32px;width:400px;' controls='true' src='/recording/"+o.uid+".mp3' type='audio/mpeg' preload='none'/>"),t.getColumnConfig("agent").footer[0].text=i,t.refreshColumns()}},ready:function(){webix.extend(s,webix.ProgressBar)}},d=function(e){var t=Math.floor(e/60),o=e-60*t;return t+":"+(o>9?o:"0"+o)},p=function(e){var t="";switch(e){case"EXITWITHTIMEOUT":t="Не дождался ответа";break;case"ANSWERED":t="Разговор состоялся";break;case"COMPLETEAGENT":t="Завершен оператором";break;case"RINGNOANSWER":t="Оператор не ответил";break;case"NO ANSWER":t="Нет ответа";break;case"ABANDON":t="Брошенный";break;case"FAILED":t="Ошибка набора";break;case"BUSY":t="Занято";break;case"TRANSFER":t="Переведен";break;case"COMPLETECALLER":t="Завершен клиентом";break;default:t=e}return t},f=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[u]}},t}(l.b);t.default=f},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"contact_cdr_report",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,footer:!0,navigation:!0,hover:"myhover",multiselect:!0,css:"my_style",tooltip:!0,columns:[{id:"calldate",header:[{text:"Дата",height:25},{content:"serverDateRangeFilter"}],sort:"string",width:220,footer:{text:"Всего:",height:30}},{id:"queue",header:[{text:"Очередь"},{content:"selectFilter"}],sort:"string",width:130,footer:{content:"avgColumn"}},{id:"agentname",header:[{text:"Агент"},{content:"selectFilter"}],sort:"string",width:160},{id:"agent",header:[{text:"Имя агента"},{content:"selectFilter"}],sort:"string",width:155},{id:"src",header:[{text:"Источник"},{content:"serverFilter"}],sort:"string",width:155,footer:{text:"Среднее:"}},{id:"holdtime",header:[{text:"Время ожидания"},{content:"textFilter"}],sort:"string",width:155,footer:{content:"avaregeTimeColumn"}},{id:"talktime",header:[{text:"Время разговора"},{content:"textFilter"}],sort:"string",width:150,footer:{content:"avaregeTimeColumn"}},{id:"ringtime",header:[{text:"Время ответа"},{content:"textFilter"}],sort:"string",width:150,footer:{content:"avaregeTimeColumn"}},{id:"position",header:[{text:"Позиция"},{content:"textFilter"}],sort:"string",width:140},{id:"reason",header:[{text:"Причина завершения"},{content:"selectFilter"}],sort:"int",width:185},{id:"channel",header:[{text:"Канал"},{content:"textFilter"}],sort:"string",width:200},{id:"uid",header:[{text:"UID"},{content:"textFilter"}],sort:"string",width:200}],disabled:!1,url:"/legacy/contact_cdr_report",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"daily_report",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,footer:!0,hover:"myhover",navigation:!0,multiselect:!0,tooltip:!0,css:"my_style",columns:[{id:"0",header:[{text:"Дата",height:25},{content:"textFilter",height:30}],sort:"string",width:180,template:"#calldate2#",footer:{text:"Всего:",height:30}},{id:"1",header:["Длительность",{content:"textFilter"}],sort:"string",width:130,footer:{content:"summTimeColumn"}},{id:"2",header:["Звонки",{content:"textFilter"}],sort:"int",width:155,template:"#share#",footer:{content:"summColumn"}},{id:"3",header:["ACD, мин",{content:"textFilter"}],sort:"string",width:155,footer:{content:"avaregeTimeColumn"}},{id:"4",header:["ASR, %",{content:"textFilter"}],sort:"string",width:120,footer:{content:"avaregeColumn"}},{id:"5",header:["PDD, сек",{content:"textFilter"}],sort:"string",width:140,footer:{content:"avaregeColumn"}}],url:"/legacy/daily_report",ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){return e<20?"green":e<50?"orange":"red"},s=function(e){return e<50?"red":e<80?"orange":"greed"},c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"gages_row",rows:[{id:"gages",cols:[{},{id:"gage_sl",view:"gage",minRange:0,maxRange:100,color:s,value:0,label:"SL",placeholder:"%"},{id:"gage_lcr",view:"gage",minRange:0,maxRange:100,color:l,value:0,label:"LCR",placeholder:"%"},{id:"gage_ans",view:"gage",minRange:0,maxRange:20,color:l,value:0,label:"Ср.ответа",placeholder:"сек"},{id:"gage_avg",view:"gage",minRange:0,maxRange:120,color:l,value:0,label:"Ср.разговора",placeholder:"сек"},{id:"gage_fcr",view:"gage",minRange:0,maxRange:100,color:s,value:0,label:"FCR",placeholder:"%"},{id:"box3",view:"template",height:136,css:"tiles",width:250,template:function(e){for(var t=null,o=e.items,i="<div class='flex_tmp'>",n=0;n<o.length;n++)t=o[n],i+="<div class='item "+t.css+"'>",i+="<div class='webix_icon icon fa-"+t.icon+"'></div>",i+="<div class='details'><div class='text'>"+t.text+"</div><div class='value'>"+t.value+"</div></div>",i+="</div>";return i+="</div>"},data:{items:[{id:"evidences",text:"Стоимость звонка",icon:"wxi-usd",css:"feedbacks",value:""}]}},{}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"ext_dashboard_managers",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,height:300,columns:[{id:"agent_name",header:[{text:"Менеджеров"}],sort:"string",width:160},{id:"total",header:[{text:"Звонков"}],width:160},{id:"served",header:[{text:"Принятых"}],width:160},{id:"served_more20s",header:[{text:"После SL"}],width:160},{id:"unserved",header:[{text:"Не принятых"}],width:160},{id:"served_call_per",header:[{text:"Отвеченные(%)"}],width:160},{id:"sl",header:[{text:"SL"}],width:160},{id:"lcr",header:[{text:"LCR"}],width:160},{id:"avg_answer",header:[{text:"Ср. ответа"}],width:160},{id:"avg_duration",header:[{text:"Ср. разговора ВХ"}],width:160},{id:"out_count",header:[{text:"Исходящих"}],width:160},{id:"out_avg",header:[{text:"Ср. разговора ИСХ"}],width:160},{id:"int_count",header:[{text:"Внутренних"}],width:160},{id:"int_avg",header:[{text:"Ср. разговора ВН"}],width:160}],onBeforeLoad:function(){this.showProgress()},onAfterLoad:function(){this.hideProgress()},ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="<table border=0><tr><td colspan=2><b>#agent_name#</td></tr><tr><td>Готов:</td><td>#ready# ч.</td></tr><tr><td>Не готов:</td><td>#notready# ч.</td></tr><tr><td>Обед:</td><td>#lunch# ч.</td></tr><tr><td>Отдых:</td><td>#rest# ч.</td></tr><tr><td>Постобработка:</td><td>#afterwork# ч.</td></tr><tr><td>Собрание:</td><td>#meeting# ч.</td></tr><tr><td>Доп. задачи:</td><td>#tasks# ч.</td></tr><tr><td>Разговоров:</td><td>#talktime# ч.</td></tr><tr><td>Утилизация:</td><td>#utilization# %</td></tr></table>",s="<table border=0><tr><td colspan=2><b>#agent_name#</td></tr><tr><td>Ср. разговора:</td><td>#avg_duration#</td></tr><tr><td>Ср. исходящие:</td><td>#out_avg#</td></tr><tr><td>Ср. внутренние:</td><td>#int_avg#</td></tr></table>",c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"ext_dashboard_charts",rows:[{height:300,cols:[{id:"callschart",view:"chart",type:"bar",barWidth:20,radius:2,alpha:.7,gradient:"rising",xAxis:{template:"'#period#"},yAxis:{property:"value"},legend:{values:[{text:"Звонки",color:"#4aa397"},{text:"SL",color:"#de619c",markerType:"item"}],valign:"middle",align:"right",width:90,layout:"y"},series:[{value:"#calls#",color:"#4aa397",tooltip:{template:"Звонков: #calls#, SL: #sl#%"}},{type:"line",value:"#slg#",color:"#36abee",item:{borderColor:"#b7286c",color:"#de619c",type:"s"},line:{color:"#de619c",width:2},tooltip:{template:"Звонков: #calls#, SL: #sl#%"}}]},{id:"hourschart",view:"chart",type:"stackedBar",barWidth:60,gradient:"falling",xAxis:{template:"#time#"},yAxis:{},legend:{values:[{text:"Принятые > SL",color:"#36abee"},{text:"Принято < SL",color:"#f7ae70"},{text:"Потеряно > SL",color:"#a7ee70"},{text:"Потеряно < SL",color:"#07eef0"}],valign:"middle",align:"right",width:160,layout:"y"},series:[{value:"#unserved20#",color:"#07eef0",label:"#unserved20#",tooltip:{template:"<table border=0><tr><td>Принятые > SL:</td><td>#served#</td></tr><tr><td>Принятые <= SL:</td><td>#served20#</td></tr><tr><td>Потеряно > SL:</td><td>#unserved#</td></tr><tr><td>Потеряно <= SL:</td><td>#unserved20#</td></tr>"}},{value:"#unserved#",color:"#a7ee70",label:"#unserved#",tooltip:{template:"<table border=0><tr><td>Принятые > SL:</td><td>#served#</td></tr><tr><td>Принятые <= SL:</td><td>#served20#</td></tr><tr><td>Потеряно > SL:</td><td>#unserved#</td></tr><tr><td>Потеряно <= SL:</td><td>#unserved20#</td></tr>"}},{value:"#served20#",color:"#f7ae70",label:"#served20#",tooltip:{template:"<table border=0><tr><td>Принятые > SL:</td><td>#served#</td></tr><tr><td>Принятые <= SL:</td><td>#served20#</td></tr><tr><td>Потеряно > SL:</td><td>#unserved#</td></tr><tr><td>Потеряно <= SL:</td><td>#unserved20#</td></tr>"}},{value:"#served#",label:"#served#",color:"#36abee",tooltip:{template:"<table border=0><tr><td>Принятые > SL:</td><td>#served#</td></tr><tr><td>Принятые <= SL:</td><td>#served20#</td></tr><tr><td>Потеряно > SL:</td><td>#unserved#</td></tr><tr><td>Потеряно <= SL:</td><td>#unserved20#</td></tr>"}}]}]},{id:"ext_dashboard_charts2",rows:[{height:300,id:"operatorsworktime",view:"chart",type:"stackedBar",barWidth:60,gradient:"falling",xAxis:{template:"#agent_name_short#"},yAxis:{},legend:{values:[{text:"Готов",color:"#36abee"},{text:"Не готов",color:"#f7ae70"},{text:"Обед",color:"#a7fe70"},{text:"Отдых",color:"#f7aeff"},{text:"Постобработка",color:"#a7ae70"},{text:"Собрание",color:"#36cbfe"},{text:"Доп.задачи",color:"#36fffe"}],valign:"middle",align:"right",width:160,layout:"y"},series:[{value:"#notready#",color:"#f7ae70",label:"#notready# ч.",tooltip:{template:l}},{value:"#lunch#",color:"#a7fe70",label:"#lunch# ч.",tooltip:{template:l}},{value:"#rest#",color:"#f7aeff",label:"#rest# ч.",tooltip:{template:l}},{value:"#afterwork#",color:"#a7ae70",label:"#afterwork# ч.",tooltip:{template:l}},{value:"#meeting#",color:"#36cbfe",label:"#meeting# ч.",tooltip:{template:l}},{value:"#tasks#",color:"#36fffe",label:"#tasks# ч.",tooltip:{template:l}},{value:"#ready#",color:"#36abee",label:"#ready# ч.",tooltip:{template:l}},{type:"line",value:"#utg#",color:"#36abee",label:"#utilization#%",item:{borderColor:"#b7286c",color:"#de619c",type:"s"},line:{color:"#de619c",width:2},tooltip:{template:l}}]},{height:300,id:"operatorschart",view:"chart",type:"stackedBar",barWidth:60,gradient:"falling",xAxis:{template:"#agent_name_short#"},yAxis:{},legend:{values:[{text:"Ср. разговора",color:"#36abee"},{text:"Ср. исходящие",color:"#f6abee"},{text:"Ср. внутренние",color:"#36fbee"}],valign:"middle",align:"right",width:160,layout:"y"},series:[{value:"#avg_duration_sec#",color:"#36abee",label:"#avg_duration#",tooltip:{template:s}},{value:"#out_avg_sec#",color:"#f6abee",label:"#out_avg#",tooltip:{template:s}},{value:"#int_avg_sec#",color:"#36fbee",label:"#int_avg#",tooltip:{template:s}}]}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"dashboard_tree",type:"lineTree",view:"treetable",columns:[{id:"period",header:[{text:"Период"}],width:250,template:"{common.treetable()}&nbsp;#period#"},{id:"total",header:[{text:"Всего"}]},{id:"served",header:[{text:"Принято"}]},{id:"served20",header:[{text:"Принято > SL"}],width:150},{id:"unserved",header:[{text:"Потеряно"}]},{id:"lost20",header:[{text:"Потеряно > SL"}],width:150},{id:"served_call_per",header:[{text:"Отв (%)"}]},{id:"sl",header:[{text:"SL(%)"}]},{id:"agents",header:[{text:"Операторов"}]},{id:"avg_lost",header:[{text:"ВХ Ср. потер."}],width:130},{id:"avg_ans",header:[{text:"ВХ Ср. отв."}]},{id:"avg_talk",header:[{text:"ВХ Ср. разг."}]},{id:"max_wait",header:[{text:"ВХ Макс. отв."}],width:130},{id:"max_talk",header:[{text:"ВХ Макс. разг."}],width:130},{id:"out_count",header:[{text:"Исходящих"}],width:160},{id:"out_avg",header:[{text:"Ср. разговора ИСХ"}],width:160},{id:"int_count",header:[{text:"Внутренних"}],width:160},{id:"int_avg",header:[{text:"Ср. разговора ВН"}],width:160}],resizeColumn:!0,height:500,select:!0}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"analysis_outgoing_calls_layout",rows:[{view:"scrollview",scroll:"y",body:{height:1120,rows:[{id:"interval_reports",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,footer:!0,hover:"myhover",navigation:!0,multiselect:!0,tooltip:!0,css:"my_style",columns:[{id:"calldate",header:[{text:"<b>Интервал</b>",rowspan:2,height:25},{text:"",height:25},{content:"textFilter",height:30}],sort:"string",width:130,footer:{text:"Всего:",height:30}},{id:"calls_total",header:[{text:"<b>Звонки</b>",colspan:3},{text:"Всего"},{content:"textFilter"}],sort:"string",width:85,footer:{content:"summColumn"}},{id:"calls_unserved",header:[{text:""},{text:"Необслуженные"},{content:"textFilter"}],sort:"string",width:140,footer:{content:"summColumn"},template:"#calls_unserved_chart#"},{id:"calls_served",header:[{text:""},{text:"Обслуженные"},{content:"textFilter"}],sort:"string",width:140,footer:{content:"summColumn"},template:"#calls_served_chart#"},{id:"sum_holdtime",header:[{text:"<b>Суммарное время, мин.</b>",colspan:2},{text:"Ожидание"},{content:"textFilter"}],sort:"string",width:140,footer:{content:"summTimeColumn"},template:"#sum_holdtime_chart#"},{id:"sum_talktime",header:[{text:""},{text:"Разговор"},{content:"textFilter"}],sort:"string",width:140,footer:{content:"summTimeColumn"},template:"#sum_talktime_chart#"}],url:"/legacy/interval_reports_day",ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{cols:[{id:"chart_total_calls_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Всего звонков</center>"}],height:30},{id:"chart_total_calls",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",legend:{values:[{text:"Всего звонков",color:"#FF3333"}],valign:"middle",align:"right",width:250,layout:"y"},tooltip:{template:"<b>Date: </b>#month#<br><b>Всего звонков: </b>#sales#"},xAxis:{template:""},yAxis:{start:0,step:10},url:"/legacy/interval_reports_day_chart1",ready:function(){webix.extend(this,webix.ProgressBar)}}]},{view:"resizer"},{id:"chart_served_calls_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Обслуженные звонки</center>"}],height:30},{id:"chart_served_calls",view:"chart",type:"bar",gradient:"rising",xAxis:{template:""},yAxis:{start:0,step:10},legend:{values:[{text:"Трансфер звонков",color:"#66CCFF"},{text:"Завершенные агентом",color:"#FFCC33"},{text:"Завершенные клиентом",color:"#FF3333"}],valign:"middle",align:"right",width:250,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",tooltip:{template:"<b>Date: </b>#year#<br><b>Трансфер звонков: </b>#sales#"}},{value:"#sales2#",color:"#FFCC33",tooltip:{template:"<b>Date: </b>#year#<br><b>Завершенные агентом: </b>#sales2#"}},{value:"#sales3#",color:"#FF3333",tooltip:{template:"<b>Date: </b>#year#<br><b>Завершенные клиентом: </b>#sales3#"}}],url:"/legacy/interval_reports_day_chart2",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]},{view:"resizer"},{cols:[{id:"chart_unserved_calls_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Необслуженные звонки</center>"}],height:30},{id:"chart_unserved_calls",view:"chart",type:"bar",gradient:"rising",xAxis:{template:""},yAxis:{start:0,step:10},legend:{values:[{text:"Прерванные клиентом",color:"#66CCFF"},{text:"Таймаут вызова агента",color:"#FF3333"},{text:"По нажатию кнопки клиентом",color:"#66CC33"},{text:"По причине пустой очереди",color:"#CC6633"}],valign:"middle",align:"right",width:250,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",tooltip:{template:"<b>Date: </b>#year#<br><b>Прерванные клиентом: </b>#sales#"}},{value:"#sales2#",color:"#FF3333",tooltip:{template:"<b>Date: </b>#year#<br><b>Таймаут вызова агента: </b>#sales2#"}},{value:"#sales3#",color:"#66CC33",tooltip:{template:"<b>Date: </b>#year#<br><b>По нажатию кнопки клиентом: </b>#sales3#"}},{value:"#sales4#",color:"#CC6633",tooltip:{template:"<b>Date: </b>#year#<br><b>По причине пустой очереди: </b>#sales4#"}}],url:"/legacy/interval_reports_day_chart3",ready:function(){webix.extend(this,webix.ProgressBar)}}]},{view:"resizer"},{id:"chart_talktime_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Время разговора (минимальное, среднее, максимальное), сек.</center>"}],height:30},{id:"chart_talktime",view:"chart",type:"bar",gradient:"rising",xAxis:{template:""},yAxis:{start:0,step:10},legend:{values:[{text:"Минимальное",color:"#66CCFF"},{text:"Среднее",color:"#FF3333"},{text:"Максимальное",color:"#66CC33"}],valign:"middle",align:"right",width:250,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",tooltip:{template:"<b>Date: </b>#year#<br><b>Минимальное: </b>#sales#"}},{value:"#sales2#",color:"#FF3333",tooltip:{template:"<b>Date: </b>#year#<br><b>Среднее: </b>#sales2#"}},{value:"#sales3#",color:"#66CC33",tooltip:{template:"<b>Date: </b>#year#<br><b>Максимальное: </b>#sales3#"}}],url:"/legacy/interval_reports_day_chart4",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]},{view:"resizer"},{cols:[{id:"chart_holdtime_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Время ожидания (минимальное, среднее, максимальное), сек.</center>"}],height:30},{id:"chart_holdtime",view:"chart",type:"bar",gradient:"rising",xAxis:{template:""},yAxis:{start:0,step:10},legend:{values:[{text:"Минимальное",color:"#66CCFF"},{text:"Среднее",color:"#FF3333"},{text:"Максимальное",color:"#66CC33"}],valign:"middle",align:"right",width:250,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",tooltip:{template:"<b>Date: </b>#year#<br><b>Минимальное: </b>#sales#"}},{value:"#sales2#",color:"#FF3333",tooltip:{template:"<b>Date: </b>#year#<br><b>Среднее: </b>#sales2#"}},{value:"#sales3#",color:"#66CC33",tooltip:{template:"<b>Date: </b>#year#<br><b>Максимальное: </b>#sales3#"}}],url:"/legacy/interval_reports_day_chart5",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}]}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"lost_calls",view:"datatable",resizeColumn:!0,resizeRow:!0,scrollY:!1,navigation:!0,multiselect:!0,css:"my_style",columns:[{id:"title_unserved_calls",header:[{text:"<b>"+translate("Report for period")+"</b>",colspan:5,height:25},{text:"",rowspan:2,height:25},{text:"",height:25}],fillspace:!0},{id:"client_callback",header:[{text:""},{text:translate("Client called back himself"),rowspan:2},{text:""}],fillspace:!0},{id:"manager_callback",header:[{text:""},{text:translate("Manager called back to client"),colspan:2},{text:translate("Total")}],fillspace:!0},{id:"speed_callback",header:[{text:""},{text:""},{text:translate("Average speed of callback, h.")}],fillspace:!0},{id:"call_was_lost",header:[{text:""},{text:translate("Lost call"),rowspan:2},{text:""}],fillspace:!0}],on:{onAfterRender:function(){webix.extend(this,webix.ProgressBar)}},ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{id:"lost_calls_list",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,footer:!0,hover:"myhover",navigation:!0,multiselect:!0,css:"my_style",columns:[{id:"number",header:[{text:"<b>"+translate("List of lost calls during period")+"</b>",height:25},{content:"textFilter",height:30}],sort:"string",fillspace:!0,footer:{text:"<center><b>"+translate("Total:")+"</b></center>",height:30},template:function(e){return'<a href="tel:'+e.number+'">'+e.number+"</a>"}},{id:"date",header:["<b>"+translate("Date and time of last call during period")+"</b>",{content:"textFilter"}],sort:"string",fillspace:!0,footer:{content:"avgColumn"}},{id:"queue",header:["<b>Очередь</b>",{content:"textFilter"}],sort:"string",fillspace:!0},{id:"agent",header:["<b>Оператор</b>",{content:"textFilter"}],sort:"string",fillspace:!0}],on:{onAfterRender:function(){webix.extend(this,webix.ProgressBar)}},ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(20),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{width:200,collapsed:!1,collapsedWidth:40,view:"sidebar",id:"sidebar",css:"sidebar",layout:"y",select:!0,data:l.data,on:{onAfterSelect:function(e){var t=this.getItem(e);webix.$$("app:title").parse({title:t.value}),"phone"==e?(webix.guiutils.hideAllToolbars(),$$("phoneExcelButton").show()):"grouped_reports"==e?(webix.guiutils.hideAllToolbars(),$$("grouped_reports_toolbar").show()):"lost_calls"==e?(webix.guiutils.hideAllToolbars(),$$("lost_calls_toolbar").show()):"analysis_outgoing_calls"==e?(webix.guiutils.hideAllToolbars(),$$("analysis_outgoing_calls_toolbar").show()):"operators_work_report"==e?(webix.guiutils.hideAllToolbars(),$$("operators_work_report_toolbar").show()):"interval_reports"==e?(webix.guiutils.hideAllToolbars(),$$("interval_reports_toolbar").show()):"daily_report"==e?(webix.guiutils.hideAllToolbars(),$$("daily_report_toolbar").show()):"month_traffic"==e?(webix.guiutils.hideAllToolbars(),$$("month_traffic_toolbar").show()):"compare_calls"==e?(webix.guiutils.hideAllToolbars(),$$("compare_calls_toolbar").show()):"hourly_load"==e?(webix.guiutils.hideAllToolbars(),$$("hourly_traffic_toolbar").show()):"ext_incoming_external"==e?(webix.guiutils.hideAllToolbars(),$$("ext_incoming_external_toolbar").show()):"ext_incoming_internal"==e?(webix.guiutils.hideAllToolbars(),$$("ext_incoming_internal_toolbar").show()):"ext_outgoing"==e?(webix.guiutils.hideAllToolbars(),$$("ext_outgoing_toolbar").show()):"checklist"==e?(webix.guiutils.hideAllToolbars(),$$("checklist_toolbar").show()):"dashboard"==e?(webix.guiutils.hideAllToolbars(),$$("dashboard_toolbar").show()):"reports"==e?(webix.guiutils.hideAllToolbars(),$$("reports_toolbar").show()):"clients"==e?(webix.guiutils.hideAllToolbars(),$$("clients_toolbar").show()):"outgoingcampaign"==e?(webix.guiutils.hideAllToolbars(),$$("outgoingcampaign-toolbar").show()):"users"==e?(webix.guiutils.hideAllToolbars(),$$("users_toolbar").show()):"groups"==e?(webix.guiutils.hideAllToolbars(),$$("groups_toolbar").show()):"phones"==e?(webix.guiutils.hideAllToolbars(),$$("phones_toolbar").show()):"queues"==e?(webix.guiutils.hideAllToolbars(),$$("queues_toolbar").show()):"channels"==e?(webix.guiutils.hideAllToolbars(),$$("channels_toolbar").show()):"scripts"==e?(webix.guiutils.hideAllToolbars(),$$("scripts_toolbar").show()):"contact_groups"==e?(webix.guiutils.hideAllToolbars(),$$("contact_groups_toolbar").show()):"grouped_reports_by_agents"==e?(webix.guiutils.hideAllToolbars(),$$("agents_grouped_reports_filter").show()):webix.guiutils.hideAllToolbars()}}}},t.prototype.init=function(e){e.parse(l.data),this.use(a.c.Menu,e)},t}(a.b);t.default=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o.d(t,"data",function(){return i});var i=[{id:"phone",value:"Телефоны",icon:"fa fa-phone-square"},{id:"cti",value:"Инструкция",icon:"fa fa-cubes",$css:""},{id:"cdr_reports",value:"Звонки",icon:"fa fa-phone-volume",$css:""},{id:"forms",value:"Отчеты",icon:"fa fa-chart-bar",data:[{id:"ext_dashboard",icon:"fa fa-chart-area",value:"Dashboard"},{id:"grouped_reports",icon:"fa fa-sign-in-alt",value:"Входящие"},{id:"grouped_reports_by_agents",icon:"fa fa-th-large",value:"По агентам"},{id:"lost_calls",icon:"fa fa-microphone-slash",value:"Потерянные"},{id:"analysis_outgoing_calls",icon:"fa fa-sign-out-alt",value:"Исходящие"},{id:"operators_work_report",icon:"fa fa-address-card",value:"Сотрудники"}]},{id:"calendar",value:"Анализ трафика",icon:"fa fa-sliders-h",data:[{id:"interval_reports",icon:"fa fa-sign-in-alt",value:"Входящие"},{id:"daily_report",icon:"fa fa-calendar-week",value:"По дням"},{id:"month_traffic",icon:"fa fa-calendar-alt",value:"По месяцам"},{id:"hourly_load",icon:"fa fa-clock",value:"По часам"},{id:"compare_calls",icon:"fa fa-copy",value:"Сравнить"}]},{id:"files",value:"Расширенные",icon:"fa fa-th-large",data:[{id:"ext_incoming_external",icon:"fa fa-external-link-alt",value:"Внешние"},{id:"ext_incoming_internal",icon:"fa fa-external-link-square-alt",value:"Внутренние"},{id:"ext_outgoing",icon:"fa fa-sign-out-alt",value:"Исходящие"},{id:"checklist",icon:"fa fa-tasks",value:"Чеклисты"}]},{id:"nps",value:"NPS",icon:"fa fa-comments",data:[{id:"dashboard",icon:"fa fa-chart-area",value:"Dashboard Jet"},{id:"reports",icon:"fa fa-chart-bar",value:"Отчеты"},{id:"clients",icon:"fa fa-users",value:"Клиенты"}]},{id:"outgoingcampaign",value:"Исходящие кампании",icon:"fa fa-phone-square",$css:""},{id:"control",value:"Управление",icon:"fa fa-tools",data:[{id:"users",icon:"fa fa-user-friends",value:"Пользователи"},{id:"groups",icon:"fa fa-users",value:"Группы"},{id:"contact_groups",icon:"fa fa-users-cog",value:"Контактные группы"},{id:"phones",icon:"fa fa-phone",value:"Телефоны"},{id:"queues",icon:"fa fa-list-ol",value:"Очереди"},{id:"channels",icon:"fa fa-project-diagram",value:"Каналы"},{id:"scripts",icon:"fa fa-sort-amount-down",value:"Скрипты"}]}]},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e.setDate(e.getDate()-1),e}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s="",c="",u=1,d=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"interval_reports_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_interval_reports",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:a(new Date)},{}]},{cols:[{id:"finishDate_interval_reports",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"option_interval_reports",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"src_change_interval_reports",view:"text",type:"search",label:"Источник",value:c},{id:"filter_interval_reports",view:"richselect",label:"Тип звонков",labelWidth:100,width:333,value:s,options:[{id:1,value:"Входящие - все"},{id:2,value:"Входящие - обслуженные"},{id:3,value:"Входящие - необслуженные"},{id:4,value:"Исходящие"}]},{id:"interval_interval_reports",view:"richselect",label:"Тип звонков",labelWidth:100,width:266,value:u,options:[{id:1,value:"По дням"},{id:2,value:"По дням недели"},{id:3,value:"По часам"},{id:4,value:"По месяцам"}],on:{onChange:function(){u=$$("interval_interval_reports").getValue()}}},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("filter_interval_reports").getValue()&&e++,s=$$("filter_interval_reports").getValue(),""!=$$("src_change_interval_reports").getValue()&&e++,c=$$("src_change_interval_reports").getValue(),e>0?($$("option_interval_reports").define("badge",e),$$("option_interval_reports").define("label","Опции"),$$("option_interval_reports").define("icon","check"),$$("option_interval_reports").refresh()):($$("option_interval_reports").define("badge",e),$$("option_interval_reports").define("label","Доп.опции"),$$("option_interval_reports").define("icon","wxi-plus"),$$("option_interval_reports").refresh()),$$("filter_interval_reports").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("filter_interval_reports").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_interval_reports",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_interval_reports")}},{id:"search_interval_reports",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){}},{}]},{cols:[{width:27},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){switch(s){case 1:filter_interval_reports_text="Входящие - все";break;case 2:filter_interval_reports_text="Входящие - обслуженные";break;case 3:filter_interval_reports_text="Входящие - необслуженные";break;case 4:filter_interval_reports_text="Исходящие";break;default:filter_interval_reports_text="Входящие - все"}switch(u){case 1:interval_interval_reports_text="По дням";break;case 2:interval_interval_reports_text="По дням недели";break;case 3:interval_interval_reports_text="По часам";break;case 4:interval_interval_reports_text="По месяцам"}webix.toExcel($$("interval_reports"),{filterHTML:!0,filename:"Входящие - "+interval_interval_reports_text+" - "+filter_interval_reports_text})}},{}]},{}]}},t.prototype.urlChange=function(){},t}(l.b);t.default=d},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e.setMonth(e.getMonth()-1),e}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s="",c="",u=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"daily_report_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_daily_report",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:a(new Date)},{}]},{cols:[{id:"finishDate_daily_report",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"option_daily_report",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"dst_change_daily",view:"text",type:"search",label:"Набранный номер",value:s},{id:"src_change_daily",view:"text",type:"search",label:"Источник",value:c},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("dst_change_daily").getValue()&&e++,s=$$("dst_change_daily").getValue(),""!=$$("src_change_daily").getValue()&&e++,c=$$("src_change_daily").getValue(),e>0?($$("option_daily_report").define("badge",e),$$("option_daily_report").define("label","Опции"),$$("option_daily_report").define("icon","check"),$$("option_daily_report").refresh()):($$("option_daily_report").define("badge",e),$$("option_daily_report").define("label","Доп.опции"),$$("option_daily_report").define("icon","wxi-plus"),$$("option_daily_report").refresh()),$$("dst_change_daily").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("dst_change_daily").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_daily_report",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_daily_report")}},{id:"search_daily_report",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){$$("daily_report").enable();var e=$$("startDate_daily_report").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_daily_report").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),a="/legacy/daily_report?filter[t1]="+o+"&filter[t2]="+r;""!=c&&(a+="&filter[src]="+c),""!=s&&(a+="&filter[dst]="+s),$$("daily_report").clearAll(),$$("daily_report").showProgress({type:"icon",hide:!0}),$$("daily_report").load(a)}},{}]},{cols:[{width:27},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("daily_report"),{filterHTML:!0,filename:"По дням"})}},{}]},{}]}},t.prototype.urlChange=function(){},t}(l.b);t.default=u},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="",s="",c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"month_traffic_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_month_traffic",view:"richselect",label:"Период от",labelWidth:150,labelAlign:"right",width:300,options:"/legacy/month_traffic_period"},{}]},{cols:[{id:"finishDate_month_traffic",view:"richselect",label:"Диапазон месяцев:",labelWidth:150,labelAlign:"right",width:300,options:[{id:1,value:"-1 месяц"},{id:2,value:"-2 месяца"},{id:3,value:"-3 месяца"},{id:4,value:"-4 месяца"},{id:5,value:"-5 месяцев"},{id:6,value:"-6 месяцев"}]},{}]},{cols:[{width:27},{id:"option_month_traffic",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"dst_change_month_traffic",view:"text",type:"search",label:"Набранный номер",value:l},{id:"src_change_month_traffic",view:"text",type:"search",label:"Источник",value:s},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("dst_change_month_traffic").getValue()&&e++,l=$$("dst_change_month_traffic").getValue(),""!=$$("src_change_month_traffic").getValue()&&e++,s=$$("src_change_month_traffic").getValue(),e>0?($$("option_month_traffic").define("badge",e),$$("option_month_traffic").define("label","Опции"),$$("option_month_traffic").define("icon","check"),$$("option_month_traffic").refresh()):($$("option_month_traffic").define("badge",e),$$("option_month_traffic").define("label","Доп.опции"),$$("option_month_traffic").define("icon","wxi-plus"),$$("option_month_traffic").refresh()),$$("dst_change_month_traffic").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("dst_change_month_traffic").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_month_traffic",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_month_traffic")}},{id:"search_month_traffic",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){$$("month_traffic").enable(),$$("month_traffic_chart").enable();var e="";""!=$$("startDate_month_traffic").getValue()&&(e+="?filter[t1]="+$$("startDate_month_traffic").getValue()),""!=$$("finishDate_month_traffic").getValue()&&(e+="&filter[t2]="+$$("finishDate_month_traffic").getValue()),""!=s&&(e+="&filter[src]="+s),""!=l&&(e+="&filter[dst]="+l),$$("month_traffic").clearAll(),webix.extend($$("month_traffic"),webix.ProgressBar),$$("month_traffic").showProgress(),$$("month_traffic").load("/legacy/month_traffic"+e),$$("month_traffic_chart").clearAll(),$$("month_traffic_chart").load("/legacy/month_traffic_chart"+e),$$("month_traffic_chart").refresh()}},{}]},{cols:[{width:27},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("month_traffic"),{filterHTML:!0,filename:"По месяцам"})}},{}]},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="",s="",c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"hourly_traffic_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_hourly_load",view:"datepicker",width:230,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!1,format:"%Y-%m-%d",value:new Date},{}]},{cols:[{width:27},{id:"option_hourly_load",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"dst_change_hourly_load",view:"text",type:"search",label:"Набранный номер",value:l},{id:"src_change_hourly_load",view:"text",type:"search",label:"Источник",value:s},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("dst_change_hourly_load").getValue()&&e++,l=$$("dst_change_hourly_load").getValue(),""!=$$("src_change_hourly_load").getValue()&&e++,s=$$("src_change_hourly_load").getValue(),e>0?($$("option_hourly_load").define("badge",e),$$("option_hourly_load").define("label","Опции"),$$("option_hourly_load").define("icon","check"),$$("option_hourly_load").refresh()):($$("option_hourly_load").define("badge",e),$$("option_hourly_load").define("label","Доп.опции"),$$("option_hourly_load").define("icon","wxi-plus"),$$("option_hourly_load").refresh()),$$("dst_change_hourly_load").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("dst_change_hourly_load").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_hourly_load",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_hourly_load")}},{}]},{cols:[{width:27},{id:"search_hourly_load",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){$$("hourly_load").enable(),$$("hourly_load_chart").enable(),$$("hourly_load_chart_asr").enable();var e="/legacy/hourly_load",t="";if(""!=$$("startDate_hourly_load").getValue()){var o=new Date($$("startDate_hourly_load").getValue()),i=o.getDate(),n=o.getMonth()+1;t+="?filter[t1]="+o.getFullYear()+"-"+n+"-"+i}""!=s&&(t.length?t+="&":t+="?",t+="filter[src]="+s),""!=l&&(t.length?t+="&":t+="?",t+="filter[dst]="+l);var r=webix.ajax(e+t,function(e){return e});$$("hourly_load").clearAll(),$$("hourly_load").showProgress({type:"icon",hide:!0}),$$("hourly_load").parse(r),$$("hourly_load_chart").clearAll(),$$("hourly_load_chart").load(e+"_chart1"+t),$$("hourly_load_chart").refresh(),$$("hourly_load_chart_asr").clearAll(),$$("hourly_load_chart_asr").load(e+"_chart2"+t),$$("hourly_load_chart_asr").refresh()}},{}]},{cols:[{width:27},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("hourly_load"),{filterHTML:!0,filename:"По часам"})}},{}]},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="",s="",c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"compare_calls_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_compare_calls",view:"datepicker",width:344,label:"Период от",labelWidth:200,labelAlign:"right",timepicker:!1,format:"%Y-%m-%d",value:new Date},{}]},{cols:[{id:"finishDate_compare_calls",view:"richselect",label:"Диапазон дней для сравнения:",labelWidth:223,width:344,value:1,options:[{id:1,value:"-1 день"},{id:2,value:"-2 дня"},{id:3,value:"-3 дня"},{id:4,value:"-4 дня"},{id:5,value:"-5 дней"}]},{}]},{cols:[{width:71},{id:"option_compare_calls",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"dst_change_compare_calls",view:"text",type:"search",label:"Набранный номер",value:l},{id:"src_change_compare_calls",view:"text",type:"search",label:"Источник",value:s},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("dst_change_compare_calls").getValue()&&e++,l=$$("dst_change_compare_calls").getValue(),""!=$$("src_change_compare_calls").getValue()&&e++,s=$$("src_change_compare_calls").getValue(),e>0?($$("option_compare_calls").define("badge",e),$$("option_compare_calls").define("label","Опции"),$$("option_compare_calls").define("icon","check"),$$("option_compare_calls").refresh()):($$("option_compare_calls").define("badge",e),$$("option_compare_calls").define("label","Доп.опции"),$$("option_compare_calls").define("icon","wxi-plus"),$$("option_compare_calls").refresh()),$$("dst_change_compare_calls").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("dst_change_compare_calls").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_compare_calls",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_compare_calls")}},{id:"search_compare_calls",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){$$("compare_calls").enable();var e="";if(""!=$$("startDate_compare_calls").getValue()){var t=new Date($$("startDate_compare_calls").getValue()),o=t.getDate(),i=t.getMonth()+1,n=t.getFullYear();e+="?filter[t1]="+n+"-"+i+"-"+o}""!=$$("finishDate_compare_calls").getValue()&&(e+="&filter[t2]="+$$("finishDate_compare_calls").getValue()),""!=s&&(e+="&filter[src]="+s),""!=l&&(e+="&filter[dst]="+l);var r=webix.ajax("/legacy/compare_calls"+e,function(e){return e});$$("compare_calls").clearAll(),webix.extend($$("compare_calls"),webix.ProgressBar),$$("compare_calls").showProgress({type:"icon",hide:!0}),$$("compare_calls").parse(r),$$("compare_calls_chart").clearAll(),$$("compare_calls_chart").load("/legacy/compare_calls_chart"+e);var t=new Date($$("startDate_compare_calls").getValue()),o=t.getDate()<10?"0"+t.getDate():t.getDate(),i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getFullYear(),a=o+"-"+i+"-"+n;t=new Date($$("startDate_compare_calls").getValue()-864e5),o=t.getDate()<10?"0"+t.getDate():t.getDate(),i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getFullYear();var c=o+"-"+i+"-"+n;t=new Date($$("startDate_compare_calls").getValue()-1728e5),o=t.getDate()<10?"0"+t.getDate():t.getDate(),i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getFullYear();var u=o+"-"+i+"-"+n;t=new Date($$("startDate_compare_calls").getValue()-2592e5),o=t.getDate()<10?"0"+t.getDate():t.getDate(),i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getFullYear();var d=o+"-"+i+"-"+n;t=new Date($$("startDate_compare_calls").getValue()-3456e5),o=t.getDate()<10?"0"+t.getDate():t.getDate(),i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getFullYear();var p=o+"-"+i+"-"+n;1==$$("finishDate_compare_calls").getValue()?$$("compare_calls_chart").define({legend:{values:[{text:a,color:"#1293f8"}],align:"right",valign:"middle",layout:"y",width:100,margin:8}}):2==$$("finishDate_compare_calls").getValue()?$$("compare_calls_chart").define({legend:{values:[{text:c,color:"#1293f8"},{text:a,color:"#66cc00"}],align:"right",valign:"middle",layout:"y",width:100,margin:8}}):3==$$("finishDate_compare_calls").getValue()?$$("compare_calls_chart").define({legend:{values:[{text:u,color:"#1293f8"},{text:c,color:"#66cc00"},{text:a,color:"#FF6633"}],align:"right",valign:"middle",layout:"y",width:100,margin:8}}):4==$$("finishDate_compare_calls").getValue()?$$("compare_calls_chart").define({legend:{values:[{text:d,color:"#1293f8"},{text:u,color:"#66cc00"},{text:c,color:"#FF6633"},{text:a,color:"#CC0033"}],align:"right",valign:"middle",layout:"y",width:100,margin:8}}):5==$$("finishDate_compare_calls").getValue()&&$$("compare_calls_chart").define({legend:{values:[{text:p,color:"#1293f8"},{text:d,color:"#66cc00"},{text:u,color:"#FF6633"},{text:c,color:"#CC0033"},{text:a,color:"#009933"}],align:"right",valign:"middle",layout:"y",width:100,margin:8}}),$$("compare_calls_chart").refresh()}},{}]},{cols:[{width:71},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("compare_calls"),{filterHTML:!0,filename:"Сравнить"})}},{}]},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"ext_incoming_external_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_ext_in_ext",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{id:"finishDate_ext_in_ext",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"search_ext_incoming_external",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){var e=$$("startDate_ext_in_ext").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_ext_in_ext").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),a="legacy/ext_incoming_external_total?filter[t1]="+o+"&filter[t2]="+r;$$("ext_incoming_external").clearAll(),$$("ext_incoming_external").load(a)}},{}]},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=$$("startDate_ext_in_internal").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_ext_in_internal").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),a=$$("ext_incoming_internal").getFilter("number").value,l=$$("ext_incoming_internal").getFilter("user_name").value,s="/legacy/ext_incoming_internal?filter[t1]="+o+"&filter[t2]="+r;return l.length&&(s+="&filter[user_name]="+l),a.length&&(s+="&filter[number]="+a),s}return{id:"ext_incoming_internal_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_ext_in_internal",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{id:"finishDate_ext_in_internal",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"search_ext_incoming_internal",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",on:{onItemClick:function(){$$("ext_incoming_internal").clearAll(),$$("ext_incoming_internal").load(e())}}},{}]},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"ext_outgoing_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_ext_outgoing",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{id:"finishDate_ext_outgoing",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"search_ext_outgoing",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",on:{onItemClick:function(){var e=$$("startDate_ext_outgoing").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_ext_outgoing").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),a=$$("ext_outgoing").getFilter("number").value,l=$$("ext_outgoing").getFilter("user_name").value,s="/legacy/ext_outgoing?filter[t1]="+o+"&filter[t2]="+r;l.length&&(s+="&filter[user_name]="+l),a.length&&(s+="&filter[number]="+a),$$("ext_outgoing").clearAll(),$$("ext_outgoing").load(s)}}},{}]},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e;webix.ui((e={id:"checklist_setup_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('salary_setup_win').close();"}},e.head={view:"toolbar",margin:-4,cols:[{view:"label",label:"Список вопросов чеклиста"},{view:"icon",icon:"wxi-close-circle",click:"$$('checklist_setup_win').close();"}]},e.resize=!0,e.width=600,e.height=500,e.center=!0,e.position="center",e.modal=!0,e.move=!0,e.body={rows:[{cols:[{view:"richselect",id:"questions_checklist",label:"Группа",labelWidth:100,labelAlign:"right",options:"/legacy/ext/checklists/groups/",on:{onChange:function(e,t){$$("questions_list").clearAll();var o=$$("questions_checklist_block");o.getList().clearAll(),o.setValue(0),e&&(o.getList().load("/legacy/ext/checklists/groups/"+e),$$("row_questions_checklist_block").show())}}},{id:"questions_checklist_add",view:"button",type:"iconButton",icon:"wxi-plus",width:36,click:function(){t(0)}},{id:"questions_checklist_delete",view:"button",type:"iconButton",icon:"wxi-minus",width:36,click:function(){o($$("questions_checklist").getValue())}}]},{id:"row_questions_checklist_block",hidden:!0,cols:[{view:"richselect",id:"questions_checklist_block",label:"Блок",labelWidth:100,labelAlign:"right",options:[],value:1,on:{onChange:function(e,t){$$("questions_list").clearAll(),e&&($$("questions_list").load("/legacy/ext/checklist/list/"+e),$$("questions_checklist_save").enable())}}},{id:"questions_checklist_block_add",view:"button",type:"iconButton",icon:"wxi-plus",width:36,click:function(){t($$("questions_checklist").getValue())}},{id:"questions_checklist_block_delete",view:"button",type:"iconButton",icon:"wxi-minus",width:36,click:function(){o($$("questions_checklist_block").getValue())}}]},{view:"treetable",id:"questions_list",autowidth:!0,editable:!0,columns:[{id:"question",header:"Вопрос",width:450,editor:"text"}],on:{onItemClick:function(e){this.editColumn(e),this.focusEditor(e)}}},{cols:[{view:"button",id:"questions_checklist_save",disabled:!1,label:"Сохранить",click:function(){var e=$$("questions_checklist_block").getValue();if(e){var t=[];$$("questions_list").editStop(),$$("questions_list").data.each&&$$("questions_list").data.each(function(e){t.push(e)});var o=JSON.stringify(t);webix.ajax().post("/legacy/ext/checklist/questions/save/"+e,o,{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при сохранении."})},success:function(e,t,o){webix.message({type:"success",text:"Операция сохранения успешно завершена."})}})}}},{view:"button",label:"Закрыть окно",click:"$$('checklist_setup_win').close();"}]}]},e)).show()}function t(e){webix.ui({view:"window",height:200,width:300,modal:!0,position:"center",head:e?"Добавление блока":"Добавление группы",body:{view:"form",elements:[{view:"text",name:"name",label:"Название",value:""},{cols:[{view:"button",label:"Добавить",click:function(){var t=this.getFormView().elements.name.getValue(),o={addgroup:t,parent_id:e};this.getFormView().getParentView().close(),webix.ajax().post("/legacy/ext/checklist/addgroup",o,{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при добавлении."})},success:function(t,o,i){if(webix.message({type:"success",text:"Операция добавления успешно завершена."}),e){$$("questions_list").clearAll();var n=$$("questions_checklist_block");n.getList().clearAll(),n.getList().load("/legacy/ext/checklists/groups/"+e),n.setValue(o.json().id)}else{$$("questions_list").clearAll();var n=$$("questions_checklist_block");n.getList().clearAll(),n.setValue(0),n=$$("questions_checklist"),n.getList().clearAll(),n.getList().load("/legacy/ext/checklists/groups/"),n.setValue(o.json().id)}}})}},{view:"button",label:"Отмена",click:function(){this.getFormView().getParentView().close()}}]}]}}).show()}function o(e){webix.ui({view:"window",height:200,width:300,modal:!0,position:"center",head:"Удалить выбранную группу вопросов?",body:{view:"form",elements:[{cols:[{view:"button",label:"Удалить",click:function(){var t={deletegroup:e};this.getFormView().getParentView().close(),webix.ajax().post("/legacy/ext/checklist/deletegroup",t,{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при удалении."})},success:function(e,t,o){webix.message({type:"success",text:"Операция удаления успешно завершена."});var i=$$("questions_checklist_block");i.getList().clearAll(),i.setValue(0),i=$$("questions_checklist"),i.getList().clearAll(),i.getList().load("/legacy/ext/checklists/groups/"),i.setValue(0),$$("questions_checklist_save").disable(),$$("row_questions_checklist_block").hide()}})}},{view:"button",label:"Отмена",click:function(){this.getFormView().getParentView().close()}}]}]}}).show()}return{id:"checklist_toolbar",hidden:!0,cols:[{id:"checklist_questions_fill",view:"button",type:"iconButton",icon:"wxi-commenting-o",width:155,label:"Заполнить",click:function(){webix.guiutils.checklistFillWindow(0,0,0)}},{id:"ext_checklist_start",view:"datepicker",label:"Начало",editable:!0,labelAlign:"right",timepicker:!1,width:230,format:"%d.%m.%Y",value:new Date},{id:"ext_checklist_finish",view:"datepicker",label:"Конец",editable:!0,labelAlign:"right",timepicker:!1,width:230,format:"%d.%m.%Y",value:new Date},{id:"checklist_reload",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Поиск",click:function(){$$("ext_checklist_table").clearAll();var e=$$("ext_checklist_start").getValue(),t=$$("ext_checklist_finish").getValue();webix.extend($$("ext_checklist_table"),webix.ProgressBar),$$("ext_checklist_table").showProgress(),$$("ext_checklist_table").load("/legacy/ext/checklist/tree?start="+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"&finish="+t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate())}},{view:"button",type:"iconButton",icon:"wxi-file",width:185,label:"Поиск и развернуть",click:function(){$$("ext_checklist_table").clearAll();var e=$$("ext_checklist_start").getValue(),t=$$("ext_checklist_finish").getValue();webix.extend($$("ext_checklist_table"),webix.ProgressBar),$$("ext_checklist_table").showProgress(),$$("ext_checklist_table").load("/legacy/ext/checklist/tree?start="+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"&finish="+t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+"&open=1")}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:155,label:"Экспорт в Excel",click:function(){webix.toExcel($$("ext_checklist_table"))}},{},{id:"checklist_questions_list",view:"button",type:"iconButton",icon:"fa fa-question",width:155,label:"Вопросы",click:function(){e()}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"dashboard_toolbar",hidden:!0,cols:[{view:"daterangepicker",name:"default",width:300,label:"Период",id:"rangePickerFilter",value:{start:webix.Date.add(new Date,-7,"day"),end:webix.Date.add(new Date,1,"day")},on:{onChange:function(){webix.guiutils.getNpsFilter()}}},{view:"multiselect",label:"Город",id:"cityFilter",width:260,on:{onChange:function(){webix.guiutils.getNpsFilter()}},options:"/legacy/nps/options/city"},{view:"multiselect",label:"Филиал",id:"filialFilter",width:300,on:{onChange:function(){webix.guiutils.getNpsFilter()},onAfterRender:function(){webix.guiutils.getNpsFilter()}},options:"/legacy/nps/options/filial"},{width:260,view:"multiselect",label:"Канал",id:"channel",on:{onChange:function(){webix.guiutils.getNpsFilter()}},options:"/legacy/nps/options/channel"},{width:115,view:"button",type:"iconButton",icon:"wxi-sync",label:"Обновить",click:function(){webix.guiutils.getNpsFilter()}},{view:"button",label:"Export to PDF",width:140,click:function(){webix.guiutils.getPdfChart("charts")}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"reports_toolbar",hidden:!0,cols:[{view:"button",label:"Export to PDF",width:140,click:function(){var e=$$("daterangepickerForeReports").getValue();if(e.start)var t=webix.Date.dateToStr("%d.%m.%Y")(new Date(e.start));else if(e.end)var t=webix.Date.dateToStr("%d.%m%Y")(new Date(e.end));if(e.end)var o=webix.Date.dateToStr("%d.%m%Y")(new Date(e.end));else var o=t;webix.toExcel($$("reports"),{filename:"NPS_Report_"+t+"-"+o,name:"NPS_Report_"+t+"-"+o})}},{view:"daterangepicker",name:"default",width:300,label:"Период",id:"daterangepickerForeReports",value:{start:webix.Date.add(new Date,-7,"day"),end:webix.Date.add(new Date,1,"day")}},{width:115,view:"button",type:"iconButton",icon:"wxi-sync",label:"Обновить",click:function(){$$("reports").clearAll(),webix.extend($$("reports"),webix.ProgressBar),$$("reports").showProgress(),$$("reports").load("legacy/nps/report"),$$("reports").filterByAll()}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=$$("clients");if(e){var t=e.getSelectedItem();t&&t.id?webix.confirm({text:"Клиент и результаты его анкетирования будут удалены. <br> Продолжить?",callback:function(e){if(!e)return!1;webix.ajax().get("legacy/nps/clients/remove",{id:t.id},function(e){e=JSON.parse(e),e.result?(webix.message({text:"Клиент удален"}),$$("clients").remove(t.id)):(webix.message({type:"error",text:e.msg}),console.log("err",e.data))})}}):webix.message({type:"error",text:"Выберите клиента!"})}else webix.message({type:"error",text:"Произошла ошибка!"})}function t(){webix.ui({view:"window",id:"importWindow",position:"center",move:!0,resizw:!0,modal:!0,width:700,height:500,scroll:!0,head:{view:"toolbar",margin:-4,cols:[{view:"label",label:"Импорт клиентов"},{view:"icon",icon:"times-circle",click:function(){webix.confirm({text:"Внесенные изменения не будут сохранены. <br/> Продолжить?",ok:"Ок",cancel:"Отмена",callback:function(e){e&&$$("importWindow").close()}})}}]},body:{id:"importForm",view:"form",elements:[{view:"uploader",value:translate("Выберите Excel или CSV файл"),on:{onBeforeFileAdd:function(e){var t=[{id:"phone",value:translate("Телефон")},{id:"name",value:translate("Имя клиента")},{id:"buyer_status",value:translate("Статус покупателя")},{id:"lastbuy_date",value:translate("Дата последней покупки")},{id:"city",value:translate("Город")},{id:"filial",value:translate("Филиал")},{id:"channel",value:translate("Канал")},{id:"motivational_p",value:translate("Мотивационная программа")}];if(t.unshift({id:"empty",value:"Выберите зачение"}),"xlsx"==e.type||"xls"==e.type)webix.DataDriver.excel.toObject(e.file).then(function(e){for(var o=e.data,i=webix.toArray($$("importData").config.columns),n=0;n<o[0].length;n++)i.insertAt({id:"field"+n,header:[{content:"selectFilter",options:t}]},n);$$("importData").refreshColumns();for(var n=0;n<o.length;n++){for(var r={},a=0;a<o[n].length;a++)r["field"+a]=o[n][a];o[n]=r}$$("importData").clearAll(),$$("importData").parse(o)});else{if("csv"==e.type){var o=new FileReader;return o.onload=function(e){for(var o=e.target.result.split("\n"),i=0;i<o.length;i++){var n={};o[i]=o[i].split("\t");for(var r=0;r<o[i].length;r++)n["field"+(r+1)]=o[i][r];o[i]=n}for(var a=[],i=0;i<o.length;i++)a.push(o[i].field1.split(";",-1));for(var l=webix.toArray($$("importData").config.columns),i=0;i<a[0].length;i++)l.insertAt({id:"field"+i,header:[{content:"selectFilter",options:t}]},i);$$("importData").refreshColumns(),$$("importData").clearAll();for(var i=0;i<a.length;i++){for(var n={},r=0;r<a[i].length;r++)n["field"+r]=a[i][r];a[i]=n,$$("importData").parse(a[i])}},o.readAsText(e.file),!1}webix.message({type:"erro",text:"Неизвестный тип файла!"})}}}},{view:"datatable",id:"importData",select:!0,resize:!0,resizeColumn:!0,columns:[],ready:function(){this.filterByAll=function(){}}},{margin:20,cols:[{view:"label",id:"import_process"},{view:"button",value:"Отмена",width:200,click:function(){$$("importWindow").close()},hidden:!0},{view:"button",id:"importButton",type:"form",value:"Импортировать",width:200,align:"right",click:function(){var e=o();i(0,$$("importData").serialize(),e)}}]}]},ready:function(){webix.extend($$("importWindow"),webix.ProgressBar)}}).show()}function o(){var e=$$("importData").serialize(),t=[];if(e&&e.length)for(var o in e[0])"id"!=o&&t.push($$("importData").getFilter(o).value);var i=!1;for(var n in t){if("phone"==t[n]){i=!0;break}i=!1}if(!i)return void webix.message({type:"error",text:"Выберите телефон"});var r=[];for(var a in t)-1!=t[a].indexOf("phone")&&(r.phone=a),-1!=t[a].indexOf("name")&&(r.name=a),-1!=t[a].indexOf("buyer_status")&&(r.buyer_status=a),-1!=t[a].indexOf("lastbuy_date")&&(r.lastbuy_date=a),-1!=t[a].indexOf("city")&&(r.city=a),-1!=t[a].indexOf("filial")&&(r.filial=a),-1!=t[a].indexOf("channel")&&(r.channel=a),-1!=t[a].indexOf("motivational_p")&&(r.motivational_p=a);return $$("importForm").disable(),webix.extend($$("importWindow"),webix.ProgressBar),webix.extend($$("importButton"),webix.ProgressBar),$$("importWindow").showProgress({type:"bottom",hide:!1,position:.1}),$$("importButton").showProgress({type:"icon",hide:!1}),r}function i(e,t,o){if(webix.extend($$("importWindow"),webix.ProgressBar),$$("importWindow").showProgress({type:"bottom",hide:!1,position:e/t.length==0?.01:e/t.length}),!(e>t.length)){for(var n=[],r=e;r<e+10&&r<t.length;r++)if(t[r]){var a={phone:String(t[r]["field"+o.phone]),name:"undefined"!=String(t[r]["field"+o.name])?String(t[r]["field"+o.name]):null,buyer_status:"undefined"!=String(t[r]["field"+o.buyer_status])?String(t[r]["field"+o.buyer_status]):null,lastbuy_date:"undefined"!=String(t[r]["field"+o.lastbuy_date])?String(t[r]["field"+o.lastbuy_date]):null,city:"undefined"!=String(t[r]["field"+o.city])?String(t[r]["field"+o.city]):null,filial:"undefined"!=String(t[r]["field"+o.filial])?String(t[r]["field"+o.filial]):null,channel:"undefined"!=String(t[r]["field"+o.channel])?String(t[r]["field"+o.channel]):null,motivational_p:"undefined"!=String(t[r]["field"+o.motivational_p])?String(t[r]["field"+o.motivational_p]):null};a.phone.length&&n.push(a)}console.log(n),webix.ajax().headers({"Content-type":"application/json"}).get("legacy/nps/clients/import",{data:JSON.stringify(n)},{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при выполнении запроса.<br/>"+e}),$$("importForm").enable(),$$("importWindow").hideProgress(),$$("importButton").hideProgress()},success:function(e,n,a){var l=n.json();if(!l||!l.result)return webix.message({type:"error",text:"Произошла ошибка при обработке данных.<br/>"+e}),$$("importForm").enable(),$$("importWindow").hideProgress(),void $$("importButton").hideProgress();$$("import_process").setHTML("Импортировано "+r+" из "+t.length),$$("import_process").show(),r<t.length-1?i(r,t,o):($$("importButton").hideProgress(),$$("importButton").hide(),$$("importWindow").showProgress({type:"bottom",hide:!1,position:1}),webix.alert("Импорт успешно завершен",function(e){e&&($$("importWindow").close(),$$("clients").loadNext(20,0,null,"controllers/clients.php"))}))}})}}return{id:"clients_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-file",width:260,label:translate("Import from Excel or CSV"),click:function(){t()}},{view:"button",type:"iconButton",id:"reloadClients",width:115,icon:"wxi-sync",label:"Обновить",click:function(){$$("clients").load($$("clients").config.url)}},{view:"button",type:"iconButton",icon:"wxi-trash",width:105,label:translate("Удалить"),click:function(){e()}},{width:0}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(1),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$$("outgoingcampaign-toolbar").hide(),$$("outgoingcampaigns").hide(),$$("outgoingcampaign-form").show(),e&&$$("co-form").setValues(e)}function t(e,t){webix.ajax().get("outgoingcampaign/"+t+"/state/"+e).then(function(e){var t=e.json();t.result?(t.message?webix.message({type:"success",text:t.message}):webix.message({type:"success",text:"Операция прошла успешно"}),$$("outgoingcampaigns").load($$("outgoingcampaigns").config.url)):webix.message({type:"error",text:"Произошла ошибка выполнения операции"})}).fail(function(e){webix.message({type:"error",text:"Произошла ошибка выполнения операции"})})}return{id:"outgoingcampaign-toolbar",hidden:!0,cols:[{view:"button",maxWidth:"300",label:"Новая кампания",click:function(){e()}},{view:"button",maxWidth:"300",label:"Правила по умолчанию",click:function(){this.$scope.ui(l.OCRulesWnd).showWindow(this.$scope.$view),$$("co-settings-result").load("/outgoingcampaign/0/settings").then(function(){$$("co-settings-result").unselectAll(),$$("co-settings-result").select("0")})}},{view:"button",maxWidth:"150",label:"СТАРТ",click:function(){var e=$$("outgoingcampaigns").getSelectedItem();e&&e.id?t(2,e.id):webix.message({type:"error",text:"Выберите кампанию для запуска"})}},{view:"button",maxWidth:"150",label:"ПАУЗА",click:function(){var e=$$("outgoingcampaigns").getSelectedItem();e&&e.id?t(3,e.id):webix.message({type:"error",text:"Выберите кампанию для приостановки"})}},{view:"button",maxWidth:"150",label:"СТОП",click:function(){var e=$$("outgoingcampaigns").getSelectedItem();e&&e.id?t(4,e.id):webix.message({type:"error",text:"Выберите кампанию для остановки"})}}]}},t.prototype.init=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(35),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"users_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Добавить",click:function(){$$("users").unselectAll(),this.$scope.ui(l.ClientsWindow).showWindow(this.$scope.$view)}},{view:"button",type:"iconButton",icon:"wxi-pencil",width:150,label:"Изменить",click:function(){if($$("users").getSelectedItem()){this.$scope.ui(l.ClientsWindow).showWindow(this.$scope.$view)}else webix.message({type:"error",text:"Выберите пользователя для редактирования"})}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("users"),{filterHTML:!0,filename:"Пользователи"})}},{view:"button",type:"iconButton",icon:"fa fa-sync",width:50,click:function(){webix.guiutils.loadUserTable()}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),o.d(t,"ClientsWindow",function(){return s});var a=o(0),l=o(2),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=[{id:"1",value:"Активный"},{id:"2",value:"Заблокирован"},{id:"3",value:"Удален"},{id:"4",value:"Скрытый"}],t=this.getThis();return{view:"window",id:"add-win",position:"center",move:!0,modal:!0,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:($$("users").getSelectedItem()?"Изменить ":"Добавить")+"  пользователя",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("add-win").close()}})}}]},body:{paddingY:20,paddingX:30,elementsConfig:{labelWidth:100},width:600,view:"form",id:"add-form",minHeight:500,scroll:!0,elements:[{view:"text",name:"id",label:"id",value:0,hidden:!0},{view:"text",name:"name",label:"Логин",inputAlign:"left",labelWidth:120,required:!0},{view:"text",name:"fullname",label:"ФИО",inputAlign:"left",labelWidth:120,required:!0},{view:"textarea",name:"description",label:"Описание",inputAlign:"left",labelWidth:120,height:100},{view:"text",name:"password",id:"user-password",label:"Пароль",type:"password",inputAlign:"left",labelWidth:120},{view:"text",name:"phone",label:"Номер",inputAlign:"left",labelWidth:120,required:!0},{view:"select",name:"state",label:"Статус",inputAlign:"left",labelWidth:120,options:e},{view:"multicombo",name:"user_groups_ids",label:"Группы",inputAlign:"left",labelWidth:120,autoheight:!0,options:"/users/user_groups"},{view:"multicombo",name:"rules",label:"Права доступа",inputAlign:"left",labelWidth:120,options:{body:{template:"#name#"},url:"/rules/list"}},{margin:10,cols:[{},{view:"button",label:"Настройки",align:"center",width:120,click:function(){this.$scope.ui(l.SettingsWindow).showWindow(t.getId(),"user")}},{view:"button",label:"Сохранить",type:"form",align:"center",width:120,click:function(){var e=$$("add-form");if(e.validate()){e.disable();var t=e.getValues();webix.ajax().post("/users/"+t.id+"/save",t).then(function(t){e.enable(),t=t.json(),t.result?(webix.message({type:"success",text:t.message}),e.enable(),webix.$$("add-win").close(),webix.guiutils.loadUserTable()):(webix.message({type:"error",text:t.message}),e.enable())}).catch(function(t){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),e.enable(),console.log(t)})}else webix.message({type:"error",text:"Заполните обязательные поля"})}},{view:"button",label:"Отмена",align:"center",width:120,click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("add-win").close()}})}}]}],rules:{password:function(e){return!!$$("users").getSelectedItem()||e.length}}},on:{onShow:function(){var e=$$("users").getSelectedItem();e?e.id?(t.setId(e.id),$$("add-form").setValues(e)):t.setId(0):($$("add-form").setValues({id:0}),t.setId(0))}}}},t.prototype.getThis=function(){return this},t.prototype.getId=function(){return this.clientId},t.prototype.setId=function(e){this.clientId=e},t.prototype.showWindow=function(){this.getRoot().show()},t}(a.b)},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(37),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"groups_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Добавить",click:function(){$$("groups").unselectAll(),this.$scope.ui(l.GroupsWindow).showWindow(this.$scope.$view)}},{view:"button",type:"iconButton",icon:"wxi-pencil",width:150,label:"Изменить",click:function(){if($$("groups").getSelectedItem()){this.$scope.ui(l.GroupsWindow).showWindow(this.$scope.$view)}else webix.message({type:"error",text:"Выберите группу для редактирования"})}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("groups"),{filterHTML:!0,filename:"Группы"})}},{view:"button",type:"iconButton",icon:"fa fa-sync",width:50,click:function(){$$("groups").load("/groups/list")}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),o.d(t,"GroupsWindow",function(){return s});var a=o(0),l=o(2),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this.getThis();return{view:"window",id:"group-add-win",position:"center",move:!0,modal:!0,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:"Группа",inputWidth:100,align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&$$("group-add-win").close()}})}}]},body:{view:"form",id:"group-add-form",paddingY:20,paddingX:30,elementsConfig:{labelWidth:100},width:600,minHeight:350,maxHeight:700,scroll:!0,elements:[{view:"text",name:"id",label:"id",value:0,hidden:!0},{view:"text",name:"name",label:"Название",inputAlign:"left",labelWidth:120,required:!0},{view:"textarea",name:"description",label:"Описание",inputAlign:"left",labelWidth:120,height:100},{view:"multicombo",name:"list_users_ids",label:"Пользователи",inputAlign:"left",labelWidth:120,options:"/groups/users/short"},{view:"multicombo",name:"rules",label:"Права доступа",inputAlign:"left",labelWidth:120,options:{body:{template:"#name#"},url:"/rules/list"}},{},{margin:10,cols:[{},{view:"button",label:"Настройки",align:"center",width:120,click:function(){this.$scope.ui(l.SettingsWindow).showWindow(e.getId(),"group")}},{view:"button",label:"Сохранить",type:"form",align:"center",width:120,click:function(){var e=$$("group-add-form");if(e.validate()){e.disable();var t=e.getValues();console.log(t),webix.ajax().post("/groups/"+t.id+"/save",t).then(function(t){e.enable(),t=t.json(),t.result?(webix.message({type:"success",text:t.message}),e.enable(),webix.$$("group-add-win").close(),$$("groups").load("/groups/list")):(webix.message({type:"error",text:t.text}),e.enable())}).catch(function(t){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),e.enable(),console.log(t)})}else webix.message({type:"error",text:"Заполните обязательные поля"})}},{view:"button",label:"Отмена",align:"center",width:120,click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&$$("group-add-win").close()}})}}]},{}]},on:{onShow:function(){var t=$$("groups").getSelectedItem();t?t.id?(e.setId(t.id),$$("group-add-form").setValues(t)):e.setId(0):($$("group-add-form").setValues({id:0}),e.setId(0))}}}},t.prototype.getThis=function(){return this},t.prototype.getId=function(){return this.groupId},t.prototype.setId=function(e){this.groupId=e},t.prototype.showWindow=function(){this.getRoot().show()},t}(a.b)},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(39),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"contact_groups_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Добавить",click:function(){$$("contact_groups").unselectAll(),this.$scope.ui(l.ContactsGroupsWindow).showWindow(this.$scope.$view)}},{view:"button",type:"iconButton",icon:"wxi-pencil",width:150,label:"Изменить",click:function(){if($$("contact_groups").getSelectedItem()){this.$scope.ui(l.ContactsGroupsWindow).showWindow(this.$scope.$view)}else webix.message({type:"error",text:"Выберите группу для редактирования"})}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("contact_groups"),{filterHTML:!0,filename:"Контактные группы"})}},{view:"button",type:"iconButton",icon:"fa fa-sync",width:50,click:function(){$$("contact_groups").load("/contact_groups/list")}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),o.d(t,"ContactsGroupsWindow",function(){return l});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{view:"window",id:"contact-groups-add-win",position:"center",move:!0,modal:!0,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:"Контактная группа",inputWidth:450,align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&$$("contact-groups-add-win").close()}})}}]},body:{view:"form",id:"group-add-form",paddingY:20,paddingX:30,elementsConfig:{labelWidth:100},width:750,minHeight:300,maxHeight:700,scroll:!0,elements:[{view:"text",name:"id",label:"id",value:0,hidden:!0},{view:"text",name:"name",label:"Название",inputAlign:"left",labelWidth:200,required:!0},{view:"text",name:"queue",label:"Входящая очередь",inputAlign:"left",labelWidth:200,readonly:!0},{view:"multicombo",name:"queues",label:"Входящие очереди",inputAlign:"left",labelWidth:200,options:{body:{template:"#fullname#"},url:"/queues/list/short"}},{view:"multicombo",name:"items_users",label:"Пользователи в группе",inputAlign:"left",labelWidth:200,options:{body:{template:"#value#"},url:"/groups/users/short"}},{view:"multicombo",name:"items_queues",label:"Очереди в группе",inputAlign:"left",labelWidth:200,options:{body:{template:"#fullname#"},url:"/queues/list/short"}},{margin:10,cols:[{},{view:"button",label:"Сохранить",type:"form",align:"center",width:120,click:function(){var e=$$("group-add-form");if(e.validate()){e.disable();var t=e.getValues();webix.ajax().post("/contact_groups/"+t.id+"/save",t).then(function(t){e.enable(),t=t.json(),t.result?(webix.message({type:"success",text:t.message}),e.enable(),webix.$$("contact-groups-add-win").close(),$$("contact_groups").load("/contact_groups/list")):(webix.message({type:"error",text:t.text}),e.enable())}).catch(function(t){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),e.enable()})}else webix.message({type:"error",text:"Заполните обязательные поля"})}},{view:"button",label:"Отмена",align:"center",width:120,click:function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&$$("contact-groups-add-win").close()}})}}]}]},on:{onShow:function(){var e=$$("contact_groups").getSelectedItem();e&&e.id?(e.items_users=e.items.users,e.items_queues=e.items.queues,$$("group-add-form").setValues(e)):$$("group-add-form").setValues({id:0})}}}},t.prototype.showWindow=function(){this.getRoot().show()},t}(a.b)},function(e,t,o){"use strict";function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(){function e(){r(this,e)}return e.prototype.getFormValues=function(){var e=$$("form-phone");return e.validate()?e.getValues():(webix.message({type:"error",text:"Заполните обязательные поля"}),!1)},e.prototype.saveFormValues=function(e,t){parseInt(e.id)||(e.id=0),webix.ajax().post("/phones/"+e.id+"/save",e).then(function(e){$$("form-phone").enable(),e=e.json(),e.result?(webix.message({type:"success",text:e.message}),$$("form-phone").enable(),t&&t()):(webix.message({type:"error",text:e.message}),$$("form-phone").enable())}).error(function(e){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),$$("form-phone").enable(),console.log(e)})},e.prototype.loadTable=function(){$$("phones").load("/phones/list")},e.prototype.closeWindow=function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("window-phone").close()}})},e.prototype.hide=function(){$$("window-phone").close()},e.prototype.getThis=function(){return this},e.prototype.show=function(e){var t=this.getThis(),o={view:"form",id:"form-phone",scroll:!0,elements:[{view:"text",label:"id",name:"id",value:0,hidden:!0},{view:"text",label:"Номер телефона",name:"phone",required:!0},{view:"combo",label:"Модель",id:"phone_model",name:"model",options:"./assets/options/models.json"},{view:"text",label:"MAC-адрес",name:"mac"},{view:"combo",label:"Пользователь",name:"user_id",options:"/groups/users/short"},{view:"text",label:"Логин",name:"login",required:!0},{view:"text",label:"Пароль",name:"password",type:"password"},{view:"combo",label:"Правила набора",name:"rules",suggest:"./assets/options/rules.json",filter:function(e,t){return-1!==e.value.indexOf(t)}},{view:"text",label:"Внешний номер по умолчанию",name:"default_phone"},{cols:[{},{view:"button",label:e.id?"Сохранить":"Добавить",click:function(){var e=t.getFormValues();e&&t.saveFormValues(e,function(){t.hide(),t.loadTable()})}},{view:"button",label:e.id?"Отменить":"Закрыть",click:function(){t.closeWindow()}},{}]},{height:10}],elementsConfig:{inputAlign:"left",labelPosition:"top"},rules:{password:function(t){return!!e.id||t.length>0},user_id:function(e){return"erpico"!=$$("phone_model").getValue()||e.length}}},i={id:"window-phone",view:"window",position:"center",move:!0,modal:!0,resize:!1,scroll:!0,height:700,width:600,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:(e.id?"Изменить ":"Добавить")+"  телефон",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){t.closeWindow()}}]},body:o};webix.ui(i).show(),$$("form-phone").setValues(e)},e}(),s=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return n(t,e),t.prototype.config=function(){var e=new l;return{id:"phones_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-plus",width:150,label:"Добавить",click:function(){e.show({})}},{view:"button",type:"iconButton",icon:"wxi-pencil",width:150,label:"Изменить",click:function(){$$("phones").getSelectedId()?e.show($$("phones").getSelectedItem()):webix.message({type:"error",text:"Выберите телефон для редактирования"})}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("phones"),{filterHTML:!0,filename:"Телефоны"})}},{view:"button",type:"iconButton",icon:"fa fa-sync",width:50,click:function(){e.loadTable()}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(){function e(){r(this,e)}return e.prototype.getFormValues=function(){var e=$$("form-queues");return e.validate()?e.getValues():(webix.message({type:"error",text:"Заполните обязательные поля"}),!1)},e.prototype.saveFormValues=function(e,t){parseInt(e.id)||(e.id=0),webix.ajax().post("/queues/"+e.id+"/save",e).then(function(e){$$("form-queues").enable(),e=e.json(),e.result?(webix.message({type:"success",text:e.message}),$$("form-queues").enable(),t&&t()):(webix.message({type:"error",text:e.message}),$$("form-queues").enable())}).error(function(e){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),$$("form-queues").enable(),console.log(e)})},e.prototype.loadTable=function(){$$("queues").load("/queues/list")},e.prototype.closeWindow=function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("window-queues").close()}})},e.prototype.hide=function(){$$("window-queues").close()},e.prototype.getThis=function(){return this},e.prototype.show=function(e){var t=this.getThis(),o={view:"form",id:"form-queues",scroll:!0,elements:[{view:"text",label:"id",name:"id",value:0,hidden:!0},{view:"text",label:"Код",name:"name",required:!0},{view:"text",label:"Название",name:"fullname",required:!0},{view:"textarea",name:"description",label:"Описание",labelWidth:120,height:100},{view:"text",label:"Адрес скрипта обработки",name:"url"},{view:"text",label:"Закрытие страницы после обработки",name:"close_on_hangup"},{view:"text",label:"SL",name:"sl"},{view:"combo",name:"pattern",label:"Шаблон",required:!0,filter:function(e,t){return-1!==t.indexOf(t)},options:{body:{url:"./assets/options/pattern.json",template:"#value#"}}},{view:"text",label:"ID сервиса",name:"service_id"},{view:"multicombo",name:"users_ids",id:"queues_users_id",label:"Операторы",inputAlign:"left",labelWidth:120,options:"/groups/users/short"},{cols:[{view:"switch",label:"Приоритетная очередь",name:"viq"},{view:"switch",label:"Скрытая очередь",name:"hidden"}]},{cols:[{},{view:"button",label:e.id?"Сохранить":"Добавить",click:function(){var e=t.getFormValues();e&&t.saveFormValues(e,function(){t.hide(),t.loadTable()})}},{view:"button",label:e.id?"Отменить":"Закрыть",click:function(){t.closeWindow()}},{}]},{height:10}],elementsConfig:{inputAlign:"left",labelPosition:"top"}},i={id:"window-queues",view:"window",position:"center",move:!0,modal:!0,resize:!1,scroll:!0,height:700,width:600,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:(e.id?"Изменить ":"Добавить")+"  очередь",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){t.closeWindow()}}]},body:o};webix.ui(i).show(),$$("form-queues").setValues(e),e.agents&&e.agents.ids&&$$("queues_users_id").setValue(e.agents.ids)},e}(),s=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return n(t,e),t.prototype.config=function(){var e=new l;return{id:"queues_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-plus",width:150,label:"Добавить",click:function(){e.show({})}},{view:"button",type:"iconButton",icon:"wxi-pencil",width:150,label:"Изменить",click:function(){$$("queues").getSelectedId()?e.show($$("queues").getSelectedItem()):webix.message({type:"error",text:"Выберите очередь для редактирования"})}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("queues"),{filterHTML:!0,filename:"Очереди"})}},{view:"button",type:"iconButton",icon:"fa fa-sync",width:50,click:function(){e.loadTable()}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(){function e(){r(this,e)}return e.prototype.getFormValues=function(){var e=$$("form-channels");return e.validate()?e.getValues():(webix.message({type:"error",text:"Заполните обязательные поля"}),!1)},e.prototype.saveFormValues=function(e,t){parseInt(e.id)||(e.id=0),webix.ajax().post("/channels/"+e.id+"/save",e).then(function(e){$$("form-channels").enable(),e=e.json(),e.result?(webix.message({type:"success",text:e.message}),$$("form-channels").enable(),t&&t()):(webix.message({type:"error",text:e.message}),$$("form-channels").enable())}).error(function(e){webix.message({type:"error",text:"Произошла ошибка обращения к серверу"}),$$("form-channels").enable(),console.log(e)})},e.prototype.loadTable=function(){$$("channels").load("/channels/list")},e.prototype.closeWindow=function(){webix.confirm({text:"Все несохраненные данные будут утеряны. <br> Продолжить?",callback:function(e){e&&webix.$$("window-channels").close()}})},e.prototype.hide=function(){$$("window-channels").close()},e.prototype.getThis=function(){return this},e.prototype.show=function(e){var t=this.getThis(),o={view:"form",id:"form-channels",scroll:!0,elements:[{view:"text",label:"id",name:"id",value:0,hidden:!0},{view:"text",label:"Код",name:"name",required:!0},{view:"text",label:"Название",name:"fullname",required:!0},{view:"text",label:"Номер телефона",name:"phone"},{view:"combo",label:"Провайдер",name:"provider",options:"./assets/options/providers.json"},{view:"text",label:"Адрес сервера",name:"host"},{view:"text",label:"Порт",name:"port",pattern:{mask:"##########################",allow:/[0-9]/g},validate:function(e){return e.length}},{view:"text",label:"Логин",name:"login",required:!0},{view:"text",label:"Пароль",name:"password",type:"password"},{view:"combo",label:"Правила обработки",name:"rules",suggest:"./assets/options/rules.json",filter:function(e,t){return-1!==e.value.indexOf(t)}},{cols:[{},{view:"button",label:e.id?"Сохранить":"Добавить",click:function(){var e=t.getFormValues();e&&t.saveFormValues(e,function(){t.hide(),t.loadTable()})}},{view:"button",label:e.id?"Отменить":"Закрыть",click:function(){t.closeWindow()}},{}]},{height:10}],elementsConfig:{inputAlign:"left",labelPosition:"top"},rules:{password:function(t){return!!e.id||t.length>0}}},i={id:"window-channels",view:"window",position:"center",move:!0,modal:!0,resize:!1,scroll:!0,height:700,width:600,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:(e.id?"Изменить ":"Добавить")+"  канал",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){t.closeWindow()}}]},body:o};webix.ui(i).show(),$$("form-channels").setValues(e)},e}(),s=function(e){function t(){return r(this,t),i(this,e.apply(this,arguments))}return n(t,e),t.prototype.config=function(){var e=new l;return{id:"channels_toolbar",hidden:!0,cols:[{view:"button",type:"iconButton",icon:"wxi-plus",width:150,label:"Добавить",click:function(){e.show({})}},{view:"button",type:"iconButton",icon:"wxi-pencil",width:150,label:"Изменить",click:function(){$$("channels").getSelectedId()?e.show($$("channels").getSelectedItem()):webix.message({type:"error",text:"Выберите телефон для редактирования"})}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("channels"),{filterHTML:!0,filename:"Каналы"})}},{view:"button",type:"iconButton",icon:"fa fa-sync",width:50,click:function(){e.loadTable()}},{}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(e){var t,o=$$("scripts_lst").getValue();if(!o)return void webix.message({type:"error",text:"Выберите\\добавьте скрипт перед добавление этапа"});var i=e.parent_id?e.parent_id:$$("script_stages").getSelectedId(!1),n=e.id?e.id:0;webix.ui((t={id:"add_script_stage_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('add_script_stage_win').close();"}},t.head={view:"toolbar",margin:-4,cols:[{view:"label",label:n?"Редактирование этапа скрипта":"Добавление этапа скрипта"},{view:"icon",icon:"times-circle",click:"$$('add_script_stage_win').close();"}]},t.resize=!0,t.width=700,t.height=500,t.center=!0,t.position="center",t.modal=!0,t.move=!0,t.body={view:"form",id:"script_stage_form",elements:[{view:"text",label:"Название",name:"name"},{view:"checkbox",labelRight:"Отображать название как заголовок",name:"show_name"},{view:"checkbox",labelRight:"Автоматическая генерация кнопок для перехода на подэтапы",name:"autobuttons"},{view:"checkbox",labelRight:'Отображать кнопки "Назад"/"Вперед"',name:"show_back_next"},{cols:[{view:"button",label:"Сохранить",click:function(){var e=$$("script_stage_form");if(e.validate()){e.disable();var t=e.getValues();t.script_id=o,t.parent_id=i,n&&(t.id=n),webix.ajax().post("/legacy/ext/scripts/save/stage",t,function(t,i,n){e.enable();var i=i.json();1==i.result?($$("add_script_stage_win").close(),$$("script_stages").clearAll(),$$("script_stages").load("/legacy/ext/scripts/liststages/"+o),$$("script_stages").select(i.id)):webix.message({type:"error",text:i.message})})}else webix.message({type:"error",text:"Заполните обязательные поля"})}},{view:"button",label:"Удалить",hidden:!n,click:function(){webix.confirm({title:"Подтверждение удаления",ok:"Удалить",cancel:"Отмена",text:'Вы действительно хотите удалить этап "'+e.name+'"?',type:"confirm-error",callback:function(e){if(e){var t={id:n,delete:1};webix.ajax().post("/legacy/ext/scripts/save/stage",t,function(e,t,i){var t=t.json();1==t.result?($$("add_script_stage_win").close(),$$("script_stages").clearAll(),$$("script_stages").load("/legacy/ext/scripts/liststages/"+o)):webix.message({type:"error",text:t.message})})}}})}}]}],rules:{name:webix.rules.isNotEmpty}},t.on={onShow:function(){$$("script_stage_form").setValues(e)}},t)).show()}function t(e){var t,o=e.id?e.id:0;webix.ui((t={id:"add_script_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('add_script_win').close();"}},t.head={view:"toolbar",margin:-4,cols:[{view:"label",label:o?e.copy?"Копирование скрипта":"Редактирование скрипта":"Добавление скрипта"},{view:"icon",icon:"times-circle",click:"$$('add_script_win').close();"}]},t.resize=!0,t.width=700,t.height=300,t.center=!0,t.position="center",t.modal=!0,t.move=!0,t.body={view:"form",id:"script_form",elements:[{view:"text",label:"Название",name:"name"},{cols:[{view:"button",label:o&&e.copy?"Копировать":"Сохранить",click:function(){var t=$$("script_form");if(t.validate()){t.disable();var i=t.getValues();o&&(i.id=o),e.copy&&(i.copy=e.copy),webix.ajax().post("/legacy/ext/scripts/save",i,function(e,o,i){t.enable();var o=o.json();1==o.result?($$("add_script_win").close(),$$("scripts_lst").getList().clearAll(),$$("scripts_lst").getList().load("/legacy/ext/scripts/list"),$$("scripts_lst").setValue(o.id)):webix.message({type:"error",text:o.message})})}else webix.message({type:"error",text:"Заполните обязательные поля"})}},{view:"button",label:"Удалить",hidden:!(o&&!e.copy),click:function(){webix.confirm({title:"Подтверждение удаления",ok:"Удалить",cancel:"Отмена",text:'Вы действительно хотите удалить скрипт "'+e.name+'"?',type:"confirm-error",callback:function(e){if(e){var t={id:o,delete:1};webix.ajax().post("/legacy/ext/scripts/save",t,function(e,t,o){var t=t.json();1==t.result?($$("add_script_win").close(),$$("scripts_lst").getList().clearAll(),$$("scripts_lst").getList().load("/legacy/ext/scripts/list")):webix.message({type:"error",text:t.message})})}}})}}]}],rules:{name:webix.rules.isNotEmpty}},t.on={onShow:function(){$$("script_form").setValues(e)}},t)).show()}return{id:"scripts_toolbar",hidden:!0,cols:[{view:"button",label:"Добавить этап",width:150,click:function(){e([])}},{view:"button",label:"Изменить этап",width:150,click:function(){var t=$$("script_stages").getSelectedId(!1);if(!t)return void webix.message({type:"error",text:"Выберите этап"});e($$("script_stages").getItem(t))}},{},{view:"combo",label:"Скрипт",width:400,options:"/legacy/ext/scripts/list",id:"scripts_lst",on:{onChange:function(e){$$("script_stages").clearAll(),$$("script_stages").load("/legacy/ext/scripts/liststages/"+e),$$("script_elements").clearAll()}}},{view:"button",label:"Добавить",width:100,click:function(){t([])}},{view:"button",label:"Изменить",width:100,click:function(){var e=$$("scripts_lst").getValue();if(e){var o=$$("scripts_lst").getList().getItem(e);o&&t(o)}else webix.message({type:"error",text:"Выберите скрипт для редактирования"})}},{view:"button",label:"Копировать",width:100,click:function(){var e=$$("scripts_lst").getValue();if(e){var o=$$("scripts_lst").getList().getItem(e);o&&(o.copy=1,t(o))}else webix.message({type:"error",text:"Выберите скрипт для копирования"})}},{view:"button",label:"Тест",width:100,click:function(){$$("scripts_lst").getValue()||webix.message({type:"error",text:"Выберите скрипт для тестирования"})}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"agents_grouped_reports_filter",cols:[{cols:[{id:"startDate_agent_grouped_reports",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:webix.guiutils.yesterday(new Date)},{}]},{cols:[{id:"finishDate_agent_grouped_reports",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{id:"queue_agent_grouped_reports",view:"richselect",label:"Очередь",labelWidth:100,width:333,options:"/legacy/grouped_queues_name/short"},{id:"filter_agent_grouped_reports",view:"richselect",label:"Тип звонков",labelWidth:100,width:370,options:[{id:1,value:"Входящие - все"},{id:2,value:"Входящие - обслуженные"},{id:3,value:"Входящие - необслуженные"},{id:4,value:"Исходящие"}]},{cols:[{view:"button",width:150,label:"Показать отчет"}]},{cols:[{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel"}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"operators_work_report",view:"datatable",resizeColumn:!0,resizeRow:!0,footer:!0,select:!0,hover:"myhover",navigation:!0,multiselect:!0,css:"my_style",tooltip:!0,columns:[{id:"operator_name",header:[{text:"Имя оператора",height:25},{content:"textFilter",height:30}],sort:"string",width:210,footer:{text:"Всего:",height:30}},{id:"time_ready",header:[{text:"Время, сколько был готов"},{content:"textFilter"}],sort:"string",width:200,footer:{content:"avgColumn"}},{id:"time_unready",header:[{text:"Суммарное время"},{content:"textFilter"}],sort:"string",width:160},{id:"time_post",header:[{text:"Суммарное время постобработки"},{content:"textFilter"}],sort:"string",width:260},{id:"time_first",header:[{text:"Время первого входа"},{content:"textFilter"}],sort:"string",width:260},{id:"time_last",header:[{text:"Последнего выхода"},{content:"textFilter"}],sort:"string",width:260},{id:"include",header:[{text:"Включений в очереди"},{content:"textFilter"}],sort:"string",width:260},{id:"take_part",header:[{text:"Очереди, в которых принимал участие"},{content:"textFilter"}],sort:"string",width:450}],ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{id:"operators_work_report_list",view:"treetable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,multiselect:!0,css:"my_style",tooltip:!0,scheme:{$change:function(e){"Начало смены"==e.type&&(e.$css="highlightB"),"Не готов"==e.type&&(e.$css="highlightY"),"Завершение смены"==e.type&&(e.$css="highlightR")}},columns:[{id:"type",header:[{text:"<b>Тип</b>",height:25},{content:"textFilter",height:30}],sort:"string",width:250,template:"{common.treetable()} #type#"},{id:"calldate",header:["<b>Время</b>",{content:"textFilter"}],sort:"string",width:180},{id:"duration",header:["<b>Длительность</b>",{content:"textFilter"}],sort:"string",width:150},{id:"queue",header:["<b>Очередь</b>",{content:"textFilter"}],sort:"string",width:0}],ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"phone",view:"treetable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,multiselect:!0,css:"my_style",columns:[{id:"group",header:[{text:"Группа",height:30},{content:"textFilter",height:35}],sort:"int",width:160,template:"{common.icon()} #group#"},{id:"number",header:[{text:"Номер",height:30},{content:"textFilter",height:35}],sort:"int",width:160},{id:"fio",header:[{text:"ФИО"},{content:"textFilter"}],sort:"int",width:200}]}},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"record_contact_center_layout",rows:[{rows:[{id:"record_contact_center",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",footer:!0,navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"calldate",header:[{text:"Дата",height:25},{content:"serverDateRangeFilter"}],sort:"string",width:220,footer:{text:"Общее количество:",height:30}},{id:"queue",header:[{text:"Очередь"},{content:"selectFilter"}],sort:"string",width:140,footer:{content:"avgColumn"}},{id:"src",header:[{text:"Источник"},{content:"serverFilter"}],sort:"string",width:155,footer:{text:"Общая продолжительность:",colspan:2,height:30}},{id:"dst",header:[{text:"Агент"},{content:"serverFilter"}],sort:"string",width:140},{id:"duration",header:[{text:"Длительность"},{content:"textFilter"}],sort:"string",width:130,footer:{content:"summTimeColumn"}}],disabled:!1,url:"legacy/record_contact_center",ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{height:100,cols:[{id:"myplayer_record_contact_center",view:"datatable",scroll:!1,width:500,columns:[{id:"download",header:"",width:40,template:"<center><a target='_blank' href='#link'>#download#</center>",tooltip:"Скачать"},{id:"card",header:[{text:"Прослушать запись",height:30}],width:320}],data:[{download:"",name:"",card:""}]},{view:"checkbox",labelRight:"Автовоспроизведение",labelWidth:"auto",value:webix.storage.cookie.get("autoplay2")?webix.storage.cookie.get("autoplay2"):0,click:function(){var e=this.getValue();webix.storage.cookie.put("autoplay2",e)}}]}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e,t;return{cols:[(e={id:"dashboardNps",view:"chart"},e.id="detractorsList",e.type="barH",e.height=450,e.css="flip-horizontal-chart chart-detractor",e.value="#sales#",e.tooltip={template:"#comments#"},e.label="<strong>#label#</strong> <span class='chart-number'>#sales#%</span>",e.barWidth=35,e.padding={top:30,left:0,right:10,bottom:20},e.color="#d81b1b",e.legend={values:[{text:"Детракторы",color:"#d81b1b"}],valign:"middle",align:"center",height:22,layout:"x"},e.xAxis={start:0,step:25,end:100,lines:!1},e),(t={id:"dashboardNps",view:"chart"},t.id="promotersList",t.type="barH",t.css="no-flip-horizontal-chart chart-promouter",t.value="#sales#",t.tooltip={template:"#comments#"},t.InnerText="#sales#",t.label=" <span class='chart-number'>#sales#%</span> <strong>#label#</strong>",t.barWidth=35,t.padding={top:30,left:0,right:10,bottom:20},t.color="#27ae60",t.legend={values:[{text:"Промоутеры",color:"#27ae60"}],valign:"middle",align:"center",height:22,layout:"x"},t.xAxis={start:0,step:25,end:100,lines:!1},t)]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="<strong>#name#:</strong><table><tr><td>Промоутеры: &nbsp;</td><td>#promouters#%</td></tr><tr><td>Нейтралы:</td><td>#neutrals#%</td></tr><tr><td>Детракторы:</td><td>#detractors#%</td></tr><tr><td>NPS:</td><td>#nps#%</td></tr><tr><td>Клиентов:</td><td>#allClients#</td></tr></table>",s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"nps",view:"panel",x:0,y:0,dx:1,dy:1,header:"NPS по городам",body:{view:"chart",id:"countListByCities",minWidth:500,minHeight:500,type:"stackedBar",barWidth:30,radius:2,padding:{bottom:110},css:"nps_chart nps_chart_cities",legend:{values:[{text:"Детракторы",color:"#d81b1b"},{text:"Нейтралы",color:"#d4dbd3"},{text:"Промоутеры",color:"#27ae60"},{text:"NPS",color:"#ff9900"}],valign:"middle",align:"center",width:400,height:30,layout:"x"},xAxis:{template:"#name#",width:100},yAxis:{start:0,step:25,end:100,lines:!0},series:[{value:"#detractors#",color:"#d81b1b",tooltip:{template:l}},{value:"#neutrals#",color:"#d4dbd3",tooltip:{template:l}},{value:"#promouters#",color:"#27ae60",tooltip:{template:l}},{type:"line",value:"#nps#",color:"#ff9900",label:"#nps#%(#numberNps#)",item:{borderColor:"#ff9900",color:"#ff9900",type:"s",radius:6,borderWidth:1,shadow:!0},line:{color:"#ff9900",width:3},tooltip:{template:l}}],url:"/legacy/dashboardNps",ready:function(){}}}},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="<strong>#name#:</strong><table><tr><td>Промоутеры: &nbsp;</td><td>#promouters#%</td></tr><tr><td>Нейтралы:</td><td>#neutrals#%</td></tr><tr><td>Детракторы:</td><td>#detractors#%</td></tr><tr><td>NPS:</td><td>#nps#%</td></tr><tr><td>Клиентов:</td><td>#allClients#</td></tr></table>",s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"dashboardNps",view:"panel",x:0,y:0,dx:1,dy:1,header:"NPS по филиалам",body:{view:"chart",id:"countList",minWidth:500,minHeight:500,type:"stackedBar",barWidth:30,radius:2,padding:{bottom:110},css:"nps_chart nps_chart_filials",legend:{values:[{text:"Детракторы",color:"#d81b1b"},{text:"Нейтралы",color:"#d4dbd3"},{text:"Промоутеры",color:"#27ae60"},{text:"NPS",color:"orange"}],valign:"middle",align:"center",width:400,height:30,layout:"x"},xAxis:{template:function(e){if(!e)return"";if(!e.name)return"";if(e.name.toString().length>10){var t=e.name.substring(0,7);return t+="..",t+=e.name.substring(e.name.length-2)}return e.name},width:200},yAxis:{start:0,step:25,end:100,lines:!0},series:[{value:"#detractors#",color:"#d81b1b",tooltip:{template:l}},{value:"#neutrals#",color:"#d4dbd3",tooltip:{template:l}},{value:"#promouters#",color:"#27ae60",tooltip:{template:l}},{type:"line",value:"#nps#",color:"#ff9900",label:"#nps#%(#numberNps#)",item:{borderColor:"#ff9900",color:"#ff9900",type:"s",radius:6,borderWidth:1,shadow:!0},line:{color:"#ff9900",width:3},tooltip:{template:l}}]}}},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return webix.protoUI({name:"my_suggest",$init:function(e){var t=e.body.rows.length;t>1&&(e.body.rows[t]={view:"select",label:"От",id:"markFrom",options:["","0","1","2","3","4","5","6","7","8","9","10"]},e.body.rows[t+1]={view:"select",label:"До",id:"markTo",options:["","0","1","2","3","4","5","6","7","8","9","10"]},e.body.rows[t+2]={view:"button",label:"Применить",click:function(){$$("reports");$$("reports").filterByAll()}})}},webix.ui.checksuggest),webix.ui.datafilter.rowCount=webix.extend({refresh:function(e,t,o){t.firstChild.innerHTML="Итого:  "+e.count()||"0"}},webix.ui.datafilter.summColumn),{id:"reports",view:"datatable",select:!0,css:"my_style",tooltip:!0,footer:!0,resizeColumn:!0,columns:[{id:"id",header:[{text:translate("ID")},{content:"serverFilter"}],sort:"int",width:40,footer:{content:"rowCount",colspan:2}},{id:"city",header:[{text:translate("Город")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:"legacy/nps/options/city"}],sort:"int",width:150,footer:{content:"rowCount",colspan:1}},{id:"filial",header:[{text:translate("Филиал")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:"legacy/nps/options/filial"}],sort:"int",width:150},{id:"channel",header:[{text:translate("Канал")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:"legacy/nps/options/channel"}],sort:"int",width:150},{id:"name",header:[{text:translate("ФИО клиента")},{content:"serverFilter"}],sort:"int",width:150},{id:"lastbuy_date",header:[{text:translate("Дата последней покупки ")},""],width:220},{id:"buyer_status",header:[{text:translate("Статус покупателя")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"}},options:[{id:"Первичный"},{id:"Повторный"}]}],width:180},{id:"motivational_p",header:[{text:translate("Мотивационная программа")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:"legacy/nps/options/motivational_p"}],sort:"int",width:180},{id:"recomendations_mark",header:[{text:translate("Шкала рекомендаций")},{content:"multiSelectFilter",suggest:{view:"my_suggest",fitMaster:!1,width:200}}],sort:"int",width:180},{id:"reason_plus",header:[{text:translate("Причина положительной оценки")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:"legacy/nps/options/reasonPlus"}],sort:"int",width:250},{id:"reason_minus",header:[{text:translate("Причина отрицательной оценки")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:"legacy/nps/options/reasonPlus"}],sort:"int",width:250},{id:"recomendations",header:[{text:translate("Рекомендации по улучшению")},{content:"multiSelectFilter",suggest:{fitMaster:!1,body:{tooltip:function(e){return e.id},template:"#id#"},tooltip:!0},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}},options:"legacy/nps/options/recomendations"}],width:250,sort:"int"}],url:"legacy/nps/report",on:{onBeforeContextMenu:function(e){this.select(e)}},ready:function(){$$("reports").registerFilter($$("daterangepickerForeReports"),{columnId:"date"},{getValue:function(e){return e.getValue()},setValue:function(e,t){e.setValue(t)}}),$$("reports").registerFilter($$("markFrom"),{columnId:"markFrom"},{getValue:function(e){return e.getValue()},setValue:function(e,t){e.setValue(t)}}),$$("reports").registerFilter($$("markTo"),{columnId:"markTo"},{getValue:function(e){return e.getValue()},setValue:function(e,t){e.setValue(t)}}),webix.extend(this,webix.ProgressBar),webix.ui({view:"contextmenu",submenu:"data",width:300,data:[{value:"Анкета",id:"open"}],on:{onMenuItemClick:function(e){if("open"===this.getMenuItem(e).id){var t=$$("reports")?$$("reports").getSelectedItem():0;t?window.open(window.location.origin+"/#!/main/script?id=10&nps="+t.id,"_blank"):webix.message({type:"error",text:"Произошла ошибка"})}}}}).attachTo(this)}}},t}(a.b);t.default=l},function(e,t,o){"use strict";o.d(t,"a",function(){return i});var i=function(){function e(){this.webixJet=!0,this._id=webix.uid(),this._events=[],this._subs={},this._data={}}return e.prototype.getRoot=function(){return this._root},e.prototype.destructor=function(){for(var e=this._events,t=e.length-1;t>=0;t--)e[t].obj.detachEvent(e[t].id);for(var o in this._subs){var i=this._subs[o].view;i&&i.destructor()}this._events=this._container=this.app=this._parent=null},e.prototype.setParam=function(e,t,o){this._data[e]!==t&&(this._data[e]=t,this.app.callEvent("app:paramchange",[this,e,t,o])&&o&&this.show((i={},i[e]=t,i)));var i},e.prototype.getParam=function(e,t){var o=this._data[e];if(void 0!==o||!t)return o;var i=this.getParentView();return i?i.getParam(e,t):void 0},e.prototype.getUrl=function(){return this._url},e.prototype.render=function(e,t,o){var i=this;this._parent=o,t&&(this._index=t[0].index),this._init_url_data(t),e=e||document.body;var n="string"==typeof e?webix.toNode(e):e;return this._container!==n?(this._container=n,this._render(t).then(function(){return i.getRoot()})):this._urlChange(t).then(function(){return i.getRoot()})},e.prototype.getIndex=function(){return this._index},e.prototype.getId=function(){return this._id},e.prototype.getParentView=function(){return this._parent},e.prototype.$$=function(e){if("string"==typeof e){var t=this.getRoot();return t.queryView(function(o){return(o.config.id===e||o.config.localId===e)&&o.$scope===t.$scope},"self")}return e},e.prototype.on=function(e,t,o){var i=e.attachEvent(t,o);return this._events.push({obj:e,id:i}),i},e.prototype.contains=function(e){for(var t in this._subs){var o=this._subs[t].view;if(o===e||o.contains(e))return!0}return!1},e.prototype.getSubView=function(e){var t=this.getSubViewInfo(e);if(t)return t.subview.view},e.prototype.getSubViewInfo=function(e){var t=this._subs[e||"default"];return t?{subview:t,parent:this}:this._parent?this._parent.getSubViewInfo(e):null},e.prototype.getName=function(){return this._name},e.prototype._init_url_data=function(e){e&&e[0]&&(this._data={},webix.extend(this._data,e[0].params,!0)),this._url=e},e}()},function(e,t,o){"use strict";function i(e){"/"===e[0]&&(e=e.substr(1));for(var t=e.split("/"),o=[],i=0;i<t.length;i++){var n=t[i],r={},a=n.indexOf(":");if(-1===a&&(a=n.indexOf("?")),-1!==a)for(var l=n.substr(a+1).split(/[\:\?\&]/g),s=0,c=l;s<c.length;s++){var u=c[s],d=u.split("=");r[d[0]]=decodeURIComponent(d[1])}o[i]={page:a>-1?n.substr(0,a):n,params:r,index:i+1}}return o}function n(e){for(var t=[],o=0,i=e;o<i.length;o++){var n=i[o];t.push("/"+n.page);var a=r(n.params);a&&t.push("?"+a)}return t.join("")}function r(e){var t=[];for(var o in e)t.length&&t.push("&"),t.push(o+"="+encodeURIComponent(e[o]));return t.join("")}t.a=i,t.b=n},function(e,t,o){"use strict";o.d(t,"a",function(){return r});var i=o(110),n=o.n(i),r=function(){function e(e,t){var o=this;this.config=t||{},this._prefix=this.config.routerPrefix,void 0===this._prefix&&(this._prefix="!");var i=function(e){};n()(this._prefix+"*",function(){return o._lastUrl="",i(o.get())}),i=e}return e.prototype.set=function(e,t){if(this.config.routes){var o=e.split("?",2);for(var i in this.config.routes)if(this.config.routes[i]===o[0]){e=i+(o.length>1?"?"+o[1]:"");break}}this._lastUrl=e,n.a.navigate(this._prefix+e,t)},e.prototype.get=function(){var e=this._lastUrl||(window.location.hash||"").replace("#"+this._prefix,"");if(this.config.routes){var t=e.split("?",2),o=this.config.routes[t[0]];o&&(e=o+(t.length>1?"?"+t[1]:""))}return e},e}()},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l={id:"traffic_for_period",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"name",header:[{text:"Направление",height:30}],fillspace:2},{id:"count",header:[{text:"Звонки"}],fillspace:2},{id:"duration",header:[{text:"Длительность"}],fillspace:2}],ready:function(){webix.extend(this,webix.ProgressBar)}},s={id:"popular_city_for_period",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"dst",header:[{text:"Номер телефона",height:30}],fillspace:2},{id:"count_dst",header:[{text:"Звонки"}],fillspace:2},{id:"floor",header:[{text:"Длительность"}],fillspace:2},{id:"group_src",header:[{text:"Сотрудники"}],fillspace:2}],ready:function(){webix.extend(this,webix.ProgressBar)}},c={id:"popular_longdistance_over_period",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"dst",header:[{text:"Номер телефона",height:30}],fillspace:2},{id:"count_dst",header:[{text:"Звонки"}],fillspace:2},{id:"floor",header:[{text:"Длительность"}],fillspace:2},{id:"group_src",header:[{text:"Сотрудники"}],fillspace:2}],ready:function(){webix.extend(this,webix.ProgressBar)}},u={id:"popular_cell_for_period",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"dst",header:[{text:"Номер телефона",height:30}],fillspace:2},{id:"count_dst",header:[{text:"Звонки"}],fillspace:2},{id:"floor",header:[{text:"Длительность"}],fillspace:2},{id:"group_src",header:[{text:"Сотрудники"}],fillspace:2}],ready:function(){webix.extend(this,webix.ProgressBar)}},d={id:"most_calling_employees_for_period",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,tooltip:!0,multiselect:!0,css:"my_style",columns:[{id:"src",header:[{text:"Сотрудник",height:30}],fillspace:2},{id:"count_src",header:[{text:"Звонки"}],fillspace:2},{id:"floor",header:[{text:"Длительность"}],fillspace:2},{id:"group_dst",header:[{text:"Номера"}],fillspace:4,tooltip:"<div style:'color:#000000;'>#group_dst#</div>"}],ready:function(){webix.extend(this,webix.ProgressBar)}},p=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"analysis_outgoing_calls_layout",view:"scrollview",scroll:"y",body:{rows:[{height:250,rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Трафик за период</center>"}],height:30},l]},{view:"resizer"},{height:280,rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Популярные городские звонки за период</center>"}],height:30},s]},{view:"resizer"},{height:280,rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Популярные междугородние звонки за период</center>"}],height:30},c]},{view:"resizer"},{height:280,rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Популярные сотовые звонки за период</center>"}],height:30},u]},{view:"resizer"},{height:280,rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Самые звонящие сотрудники за период</center>"}],height:30},d]}]}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=p},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(5),s=o(6),c=o(7),u=(o.n(c),o(8)),d=(o.n(u),function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return b},t.prototype.init=function(){this.ui(l.default)},t}(a.b));t.default=d;var p={view:"toolbar",paddingX:10,paddingY:4,elements:[{view:"button",type:"icon",icon:"bars",width:30,align:"left",css:"app_button",click:function(){$$("app:menu").toggle()}},{type:"header",borderless:!0,height:56,width:162,template:"<img src='./assets/imgs/logo.png' valign='middle' class='logo' style=\"margin-left: -18px;\"><font class='logo_text' style=\"vertical-align: middle; font-weight: bold;\" > PBX</font>"},{rows:[{height:10}]}]},f={rows:[{type:"wide",body:{cols:[{$subview:!0}]}}]},h={rows:[{body:{cols:[s.default]}}]},b={rows:[p,{cols:[h,f]}]}},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}o.d(t,"a",function(){return n});var n=function(){function e(){i(this,e),this.token=0,this.name="unauth",this.fullname="Не авторизован",this.tokenFromGet=webix.guiutils.getUrlParameter("token")}return e.prototype.authUser=function(e){var t=this;webix.ui({view:"window",id:"loginWindow",width:400,position:"center",modal:!0,move:!0,head:{view:"toolbar",margin:-4,cols:[{view:"label",label:"Авторизация"},{view:"icon",icon:"wxi-close-circle",click:function(){$$("loginWindow").close()}}]},body:{id:"loginForm",view:"form",borderless:!0,elements:[{view:"text",label:"Логин",value:"",name:"login",invalidMessage:"Укажите логин",id:"auth_login"},{view:"text",type:"password",label:"Пароль",name:"password",invalidMessage:"Укажите пароль",id:"auth_password"},{view:"button",value:"Войти",hotkey:"enter",id:"auth_enter",click:function(){var o=$$("loginForm");o.disable();var i=o.getValues();webix.ajax().post("/auth/login",i,{error:function(e,t,o){webix.message({type:"error",text:e})},success:function(i,n,r){var a=n.json();if(o.enable(),!a||void 0===a.error)return void webix.message({type:"error",text:"Unknow error: "+i});0==a.error?($$("loginWindow")&&$$("loginWindow").close(),t.token=a.token,webix.storage.cookie.put("token",a.token),t.check(e)):webix.message({type:"error",text:"Ошибка авторизации: "+a.message})}})}}]},on:{onShow:function(){}}}).show()},e.prototype.check=function(e){var t=this;if(!this.token&&!webix.storage.cookie.get("token")&&!t.tokenFromGet)return this.authUser(e);webix.ajax().get("/auth/info",{token:t.tokenFromGet},{error:function(e,t,o){webix.message({type:"error",text:e})},success:function(o,i,n){var r=i.json();if(!r||void 0===r.error)return void webix.message({type:"error",text:"Unknow error: "+o});r.error?t.authUser(e):(t.tokenFromGet&&!webix.storage.cookie.get("token")&&webix.storage.cookie.put("token",t.tokenFromGet),t.name=r.name,t.fullname=r.fullname,e&&e())}})},e.prototype.logout=function(e){var t=this;webix.ajax().get("/auth/logout",{error:function(e,t,o){webix.message({type:"error",text:e})},success:function(e,o,i){var n=o.json();if(!n||void 0===n.error)return void webix.message({type:"error",text:"Unknow error: "+e});n.error?webix.message({type:"error",text:"Ошибка: "+n.message}):(t.token=0,webix.storage.cookie.put("token",""),document.location.reload())}})},e.prototype.getFullname=function(){return this.fullname},e}()},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(9),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(10),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"channels",view:"datatable",resizeColumn:!0,resizeRow:!0,scrollY:!1,navigation:!0,select:!0,css:"my_style",columns:[{id:"id",header:[{text:"№"},{content:"serverFilter"}],width:50},{id:"name",header:[{text:"Код"},{content:"serverFilter"}],fillspace:1},{id:"fullname",header:[{text:"Название"},{content:"serverFilter"}],fillspace:1},{id:"provider",header:[{text:"Провайдер"},{content:"serverFilter"}],fillspace:1,options:"./assets/options/providers.json"},{id:"login",header:[{text:"Логин"},{content:"serverFilter"}],fillspace:1},{id:"phone",header:[{text:"Номер телефона"},{content:"serverFilter"}],fillspace:1},{id:"host",header:[{text:"Адрес сервера"},{content:"serverFilter"}],fillspace:1},{id:"port",header:[{text:"Порт"},{content:"serverFilter"}],fillspace:1},{id:"rules",header:[{text:"Правила обработки"},{content:"serverFilter"}],fillspace:1,options:"./assets/options/rules.json"}],url:"/channels/list",ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(e.block){if(1==e.$level)return"<span class='webix_icon fa-angle-double-right'></span>";if(2==e.$level)return"<span class='webix_icon fa-question'></span>"}else{if(1==e.$level)return"<span class='webix_icon fa-connectdevelop'></span>";if(2==e.$level)return"<span class='webix_icon fa-delicious'></span>";if(3==e.$level)return"<span class='webix_icon fa-user-circle'></span>";if(4==e.$level)return"<span class='webix_icon fa-calendar'></span>";if(5==e.$level)return""}}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"ext_checklist_table",view:"treetable",resizeColumn:!0,resizeRow:!0,select:!0,type:{folder:a},columns:[{id:"value",header:[{text:""}],template:"{common.treetable()} #value#",width:300},{id:"total",header:[{text:"Итоговый балл"}],width:200},{id:"percent",header:[{text:"Процент"}],width:300}],on:{onItemDblClick:function(e,t,o){var i=$$("ext_checklist_table").getItem(e);4==i.$level&&webix.guiutils.checklistFillWindow(i.user_id,i.date,i.checklist_id)},onAfterLoad:function(e){}}}]}]}},t.prototype.urlChange=function(){},t}(l.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l={fitMaster:!1,width:250,body:{template:"#id#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}};webix.ui.datafilter.rowCount=webix.extend({refresh:function(e,t,o){t.firstChild.innerHTML="Итого:  "+e.count()||"0"}},webix.ui.datafilter.summColumn),webix.ui.datafilter.rowCount=webix.extend({refresh:function(e,t,o){t.firstChild.innerHTML="Итого: "+e.count()||"0"}},webix.ui.datafilter.summColumn);var s={id:"clients",view:"datatable",select:!0,css:"my_style",tooltip:!0,scrollY:!0,scrollX:!0,scrollAlignY:!0,footer:!0,resizeColumn:!0,columns:[{id:"id",header:[{text:translate("ID")},{content:"serverFilter"}],sort:"int",width:40,footer:{content:"rowCount",colspan:2}},{id:"created",header:[{text:translate("Дата добавления")},{content:"serverDateRangeFilter"}],sort:"int",width:180},{id:"phone",header:[{text:translate("Номер телефон")},{content:"serverFilter"}],sort:"int",width:150,template:function(e){return window.MakeCall?"<a href=\"javascript:window.MakeCall('"+e.phone+"');\">"+e.phone+"</a>":'<a href="tel:'+e.phone+'">'+e.phone+"</a>"}},{id:"name",header:[{text:translate("Имя клиента")},{content:"serverFilter"}],sort:"int",width:220},{id:"called",header:[{text:translate("Последний звонок")},{content:"serverDateRangeFilter"}],sort:"int",width:220},{id:"buyer_status",header:[{text:translate("Статус покупателя")},{content:"multiSelectFilter",suggest:l,options:[{id:"Первичный"},{id:"Повторный"}]}],sort:"int",width:180},{id:"lastbuy_date",header:[{text:translate("Дата последней покупки")},""],sort:"int",width:220},{id:"city",header:[{text:translate("Город")},{content:"multiSelectFilter",suggest:l,options:"legacy/nps/options/city"}],sort:"int",width:180},{id:"filial",header:[{text:translate("Филиал")},{content:"multiSelectFilter",suggest:l,options:"legacy/nps/options/filial"}],sort:"int",width:180},{id:"channel",header:[{text:translate("Канал")},{content:"multiSelectFilter",suggest:l,options:"legacy/nps/options/channel"}],sort:"int",width:180},{id:"state",header:[{text:translate("Результат звонка")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#value#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:[{id:0,value:"Не звонили"},{id:1,value:"Не отвечает"},{id:2,value:"Занят"},{id:3,value:"Перезвонить"},{id:4,value:"Состоялся"}]}],sort:"int",template:function(e){var t=["Не звонили","Не отвечает","Занят","Перезвонить","Состоялся"];return e&&e.state?3==e.state&&e.called?t[e.state]+" в "+e.called:t[e.state]:""},width:180},{id:"anketa",width:120,header:[{text:translate("Анкета")},{text:""}],sort:"int",template:function(e){return e?e.id?'<div class="webix_view webix_control webix_el_button" style="display: inline-block; vertical-align: top; border-width: 0px; width: 100px; height: 38px;"><div class="webix_el_box" style="width:100px; height:30px"><button type="button" class="webix_img_btn_abs webixtype_base accountDone" style="width:100%; "><center>Анкета</center></button></div></div></div>':void 0:""}}],datafetch:20,loadahead:10,url:"legacy/nps/clients",on:{onBeforeContextMenu:function(e){this.select(e)},onItemClick:function(e){if("anketa"==e.column){var t=$$("clients").getSelectedItem();window.open(window.location.origin+"/#!/main/script?id=10&nps="+t.id,"_blank")}},onAfterFilter:function(){},onBeforeFilter:function(e,t,o){}},ready:function(){webix.extend(this,webix.ProgressBar),webix.ui({view:"contextmenu",submenu:"data",width:300,data:[{value:"Изменить статус",id:"editStatus",submenu:[{id:"0",value:"Не звонили"},{id:1,value:"Не отвечает"},{id:2,value:"Занят"},{id:3,value:"Перезвонить"},{id:4,value:"Совершен"}]},{value:"Анкета",id:"open"}],on:{onMenuItemClick:function(e){var t=this.getMenuItem(e);if("open"==t.id){var o=$$("clients")?$$("clients").getSelectedItem():0;o?window.open(window.location.origin+"/#!/main/script?id=10&nps="+o.id,"_blank"):webix.message({type:"error",text:"Произошла ошибка"})}else if("editStatus"!=t.id){var i=$$("clients").getSelectedItem();webix.ajax().get("legacy/nps/clients/setstate",{npsId:i.id,state:t.id},function(e){e=JSON.parse(e),e.result?(webix.message({text:"Статус звонка изменен"}),$$("clients").clearAll(),$$("clients").load($$("clients").config.url)):(webix.message({type:"error",text:e.msg}),console.log("err",e.data))})}}}}).attachTo(this)}},c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[s]}},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=new Date,s=l.getDate()<10?"0"+l.getDate():l.getDate(),c=l.getMonth()+1<10?"0"+(l.getMonth()+1):l.getMonth()+1,u=s+"-"+c+"-"+l.getFullYear(),d=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"compare_calls_layout",rows:[{id:"compare_calls",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,height:250,footer:!0,navigation:!0,hover:"myhover",multiselect:!0,css:"my_style",columns:[{id:"0",header:[{text:"Дата",height:30}],sort:"string",template:"#calldate#",width:180,footer:{text:"Всего:",height:30}},{id:"1",header:[{text:"Длительность"}],sort:"string",width:130,footer:{content:"summTimeColumn"}},{id:"2",header:[{text:"Звонки"}],sort:"string",width:155,template:"#share#",footer:{content:"summColumn"}},{id:"3",header:[{text:"ACD, мин"}],sort:"string",width:155,footer:{content:"avaregeTimeColumn"}},{id:"4",header:["ASR, %"],sort:"int",width:120,footer:{content:"avaregeColumn"}},{id:"5",header:[{text:"PDD, сек"}],sort:"int",width:140,footer:{content:"avaregeColumn"}}],url:"/legacy/compare_calls",ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Звонков в час</center>"}],height:30},{id:"compare_calls_chart",view:"chart",type:"line",xAxis:{template:"#hour#"},yAxis:{start:0,step:10},legend:{values:[{text:u,color:"#1293f8"}],align:"right",valign:"middle",layout:"y",width:100,margin:8},series:[{value:"#sales1#",item:{borderColor:"#1293f8",color:"#ffffff"},line:{color:"#1293f8",width:3},tooltip:{template:"Звонки: #sales1# <br>Дата: #day1#"}},{value:"#sales2#",item:{borderColor:"#66cc00",color:"#ffffff"},line:{color:"#66cc00",width:3},tooltip:{template:"Звонки: #sales2# <br>Дата: #day2#"}},{value:"#sales3#",item:{borderColor:"#996600",color:"#ffffff"},line:{color:"#996600",width:3},tooltip:{template:"Звонки: #sales3# <br>Дата: #day3#"}},{value:"#sales4#",item:{borderColor:"#CC0033",color:"#ffffff"},line:{color:"#CC0033",width:3},tooltip:{template:"Звонки: #sales4# <br>Дата: #day4#"}},{value:"#sales5#",item:{borderColor:"#009933",color:"#ffffff"},line:{color:"#009933",width:3},tooltip:{template:"Звонки: #sales5# <br>Дата: #day5#"}}],url:"/legacy/compare_calls_chart",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=d},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(11),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"contact_groups",view:"datatable",resizeColumn:!0,resizeRow:!0,scrollY:!0,scrollX:!0,navigation:!0,select:!0,css:"my_style",fixedRowHeight:!1,tooltip:!0,columns:[{id:"id",header:[{text:"#"}],width:50},{id:"name",header:[{text:"Название"},{content:"serverFilter"}],fillspace:1},{id:"queue",header:[{text:"Входяшая очередь"},{content:"serverFilter"}],fillspace:1},{id:"queues",header:[{text:"Входяшии очереди"},{text:""}],fillspace:1,template:function(e){if(!e||!Array.isArray(e.queues))return"";var t="";return e.queues.forEach(function(e){t.length&&(t+=","),t+=e.fullname}),t}},{id:"items",header:[{text:"Члены группы"},{text:""}],fillspace:3,template:function(e){var t="";return e&&"object"===l(e.items)&&Array.isArray(e.items.queues)&&Array.isArray(e.items.users)?(e.items.queues.forEach(function(e){t.length&&(t+=","),t+=e.fullname}),e.items.users.forEach(function(e){t.length&&(t+=","),t+=e.fullname}),t):"error"}}],url:"/contact_groups/list",on:{onAfterLoad:function(){}},ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.init=function(){this.win2=this.ui(ContactsGroupsWindow)},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[{id:"cti",view:"htmlform",scroll:"y",template:'<div style="padding: 0px 20px 20px 20px"><h1>Памятка по использованию IP-АТС ErpicoPBX</h1><p>Для совершения исходящих вызовов наберите номер телефона и нажмите клавишу «#» или «Набор». При звонке на городские номера нет необходимости набирать префикс, на сотовые и междугородние номера вызов осуществляется через «8» без дополнительных префиксов.</p><h2>Переадресация</h2><p>Для переадресации звонка нажмите два раза клавишу «#» во время разговора, система Вам сообщит об инициализации перевода, наберите внутренний номер сотрудника и нажмите еще раз «#». После ответа сотрудника или когда услышите сигнал вызова положите трубку – вызов уйдет сотруднику. Для возвращения к звонку до завершения переадресации нажмите клавишу «*».<br/>Краткая формула: ## номер #<br/>Возврат: *</p><h2>Перехват</h2><p>Для перехвата звонка наберите «*» и вызов.<br/>Краткая формула: *#</p><h2>Телефонный клиент</h2><p>Телефонный клиент предоставляет расширенные функции телефонии и доступ к онлайн-контролю, статистики и записи разговоров.<br/><br/>Для установки скачайте телефонный клиент по ссылке <a href="https://dl.erpico.ru/ErpicoPBX.msi">ErpicoPBX.msi</a></p><p>Для запуска телефонного клиента щелкните по иконке на рабочем столе. Если программа запускается первый раз нужно верно указать имя сервера, логин и пароль. Уточните эти реквизиты у Вашего системного администратора. Адрес совпадает с адресом АТС, логин, как правило, совпадает с номером телефона.</p><p>Если программа запущена щелкните по иконке на панели задач.</p><p>Когда телефонный клиент запущен Вы можете набирать номера используя функцию Copy2Call. Для осуществления звонка Вам достаточно выделить на любом сайте или в любой программе номер телефона, по которому Вы хотите позвонить и два раза скопировать его в буфер обмена при помощи клавиатуры: Ctrl+C</p><p>На Ваш телефон придет служебный вызов, ответьте на него и система начнет автоматически набор номера.</p><p>Так же в телефонном клиенте Вам доступен справочник сотрудников и история Ваших звонков.</p><h2>Техподдержка</h2><p>По всем вопросам использования АТС и телефонного клиента обращайтесь в нашу службу техподдержки: 8 (4852) 593-100, добавочный код: 2</p></div>'}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(12),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"daily_report_layout",rows:[l.default]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="<strong>#name#:</strong><table><tr><td>Промоутеры: &nbsp;</td><td>#promouters#%</td></tr><tr><td>Нейтралы:</td><td>#neutrals#%</td></tr><tr><td>Детракторы:</td><td>#detractors#%</td></tr><tr><td>NPS:</td><td>#nps#%</td></tr><tr><td>Клиентов:</td><td>#allClients#</td></tr></table>",n={id:"nps/dashboard",view:"panel",x:0,y:0,dx:1,dy:1,header:"NPS по городам",body:{view:"chart",id:"countListByCities",minWidth:500,minHeight:500,type:"stackedBar",barWidth:30,radius:2,padding:{bottom:110},css:"nps_chart nps_chart_cities",legend:{values:[{text:"Детракторы",color:"#d81b1b"},{text:"Нейтралы",color:"#d4dbd3"},{text:"Промоутеры",color:"#27ae60"},{text:"NPS",color:"#ff9900"}],valign:"middle",align:"center",width:400,height:30,layout:"x"},xAxis:{template:"#name#",width:100},yAxis:{start:0,step:25,end:100,lines:!0},series:[{value:"#detractors#",color:"#d81b1b",tooltip:{template:i}},{value:"#neutrals#",color:"#d4dbd3",tooltip:{template:i}},{value:"#promouters#",color:"#27ae60",tooltip:{template:i}},{type:"line",value:"#nps#",color:"#ff9900",label:"#nps#%(#numberNps#)",item:{borderColor:"#ff9900",color:"#ff9900",type:"s",radius:6,borderWidth:1,shadow:!0},line:{color:"#ff9900",width:3},tooltip:{template:i}}],ready:function(){webix.extend(this,webix.ProgressBar),webix.guiutils.getNpsFilter()}}},r={id:"dashboardNps",view:"panel",x:0,y:0,dx:1,dy:1,header:"NPS по филиалам",body:{view:"chart",id:"countList",minWidth:500,minHeight:500,type:"stackedBar",barWidth:30,radius:2,padding:{bottom:110},css:"nps_chart nps_chart_filials",legend:{values:[{text:"Детракторы",color:"#d81b1b"},{text:"Нейтралы",color:"#d4dbd3"},{text:"Промоутеры",color:"#27ae60"},{text:"NPS",color:"orange"}],valign:"middle",align:"center",width:400,height:30,layout:"x"},xAxis:{template:function(e){if(!e)return"";if(!e.name)return"";if(e.name.toString().length>10){var t=e.name.substring(0,7);return t+="..",t+=e.name.substring(e.name.length-2)}return e.name},width:200},yAxis:{start:0,step:25,end:100,lines:!0},series:[{value:"#detractors#",color:"#d81b1b",tooltip:{template:i}},{value:"#neutrals#",color:"#d4dbd3",tooltip:{template:i}},{value:"#promouters#",color:"#27ae60",tooltip:{template:i}},{type:"line",value:"#nps#",color:"#ff9900",label:"#nps#%(#numberNps#)",item:{borderColor:"#ff9900",color:"#ff9900",type:"s",radius:6,borderWidth:1,shadow:!0},line:{color:"#ff9900",width:3},tooltip:{template:i}}]}},a={view:"chart",id:"detractorsList",type:"barH",height:450,css:"flip-horizontal-chart chart-detractor",value:"#sales#",tooltip:{template:"#comments#"},label:"<strong>#label#</strong> <span class='chart-number'>#sales#%</span>",barWidth:35,padding:{top:30,left:0,right:10,bottom:20},color:"#d81b1b",legend:{values:[{text:"Детракторы",color:"#d81b1b"}],valign:"middle",align:"center",height:22,layout:"x"},xAxis:{start:0,step:25,end:100,lines:!1}},l={view:"chart",id:"promotersList",type:"barH",css:"no-flip-horizontal-chart chart-promouter",value:"#sales#",tooltip:{template:"#comments#"},InnerText:"#sales#",label:" <span class='chart-number'>#sales#%</span> <strong>#label#</strong>",barWidth:35,padding:{top:30,left:0,right:10,bottom:20},color:"#27ae60",legend:{values:[{text:"Промоутеры",color:"#27ae60"}],valign:"middle",align:"center",height:22,layout:"x"},xAxis:{start:0,step:25,end:100,lines:!1}},s={rows:[n,r]},c={cols:[a,l]},u={view:"scrollview",id:"verses",body:{rows:[s,c]}};t.default=u},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){$$("gage_sl").setValue(0),$$("gage_lcr").setValue(0),$$("gage_fcr").setValue(0);var e=$$("startDate_ext_dash").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_ext_dash").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":59",a=$$("queues").getValue(),l=$$("agents").getValue(),s=$$("hours").getValue();$$("ext_dashboard_managers").clearAll(),$$("dashboard_tree").clearAll(),$$("callschart").clearAll(),$$("hourschart").clearAll(),$$("operatorsworktime").clearAll(),$$("operatorschart").clearAll();var c={"filter[t1]":o,"filter[t2]":r,"filter[queues]":a,"filter[agents]":l,"filter[hours]":s};webix.ajax("/legacy/ext_dashboard_getgages",c,function(e,t,o){t=t.json(),$$("gage_sl").setValue(t.sl),$$("gage_lcr").setValue(t.lcr),$$("gage_fcr").setValue(t.fcr);var i=$$("box3").getValues();i.items[0].value=t.cost+" р.",$$("box3").setValues(i),$$("gage_ans").setValue(parseFloat(t.aat.replace(/,/,"."))),$$("gage_avg").setValue(t.att),webix.extend($$("ext_dashboard_managers"),webix.ProgressBar),webix.extend($$("operatorschart"),webix.ProgressBar),webix.extend($$("callschart"),webix.ProgressBar),webix.extend($$("hourschart"),webix.ProgressBar),webix.extend($$("dashboard_tree"),webix.ProgressBar),webix.extend($$("operatorsworktime"),webix.ProgressBar),$$("ext_dashboard_managers").showProgress(),$$("operatorschart").showProgress(),$$("callschart").showProgress(),$$("hourschart").showProgress(),$$("dashboard_tree").showProgress(),$$("operatorsworktime").showProgress(),webix.ajax("/legacy/ext_dashboard_agents_stat",c,function(e,t,o){var i=t.json();$$("ext_dashboard_managers").parse(i.data),$$("operatorschart").parse(i.data),$$("ext_dashboard_managers").hideProgress(),$$("operatorschart").hideProgress(),webix.ajax("/legacy/ext_dashboard_callschart",c,function(e,t,o){$$("callschart").parse(e),$$("callschart").hideProgress(),webix.ajax("/legacy/ext_dashboard_hourschart",c,function(e,t,o){$$("hourschart").parse(e),$$("hourschart").hideProgress(),webix.ajax("/legacy/ext_dashboard_treetable",c,function(e,t,o){$$("dashboard_tree").parse(e),$$("dashboard_tree").attachEvent("onDataRequest",function(e){return webix.message("Получение данных "+e),this.parse(webix.ajax().get("/legacy/ext_dashboard_treetable?filter[parent]="+e,c).then(function(e){return e=e.json()})),!1}),$$("dashboard_tree").hideProgress()})})})})}),webix.ajax("/legacy/ext_dashboard_worktimechart",c,function(e,t,o){$$("operatorsworktime").parse(e),$$("operatorsworktime").hideProgress()})}function l(e,t){for(var o=[],i=0;i<e.length;i++){var n=e[i],r=t+"."+i,a={id:r,open:!1,checked:!0};void 0!==n.value&&(a.value=n.value),void 0!==n.elem&&(a.elem=n.elem),void 0!==n.col&&(a.col=n.col),void 0!==n.data&&(data=l(n.data,r),a.data=data),console.log(a),o.push(a)}return o}function s(){var e=[{elem:"gages_row",value:"Показатели",data:[{elem:"gage_sl",value:"SL"},{elem:"gage_lcr",value:"LCR"},{elem:"gage_ans",value:"Ср. ответа"},{elem:"gage_avg",value:"Ср. разговора"},{elem:"gage_fcr",value:"FCR"},{elem:"box3",value:"Стоимость звонка"}]},{elem:"ext_dashboard_managers",value:"Менеджеры",data:[{elem:"ext_dashboard_managers",col:"agent_name",value:"Менеджер"},{elem:"ext_dashboard_managers",col:"total",value:"Звонков"},{elem:"ext_dashboard_managers",col:"served",value:"Принятых"},{elem:"ext_dashboard_managers",col:"served_more20s",value:"После SL"},{elem:"ext_dashboard_managers",col:"unserved",value:"Не принятых"},{elem:"ext_dashboard_managers",col:"served_call_per",value:"Отвеченные(%)"},{elem:"ext_dashboard_managers",col:"sl",value:"SL"},{elem:"ext_dashboard_managers",col:"lcr",value:"LCR"},{elem:"ext_dashboard_managers",col:"avg_answer",value:"Ср. ответа"},{elem:"ext_dashboard_managers",col:"avg_duration",value:"Ср. разговора ВХ"},{elem:"ext_dashboard_managers",col:"out_count",value:"Исходящих"},{elem:"ext_dashboard_managers",col:"out_avg",value:"Ср. разговора ИСХ"},{elem:"ext_dashboard_managers",col:"int_count",value:"Внутренних"},{elem:"ext_dashboard_managers",col:"int_avg",value:"Ср. разговора ВН"}]},{elem:"ext_dashboard_charts",value:"Графики по звонкам",data:[{elem:"callschart",value:"По дням"},{elem:"hourschart",value:"По часам"}]},{elem:"ext_dashboard_charts2",value:"Графики по операторам",data:[{elem:"operatorsworktime",value:"Рабочее время"},{elem:"operatorschart",value:"Среднее время разговоров"}]},{elem:"dashboard_tree",value:"Данные по периодам",data:[{elem:"dashboard_tree",col:"period",value:"Период"},{elem:"dashboard_tree",col:"total",value:"Всего"},{elem:"dashboard_tree",col:"served",value:"Принято"},{elem:"dashboard_tree",col:"served20",value:"Принято > SL"},{elem:"dashboard_tree",col:"unserved",value:"Потеряно"},{elem:"dashboard_tree",col:"lost20",value:"Потеряно > SL"},{elem:"dashboard_tree",col:"served_call_per",value:"Отв (%)"},{elem:"dashboard_tree",col:"sl",value:"SL(%)"},{elem:"dashboard_tree",col:"agents",value:"Операторов"},{elem:"dashboard_tree",col:"avg_lost",value:"ВХ Ср. пот."},{elem:"dashboard_tree",col:"avg_ans",value:"ВХ Ср. отв."},{elem:"dashboard_tree",col:"avg_talk",value:"ВХ Ср. разг."},{elem:"dashboard_tree",col:"max_wait",value:"ВХ Макс. отв."},{elem:"dashboard_tree",col:"max_talk",value:"ВХ Макс. разг."},{elem:"dashboard_tree",col:"out_count",value:"Исходящих"},{elem:"dashboard_tree",col:"out_avg",value:"Ср. разговора ИСХ"},{elem:"dashboard_tree",col:"int_count",value:"Внутренних"},{elem:"dashboard_tree",col:"int_avg",value:"Ср. разговора ВН"}]}];return response=l(e,"ft"),console.log(response),response}Object.defineProperty(t,"__esModule",{value:!0});for(var c=o(0),u=o(13),d=o(14),p=o(15),f=o(16),h=[],b=0;b<24;b++)h.push({id:b,value:b+":00-"+b+"-59"});var w=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{view:"scrollview",id:"verses",scroll:"y",body:{rows:[{type:"space",id:"e1",margin:0,padding:0,rows:[{cols:[{rows:[{type:"space",responsive:"e1",margin:0,padding:0,cols:[{id:"startDate_ext_dash",view:"datepicker",label:"Начало",editable:!0,labelAlign:"right",timepicker:!0,width:300,format:"%d.%m.%Y %H:%i",value:dateSetHM(new Date,8,0)},{id:"finishDate_ext_dash",view:"datepicker",label:"Конец",editable:!0,labelAlign:"right",timepicker:!0,width:300,format:"%d.%m.%Y %H:%i",value:dateSetHM(new Date,21,0)},{view:"multiselect",id:"hours",label:"Часы",labelAlign:"right",labelWidth:100,options:h}]},{cols:[{view:"multiselect",id:"queues",label:"Очереди",labelAlign:"right",width:600,options:"/legacy/grouped_queues_name/short"},{view:"multiselect",id:"agents",label:"Операторы",labelWidth:100,labelAlign:"right",options:"/legacy/ext_dashboard_agentslist/0/short"}]}]},{rows:[{id:"ext_dashboard_fields",view:"button",type:"iconButton",icon:"wxi-cog",width:155,label:"Поля",click:function(){var e;webix.ui((e={id:"fields_setup_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('salary_setup_win').close();"}},e.head={view:"toolbar",margin:-4,cols:[{view:"label",label:"Настройка полей"},{view:"icon",icon:"times-circle",click:"$$('fields_setup_win').close();"}]},e.resize=!0,e.width=600,e.height=500,e.center=!0,e.position="center",e.modal=!1,e.move=!0,e.body={rows:[{id:"fields_tree",view:"tree",template:"{common.icon()} {common.checkbox()} {common.folder()} <span>#value#</span>",select:!0,data:s(),on:{onItemCheck:function(e){elem=$$("fields_tree").getItem(e),elem.checked?void 0!==elem.col?$$(elem.elem).showColumn(elem.col):$$(elem.elem).show():void 0!==elem.col?$$(elem.elem).hideColumn(elem.col):$$(elem.elem).hide()}}}]},e)).show()}},{id:"ext_dashboard_salary",view:"button",type:"iconButton",icon:"wxi-usd",width:155,label:"Оклады",click:function(){var e;webix.ui((e={id:"salary_setup_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('salary_setup_win').close();"}},e.head={view:"toolbar",margin:-4,cols:[{view:"label",label:"Настройка окладов"},{view:"icon",icon:"times-circle",click:"$$('salary_setup_win').close();"}]},e.resize=!0,e.width=600,e.height=500,e.center=!0,e.position="center",e.modal=!0,e.move=!0,e.body={rows:[{view:"datatable",id:"salary_agents",autowidth:!0,editable:!0,columns:[{id:"value",header:"Сотрудник",width:400},{id:"salary",header:"Оклад",width:100,editor:"text"}],url:"/legacy/ext_dashboard_agentslist/",on:{onItemClick:function(e){this.editColumn(e),this.focusEditor(e)}}},{cols:[{view:"button",label:"Сохранить",click:function(){}},{view:"button",label:"Отмена",click:"$$('salary_setup_win').close();"}]}]},e)).show()}}]},{id:"search_ext_dashboard",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){a()}}]}]},u.default,d.default,p.default,f.default]}}]}]}},t.prototype.urlChange=function(){},t}(c.b);t.default=w},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"ext_incoming_external",view:"datatable",subview:{view:"datatable",columns:[{id:"agent_name",header:[{text:"Оператор"}],sort:"string",width:309},{id:"total",header:[{text:"Всего"}],width:160},{id:"served",header:[{text:"Принятых"}],width:160},{id:"unserved",header:[{text:"Не принятых"}],width:160},{id:"avg_answer",header:[{text:"Ср. ответа"}],width:160},{id:"avg_duration",header:[{text:"Ср. обращения"}],width:160},{id:"avg_wait",header:[{text:"Ср. ожидания"}],width:160},{id:"max_wait",header:[{text:"Макс. ожидания"}],width:160},{id:"min_wait",header:[{text:"Мин. ожидания"}],width:160},{id:"lcr",header:[{text:"LCR"}],width:160},{id:"sl",header:[{text:"SL"}],width:160},{id:"rcr",header:[{text:"% повторных"}],width:160},{id:"fcr",header:[{text:"FCR"}],width:160},{id:"transfer",header:[{text:"Переводов"}],width:160},{id:"cost",header:[{text:"Себестоимость"}],width:160},{id:"ready",header:[{text:"Готов"}],width:160},{id:"notready",header:[{text:"Не готов"}],width:160}],data:[],height:300,resizeColumn:!0,resizeRow:!0,select:!0},resizeColumn:!0,resizeRow:!0,select:!0,columns:[{id:"queue_name",header:[{text:"Линия"}],template:"{common.subrow()} #queue_name#",sort:"string",width:160},{id:"agents",header:[{text:"Операторов"}],width:160},{id:"total",header:[{text:"Всего"}],width:160},{id:"served",header:[{text:"Принятых"}],width:160},{id:"unserved",header:[{text:"Не принятых"}],width:160},{id:"avg_answer",header:[{text:"Ср. ответа"}],width:160},{id:"avg_duration",header:[{text:"Ср. обращения"}],width:160},{id:"avg_wait",header:[{text:"Ср. ожидания"}],width:160},{id:"max_wait",header:[{text:"Макс. ожидания"}],width:160},{id:"min_wait",header:[{text:"Мин. ожидания"}],width:160},{id:"lcr",header:[{text:"LCR"}],width:160},{id:"sl",header:[{text:"SL"}],width:160},{id:"rcr",header:[{text:"% повторных"}],width:160},{id:"fcr",header:[{text:"FCR"}],width:160},{id:"transfer",header:[{text:"Переводов"}],width:160},{id:"nwh",header:[{text:"Не рабочее время"}],width:160},{id:"cost",header:[{text:"Себестоимость"}],width:160}],url:"legacy/ext_incoming_external_total",ready:function(){webix.extend(this,webix.ProgressBar)},on:{onSubViewCreate:function(e,t){var o=$$("startDate_ext_in_ext").getValue(),i=o.getMonth()+1,n=o.getFullYear()+"-"+i+"-"+o.getDate()+" "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds(),r=$$("finishDate_ext_in_ext").getValue(),a=r.getMonth()+1,l=r.getFullYear()+"-"+a+"-"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds();e.load("legacy/ext_incoming_external_personal?filter[t1]="+n+"&filter[t2]="+l+"&filter[queue]="+t.queue)}}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"ext_incoming_internal",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,columns:[{id:"number",header:[{text:"Вн. номер"},{content:"serverFilter"}],width:160},{id:"user_name",header:[{text:"Сотрудник"},{content:"serverFilter"}],width:160},{id:"total",header:[{text:"Всего"}],width:160},{id:"served",header:[{text:"Принятых"}],width:160},{id:"unserved",header:[{text:"Не принятых"}],width:160},{id:"avg_answer",header:[{text:"Ср. ответа"}],width:160},{id:"avg_duration",header:[{text:"Ср. обращения"}],width:160},{id:"avg_wait",header:[{text:"Ср. ожидания"}],width:160},{id:"max_wait",header:[{text:"Макс. ожидания"}],width:160},{id:"min_wait",header:[{text:"Мин. ожидания"}],width:160},{id:"lcr",header:[{text:"LCR"}],width:160},{id:"sl",header:[{text:"SL"}],width:160}],url:"/legacy/ext_incoming_internal?",ready:function(){webix.extend(this,webix.ProgressBar),$$("search_ext_incoming_internal").callEvent("onItemClick")}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"ext_outgoing",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,columns:[{id:"number",header:[{text:"Вн. номер"},{content:"serverFilter"}],width:160},{id:"user_name",header:[{text:"Сотрудник"},{content:"serverFilter"}],width:160},{id:"total",header:[{text:"Всего"}],width:160},{id:"served",header:[{text:"Отвеченных"}],width:160},{id:"unserved",header:[{text:"Не отвеченных"}],width:160},{id:"avg_answer",header:[{text:"Ср. ответа"}],width:160},{id:"avg_duration",header:[{text:"Ср. обращения"}],width:160},{id:"avg_wait",header:[{text:"Ср. ожидания"}],width:160},{id:"max_wait",header:[{text:"Макс. ожидания"}],width:160},{id:"min_wait",header:[{text:"Мин. ожидания"}],width:160}],url:"/legacy/ext_outgoing",ready:function(){webix.extend(this,webix.ProgressBar),$$("search_ext_outgoing").callEvent("onItemClick")}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l={id:"grouped_reports1_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Звонки</center>"}],height:30},{id:"grouped_reports",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},s={id:"grouped_reports2_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Суммарное время разговора, ожидания (мин.)</center>"}],height:30},{id:"grouped_reports2",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},c={id:"grouped_reports3_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Причина завершения обслуженных звонков</center>"}],height:30},{id:"grouped_reports3",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},u={id:"grouped_reports4_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Причина завершения необслуженных звонков</center>"}],height:30},{id:"grouped_reports4",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},d={id:"grouped_reports5_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Время разговора (минимальное, среднее, максимальное), сек.</center>"}],height:30},{id:"grouped_reports5",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},p={id:"grouped_reports6_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Время ожидания (минимальное, среднее, максимальное), сек.</center>"}],height:30},{id:"grouped_reports6",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},f={id:"grouped_reports7_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Звонки по уровню обслуживания (обслуженные в интервале ожидания)</center>"}],height:30},{id:"grouped_reports7",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},ready:function(){webix.extend(this,webix.ProgressBar)}}]},h=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"grouped_reports_layout",visibleBatch:"1",rows:[{id:"analysis_outgoing_calls_layout_1",view:"scrollview",batch:1,scroll:"y",body:{height:1120,rows:[{cols:[l,{view:"resizer"},f]},{view:"resizer"},{cols:[p,{view:"resizer"},s]},{view:"resizer"},{cols:[d,{view:"resizer"},c]},{view:"resizer"},{cols:[u]}]}},{id:"agent_report",batch:2,view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,multiselect:!0,tooltip:!0,css:"my_style",columns:[{id:"agent",header:[{text:"<b>Агент</b>",rowspan:3,height:25},{text:"",height:25},{text:"",height:25},{content:"selectFilter",height:30}],sort:"string",template:"#agent#",width:115,footer:{text:"Total:",height:30}},{id:"agent_name",header:[{text:"<b>Имя агента</b>",rowspan:3},{text:""},{text:""},{content:"selectFilter"}],sort:"string",width:120,footer:{content:"avgColumn"}},{id:"total_call",header:[{text:"<b>Звонки</b>",colspan:3},{text:"Всего",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",footer:{content:"summColumn"}},{id:"unserved_call",header:[{text:""},{text:"Необслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:140,template:"#unserved_call_chart#",footer:{content:"summColumn"}},{id:"served_call",header:[{text:""},{text:"Обслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:140,template:"#served_call_chart#",footer:{content:"summColumn"}},{id:"investment_unserved",header:[{text:"<b>Вклад, %</b>",colspan:2},{text:"Необслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:135},{id:"investment_served",header:[{text:""},{text:"Обслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:130},{id:"time_sum_hold",header:[{text:"<b>Время, мин.</b>",colspan:4},{text:"Всего",colspan:2},{text:"Ожидание"},{content:"textFilter"}],sort:"int",width:140,template:"#time_sum_hold_chart#",footer:{content:"summTimeColumn"}},{id:"time_sum_talk",header:[{text:""},{text:""},{text:"Разговор"},{content:"textFilter"}],sort:"int",width:140,template:"#time_sum_talk_chart#",footer:{content:"summTimeColumn"}},{id:"time_avg_hold",header:[{text:""},{text:"Среднее",colspan:2},{text:"Ожидание"},{content:"textFilter"}],sort:"int",width:100,footer:{content:"avaregeTimeColumn"}},{id:"time_avg_talk",header:[{text:""},{text:""},{text:"Разговор"},{content:"textFilter"}],sort:"int",width:100,footer:{content:"avaregeTimeColumn"}}],url:"/legacy/grouped_agents_reports",ready:function(){webix.extend(this,webix.ProgressBar)}},{id:"report_queues",batch:3,view:"scrollview",scroll:"y",body:{height:1010,rows:[{rows:[{id:"report_queues_table",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,multiselect:!0,tooltip:!0,css:"my_style",columns:[{id:"name_queue",header:[{text:"<b>Очередь</b>",rowspan:2,height:25},{text:"",height:25}],width:150,footer:{text:"Всего:",height:30}},{id:"calls_total",header:[{text:"<b>Звонки</b>",colspan:3},{text:"Всего"}],width:120,footer:{content:"summColumn"}},{id:"unserved_call",header:[{text:""},{text:"Необслуженные"}],width:140,template:"#unserved_call_chart#",footer:{content:"summColumn"}},{id:"served_call",header:[{text:""},{text:"Обслуженные"}],width:140,template:"#served_call_chart#",footer:{content:"summColumn"}},{id:"sum_holdtime",header:[{text:"<b>Суммарное время, мин.</b>",colspan:2},{text:"Ожидание"}],width:140,template:"#sum_holdtime_chart#",footer:{content:"summTimeColumn"}},{id:"sum_talktime",header:[{text:""},{text:"Разговор"}],width:140,template:"#sum_talktime_chart#",footer:{content:"summTimeColumn"}}],url:"/legacy/grouped_queues_table_total",ready:function(){webix.extend(this,webix.ProgressBar)}}]},{view:"resizer"},{cols:[{id:"report_queues_chart1_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Всего звонков</center>"}],height:30},{id:"report_queues_chart1",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},url:"/legacy/grouped_queues_table_chart1",ready:function(){webix.extend(this,webix.ProgressBar)}}]},{view:"resizer"},{id:"report_queues_chart2_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Обслуженные звонки</center>"}],height:30},{id:"report_queues_chart2",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",xAxis:{template:"#month#"},yAxis:{start:0,step:10},legend:{values:[{text:"Перевод",color:"#66CCFF"},{text:"Завершен оператором",color:"#FFCC33"},{text:"Завершен клиентом",color:"#FF3333"}],valign:"middle",align:"right",width:250,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"}},{value:"#sales2#",color:"#FFCC33",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales2#</div>",tooltip:{template:"#sales2#"}},{value:"#sales3#",color:"#FF3333",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales3#</div>",tooltip:{template:"#sales3#"}}],url:"/legacy/grouped_queues_table_chart2",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]},{view:"resizer"},{cols:[{id:"report_queues_chart4_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Время разговора (минимальное, среднее, максимальное), сек.</center>"}],height:30},{id:"report_queues_chart4",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",xAxis:{template:"#month#"},yAxis:{start:0,step:10},legend:{values:[{text:"Минимум",color:"#66CCFF"},{text:"Среднее",color:"#FF3333"},{text:"Максимум",color:"#66CC33"}],valign:"middle",align:"right",width:130,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"}},{value:"#sales2#",color:"#FF3333",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales2#</div>",tooltip:{template:"#sales2#"}},{value:"#sales3#",color:"#66CC33",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales3#</div>",tooltip:{template:"#sales3#"}}],url:"/legacy/grouped_queues_table_chart4",ready:function(){webix.extend(this,webix.ProgressBar)}}]},{view:"resizer"},{id:"report_queues_chart5_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Время ожидания (минимальное, среднее, максимальное), сек.</center>"}],height:30},{id:"report_queues_chart5",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",xAxis:{template:"#month#"},yAxis:{start:0,step:10},legend:{values:[{text:"Минимум",color:"#66CCFF"},{text:"Среднее",color:"#FF3333"},{text:"Максимум",color:"#66CC33"}],valign:"middle",align:"right",width:130,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"}},{value:"#sales2#",color:"#FF3333",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales2#</div>",tooltip:{template:"#sales2#"}},{value:"#sales3#",color:"#66CC33",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales3#</div>",tooltip:{template:"#sales3#"}}],url:"/legacy/grouped_queues_table_chart5",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]},{view:"resizer"},{rows:[{id:"report_queues_chart3_l",rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Необслуженные звонки</center>"}],height:30},{id:"report_queues_chart3",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",xAxis:{template:"#month#"},yAxis:{start:0,step:10},legend:{values:[{text:"Прерванные клиентом",color:"#66CCFF"},{text:"Таймаут вызова клиента",color:"#FF3333"},{text:"По нажатию кнопки клиентом",color:"#66CC33"},{text:"По причине пустой очереди",color:"#CC6633"}],valign:"middle",align:"right",width:250,layout:"y"},series:[{value:"#sales#",color:"#66CCFF",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"}},{value:"#sales2#",color:"#FF3333",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales2#</div>",tooltip:{template:"#sales2#"}},{value:"#sales3#",color:"#66CC33",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales3#</div>",tooltip:{template:"#sales3#"}},{value:"#sales4#",color:"#CC6633",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales4#</div>",tooltip:{template:"#sales4#"}}],url:"/legacy/grouped_queues_table_chart3",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}]}}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=h},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{id:"grouped_reports_layout",rows:[{id:"agent_report",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,hover:"myhover",navigation:!0,multiselect:!0,tooltip:!0,css:"my_style",columns:[{id:"agent",header:[{text:"<b>Агент</b>",rowspan:3,height:25},{text:"",height:25},{text:"",height:25},{content:"selectFilter",height:30}],sort:"string",template:"#agent#",width:115,footer:{text:"Total:",height:30}},{id:"agent_name",header:[{text:"<b>Имя агента</b>",rowspan:3},{text:""},{text:""},{content:"selectFilter"}],sort:"string",width:120,footer:{content:"avgColumn"}},{id:"total_call",header:[{text:"<b>Звонки</b>",colspan:3},{text:"Всего",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",footer:{content:"summColumn"}},{id:"unserved_call",header:[{text:""},{text:"Необслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:140,template:"#unserved_call_chart#",footer:{content:"summColumn"}},{id:"served_call",header:[{text:""},{text:"Обслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:140,template:"#served_call_chart#",footer:{content:"summColumn"}},{id:"investment_unserved",header:[{text:"<b>Вклад, %</b>",colspan:2},{text:"Необслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:135},{id:"investment_served",header:[{text:""},{text:"Обслуженные",rowspan:2},{text:""},{content:"textFilter"}],sort:"int",width:130},{id:"time_sum_hold",header:[{text:"<b>Время, мин.</b>",colspan:4},{text:"Всего",colspan:2},{text:"Ожидание"},{content:"textFilter"}],sort:"int",width:140,template:"#time_sum_hold_chart#",footer:{content:"summTimeColumn"}},{id:"time_sum_talk",header:[{text:""},{text:""},{text:"Разговор"},{content:"textFilter"}],sort:"int",width:140,template:"#time_sum_talk_chart#",footer:{content:"summTimeColumn"}},{id:"time_avg_hold",header:[{text:""},{text:"Среднее",colspan:2},{text:"Ожидание"},{content:"textFilter"}],sort:"int",width:100,footer:{content:"avaregeTimeColumn"}},{id:"time_avg_talk",header:[{text:""},{text:""},{text:"Разговор"},{content:"textFilter"}],sort:"int",width:100,footer:{content:"avaregeTimeColumn"}}],url:"/legacy/grouped_agents_reports",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"groups",view:"datatable",resizeColumn:!0,resizeRow:!0,scrollY:!0,scrollX:!0,navigation:!0,select:!0,css:"my_style",fixedRowHeight:!1,tooltip:!0,columns:[{id:"id",header:[{text:"#"}],width:50},{id:"name",header:[{text:"Название"},{content:"serverFilter"}],fillspace:1},{id:"description",header:[{text:"Описание"},{content:"serverFilter"}],fillspace:1},{id:"list_users_str",header:["Список пользователей",""],fillspace:3}],url:"/groups/list",on:{onAfterLoad:function(){this.adjustRowHeight("list_users_str")}},ready:function(){webix.extend(this,webix.ProgressBar),this.adjustRowHeight("list_users_str")}}]}},t.prototype.init=function(){this.win2=this.ui(WindowsView)},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"hourly_load_layout",rows:[{id:"hourly_load",view:"datatable",resizeColumn:!0,resizeRow:!0,height:85,navigation:!0,multiselect:!0,css:"my_style",columns:[{id:"10",header:[{text:"Дата",height:30}],width:180},{id:"1",header:[{text:"Длительность"}],width:130},{id:"2",header:[{text:"Звонки"}],template:"#share#",width:155},{id:"3",header:[{text:"ACD, мин"}],width:155},{id:"4",header:["ASR, %"],width:120},{id:"5",header:[{text:"PDD, сек"}],width:140}],url:"/legacy/hourly_load",ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{borderless:!0,cols:[{rows:[{view:"toolbar",elements:[{view:"label",label:"<center>Звонков в час</center>"}],height:30},{id:"hourly_load_chart",view:"chart",type:"bar",value:"#sales#",color:"#color#",gradient:"rising",label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,step:10},url:"/legacy/hourly_load_chart1",ready:function(){webix.extend(this,webix.ProgressBar)}}]},{view:"resizer"},{rows:[{view:"toolbar",elements:[{view:"label",label:"<center>ASR% по часам</center>"}],height:30},{id:"hourly_load_chart_asr",view:"chart",type:"line",value:"#sales#",item:{borderColor:"#ffffff",color:"#000000"},line:{color:"#ff9900",width:3},label:"<div style='color:#111;font-weight:bold;font-size:1.4em;'>#sales#</div>",tooltip:{template:"#sales#"},xAxis:{template:"#month#"},yAxis:{start:0,end:100,step:10},url:"/legacy/hourly_load_chart2",ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(17),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[l.default]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(18),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[l.default]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(19),s=o(21),c=o(22),u=o(23),d=o(24),p=o(25),f=o(26),h=o(27),b=o(28),w=o(29),g=o(30),_=o(31),m=o(32),v=o(33),y=o(34),x=o(36),$=o(38),j=o(40),k=o(41),C=o(42),O=o(43),P=o(44),S=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"menuBar",rows:[{css:"top-menu",cols:[{view:"button",type:"icon",icon:"fa fa-bars",width:40,align:"left",css:"app_button menu-burger-button",click:function(){$$("sidebar").toggle(),$$("sidebar").getState().collapsed?$$("logobox").hide():$$("logobox").show()}},{type:"header",borderless:!0,height:50,width:162,id:"logobox",template:"<img src='./assets/imgs/logo.png' valign='middle' class='logo' style=\"margin-left: -18px;\"><font class='logo_text' style=\"vertical-align: middle; font-weight: bold;\" > PBX</font>"},{view:"template",id:"app:title",template:"#title#",css:"pbx-title",autowidth:!0},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",id:"phoneExcelButton",hidden:!1,click:function(){webix.toExcel($$("phone"),{filterHTML:!0,filename:"Телефоны"})}},{id:"grouped_reports_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_grouped_reports",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:webix.guiutils.yesterday(new Date)},{}]},{cols:[{id:"finishDate_grouped_reports",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"option_grouped_reports",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"queue_grouped_reports",view:"richselect",label:"Очередь",labelWidth:100,width:333,value:webix.guiutils.queue_grouped_reports,options:"/legacy/grouped_queues_name/short"},{id:"filter_grouped_reports",view:"richselect",label:"Тип звонков",labelWidth:100,width:333,value:webix.guiutils.filter_grouped_reports,options:[{id:1,value:"Входящие - все"},{id:2,value:"Входящие - обслуженные"},{id:3,value:"Входящие - необслуженные"},{id:4,value:"Исходящие"}]},{id:"type_grouped_reports",view:"richselect",label:"Тип отчета",labelWidth:110,width:300,value:webix.guiutils.type_grouped_reports,options:[{id:1,value:"Суммарный отчет"},{id:2,value:"Отчет по агентам"},{id:3,value:"Отчет по очередям"}],on:{onChange:function(){webix.guiutils.type_grouped_reports=$$("type_grouped_reports").getValue()}}},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("filter_grouped_reports").getValue()&&e++,webix.guiutils.filter_grouped_reports=$$("filter_grouped_reports").getValue(),""!=$$("queue_grouped_reports").getValue()&&e++,webix.guiutils.queue_grouped_reports=$$("queue_grouped_reports").getValue(),e>0?($$("option_grouped_reports").define("badge",e),$$("option_grouped_reports").define("label","Опции"),$$("option_grouped_reports").define("icon","check"),$$("option_grouped_reports").refresh()):($$("option_grouped_reports").define("badge",e),$$("option_grouped_reports").define("label","Доп.опции"),$$("option_grouped_reports").define("icon","wxi-plus"),$$("option_grouped_reports").refresh()),$$("filter_grouped_reports").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("filter_grouped_reports").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_grouped_reports",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_grouped_reports")}},{id:"search_grouped_reports",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){webix.guiutils.contact_grouped_reports_refresh()}},{}]},{cols:[{width:27},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",disabled:!0,id:"grouped_reports_export"},{}]},{}]},{id:"lost_calls_toolbar",hidden:!0,cols:[{id:"startDate_lost_calls",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:webix.guiutils.yesterday(new Date)},{id:"finishDate_lost_calls",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{width:27},{id:"search_lost_calls",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){webix.guiutils.contact_lost_calls_refresh()}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("lost_calls_list"),{filterHTML:!0,filename:"Lost"})}},{}]},{id:"analysis_outgoing_calls_toolbar",hidden:!0,cols:[{cols:[{id:"startDate_analysis_outgoing_calls",view:"datepicker",timepicker:!0,width:300,label:"Период от",labelWidth:100,labelAlign:"right",format:"%Y-%m-%d %H:%i:%s",value:webix.guiutils.yesterday(new Date)},{}]},{cols:[{id:"finishDate_analysis_outgoing_calls",view:"datepicker",timepicker:!0,width:300,label:"Период до",labelWidth:100,labelAlign:"right",format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"search_analysis_outgoing_calls",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){webix.guiutils.billing_analysis_outgoing_calls_refresh()}},{width:155}]},{}]},{id:"operators_work_report_toolbar",hidden:!0,cols:[{id:"startDate_operators_work_report",view:"datepicker",width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:webix.guiutils.yesterday(new Date)},{id:"finishDate_operators_work_report",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{width:27},{id:"search_operators_work_report",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){webix.guiutils.contact_operators_work_report_refresh()}},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",click:function(){webix.toExcel($$("operators_work_report"),{filterHTML:!0,filename:"Operators"})}},{}]},s.default,c.default,u.default,d.default,p.default,f.default,h.default,b.default,w.default,g.default,_.default,m.default,v.default,y.default,x.default,$.default,j.default,k.default,C.default,O.default,P.default,{},{height:50,id:"person_template",css:"header_person",borderless:!0,width:200,template:function(e){var t="<div style='height:80%;width:80%;margin-top:0;float: right;' onclick='webix.$$(\"profilePopup\").show(this)'>";return t+="<img class='photo' src='./assets/imgs/photos/4.png' width='30' /><span class='name'>"+webix.auth.getFullname()+"</span>"}}]},{cols:[l.default,{$subview:!0}]}]}},t}(a.b);t.default=S},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=this;return{view:"popup",id:"langSelector",width:300,padding:0,css:"submenu_language",body:{type:"clean",borderless:!0,rows:[{view:"list",autoheight:!0,data:[{id:"en",value:"English"},{id:"ru",value:"Russian"}],type:{height:45,template:" <img class='flag' src='assets/imgs/photos/#id#.png' /><span class='text'>#value#</span>"},select:!0,on:{onSelectChange:function(){return e.toggleLanguage()}}}]},on:{onShow:function(){var e=this.$scope.app.getService("locale");this.queryView({view:"list"}).select(e.getLang())}}}},t.prototype.showWindow=function(){this.getRoot().show()},t.prototype.toggleLanguage=function(){var e=this.app.getService("locale"),t=this.getRoot().queryView({view:"list"}).getSelectedId();t!=e.getLang()&&(e.setLang(t),location.reload())},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"analysis_outgoing_calls_layout_1",view:"scrollview",batch:1,scroll:"y",body:{height:1120,rows:[{cols:[grouped_reports,{view:"resizer"},grouped_reports7]},{view:"resizer"},{cols:[grouped_reports6,{view:"resizer"},grouped_reports2]},{view:"resizer"},{cols:[grouped_reports5,{view:"resizer"},grouped_reports3]},{view:"resizer"},{cols:[grouped_reports4]}]}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t){webix.Date.add(new Date,-7,"day"),webix.Date.add(new Date,1,"day"),npsTooltip,npsTooltip,npsTooltip,npsTooltip,npsTooltip,npsTooltip,npsTooltip,npsTooltip},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"space",id:"a5",margin:0,padding:0,rows:[{type:"space",responsive:"a5",margin:0,padding:0,cols:[{cols:[{id:"startDate_grouped_reports",view:"datepicker",inputHeight:20,width:300,label:"Период от",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:yesterday(new Date)},{}]},{cols:[{id:"finishDate_grouped_reports",view:"datepicker",width:300,label:"Период до",labelWidth:100,labelAlign:"right",timepicker:!0,format:"%Y-%m-%d %H:%i:%s",value:new Date},{}]},{cols:[{width:27},{id:"option_grouped_reports",view:"button",type:"iconButton",icon:"wxi-plus",width:120,label:"Доп.опции",badge:0,click:function(){var e={view:"form",borderless:!0,elements:[{id:"queue_grouped_reports",view:"richselect",label:"Очередь",labelWidth:100,width:333,value:queue_grouped_reports},{id:"filter_grouped_reports",view:"richselect",label:"Тип звонков",labelWidth:100,width:333,value:filter_grouped_reports,options:[{id:1,value:"Входящие - все"},{id:2,value:"Входящие - обслуженные"},{id:3,value:"Входящие - необслуженные"},{id:4,value:"Исходящие"}]},{id:"type_grouped_reports",view:"richselect",label:"Тип отчета",labelWidth:110,width:300,value:type_grouped_reports,options:[{id:1,value:"Суммарный отчет"},{id:2,value:"Отчет по агентам"},{id:3,value:"Отчет по очередям"}],on:{onChange:function(){type_grouped_reports=$$("type_grouped_reports").getValue()}}},{cols:[{view:"button",value:"Добавить",click:function(){var e=0;""!=$$("filter_grouped_reports").getValue()&&e++,filter_grouped_reports=$$("filter_grouped_reports").getValue(),""!=$$("queue_grouped_reports").getValue()&&e++,queue_grouped_reports=$$("queue_grouped_reports").getValue(),e>0?($$("option_grouped_reports").define("badge",e),$$("option_grouped_reports").define("label","Опции"),$$("option_grouped_reports").define("icon","check"),$$("option_grouped_reports").refresh()):($$("option_grouped_reports").define("badge",e),$$("option_grouped_reports").define("label","Доп.опции"),$$("option_grouped_reports").define("icon","wxi-plus"),$$("option_grouped_reports").refresh()),$$("filter_grouped_reports").getTopParentView().close()}},{view:"button",value:"Отмена",click:function(){$$("filter_grouped_reports").getTopParentView().close()}}]}],rules:{},elementsConfig:{labelPosition:"top"}};webix.ui({view:"window",id:"win_option_grouped_reports",width:300,position:"center",modal:!0,head:"Дополнительные опции",body:webix.copy(e)}),function(e,t){$$(e).getBody().clear(),$$(e).show(t),$$(e).getBody().focus()}("win_option_grouped_reports")}},{id:"search_grouped_reports",view:"button",type:"iconButton",icon:"wxi-search",width:155,label:"Показать отчет",click:function(){}},{}]},{cols:[{width:27},{view:"button",type:"iconButton",icon:"fa fa-file-excel",width:150,label:"Экспорт в Excel",disabled:!0,id:"grouped_reports_export"},{}]},{}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t){},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"month_traffic_layout",rows:[{id:"month_traffic",view:"datatable",resizeColumn:!0,resizeRow:!0,select:!0,footer:!0,navigation:!0,hover:"myhover",multiselect:!0,css:"my_style",columns:[{id:"10",header:[{text:"Месяц",height:25},{content:"selectFilter",height:30}],sort:"string",width:180,template:"#month#",footer:{text:"Всего:",height:30}},{id:"1",header:["Длительность",{content:"textFilter"}],sort:"int",template:"#time#",width:130,footer:{content:"summTimeColumn"}},{id:"2",header:["Звонки",{content:"textFilter"}],sort:"int",width:155,template:function(e){return e&&e.share?e.share:e[1]},footer:{content:"summColumn"}},{id:"3",header:["ACD, мин",{content:"textFilter"}],sort:"string",width:155,footer:{content:"avaregeTimeColumn"}},{id:"4",header:["ASR, %",{content:"textFilter"}],sort:"int",width:120,footer:{content:"avaregeColumn"}},{id:"5",header:["PDD, сек",{content:"textFilter"}],sort:"int",width:140,footer:{content:"avaregeColumn"}}],disabled:!0,ready:function(){webix.extend(this,webix.ProgressBar)}},{view:"resizer"},{id:"month_traffic_chart",view:"chart",type:"pie3D",value:"#sales#",color:"#color#",tooltip:{template:"#month#"},pieInnerText:"",shadow:0,disabled:!0,legend:{layout:"y",width:250,align:"right",valign:"middle",template:"<div style='color:#111;font-weight:bold;'>#month#</div>"},ready:function(){webix.extend(this,webix.ProgressBar)}}]}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{id:"clients",view:"datatable",select:!0,css:"my_style",tooltip:!0,scrollY:!0,scrollX:!0,scrollAlignY:!0,footer:!0,resizeColumn:!0,columns:[{id:"id",header:[{text:translate("ID")},{content:"serverFilter"}],sort:"int",width:40,footer:{content:"rowCount",colspan:2}},{id:"created",header:[{text:translate("Дата добавления")},{content:"serverDateRangeFilter"}],sort:"int",width:180},{id:"phone",header:[{text:translate("Номер телефон")},{content:"serverFilter"}],sort:"int",width:150,template:function(e){return window.MakeCall?"<a href=\"javascript:window.MakeCall('"+e.phone+"');\">"+e.phone+"</a>":'<a href="tel:'+e.phone+'">'+e.phone+"</a>"}},{id:"name",header:[{text:translate("Имя клиента")},{content:"serverFilter"}],sort:"int",width:220},{id:"called",header:[{text:translate("Последний звонок")},{content:"serverDateRangeFilter"}],sort:"int",width:220},{id:"buyer_status",header:[{text:translate("Статус покупателя")},{content:"multiSelectFilter",suggest:filterSuggest,options:[{id:"Первичный"},{id:"Повторный"}]}],sort:"int",width:180},{id:"lastbuy_date",header:[{text:translate("Дата последней покупки")},""],sort:"int",width:220},{id:"city",header:[{text:translate("Город")},{content:"multiSelectFilter",suggest:filterSuggest,options:"controllers/reports.php?action=citylList"}],sort:"int",width:180},{id:"filial",header:[{text:translate("Филиал")},{content:"multiSelectFilter",suggest:filterSuggest,options:"controllers/reports.php?action=filialList"}],sort:"int",width:180},{id:"channel",header:[{text:translate("Канал")},{content:"multiSelectFilter",suggest:filterSuggest,options:"controllers/reports.php?action=channelList"}],sort:"int",width:180},{id:"state",header:[{text:translate("Результат звонка")},{content:"multiSelectFilter",suggest:{fitMaster:!1,width:250,body:{template:"#value#"},on:{onBeforeShow:function(){var e=this.getList(),t=[];e.data.each(function(e){t.push(e.id)});var o=webix.html.getTextSize(t,"webix_list_item").width+100;this.define("width",o),this.resize()}}},options:[{id:0,value:"Не звонили"},{id:1,value:"Не отвечает"},{id:2,value:"Занят"},{id:3,value:"Перезвонить"},{id:4,value:"Состоялся"}]}],sort:"int",template:function(e){var t=["Не звонили","Не отвечает","Занят","Перезвонить","Состоялся"];return e&&e.state?3==e.state&&e.called?t[e.state]+" в "+e.called:t[e.state]:""},width:180},{id:"anketa",width:120,header:[{text:translate("Анкета")},{text:""}],sort:"int",template:function(e){return e?e.id?'<div class="webix_view webix_control webix_el_button" style="display: inline-block; vertical-align: top; border-width: 0px; width: 100px; height: 38px;"><div class="webix_el_box" style="width:100px; height:30px"><button type="button" class="webix_img_btn_abs webixtype_base accountDone" style="width:100%; "><center>Анкета</center></button></div></div></div>':void 0:""}}],datafetch:20,loadahead:10,url:"legacy/nps/clients",on:{onBeforeContextMenu:function(e){this.select(e)},onItemClick:function(e){if("anketa"==e.column){var t=$$("clients").getSelectedItem();window.open(window.location.origin+"/#!/main/script?id=10&nps="+t.id,"_blank")}},onAfterFilter:function(){},onBeforeFilter:function(e,t,o){}},ready:function(){webix.extend(this,webix.ProgressBar)}}},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){webix.require("https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js").then(function(){domtoimage.toJpeg($$(e).$view,{quality:.95,bgcolor:"#fff"}).then(function(e){pdfjs.load("//cdn.webix.com//extras/pt-sans.regular.ttf",function(t,o){var i=new pdfjs.Document;pdfjs.load(e,function(e,t){var o=new pdfjs.Image(t);i.image(o);var n=i.render(),r=new Blob([n.toString()],{type:"application/pdf"});webix.html.download(r,"Data.pdf")})})})})}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=o(49),c=o(50),u=o(48),d={rows:[s.default,c.default,u.default]},p={type:"space",cols:[{view:"daterangepicker",name:"default",width:300,label:"Период",id:"rangePickerFilter",value:{start:webix.Date.add(new Date,-7,"day"),end:webix.Date.add(new Date,1,"day")},on:{onChange:function(){getFilter()}}},{view:"combo",label:"Город",id:"cityFilter",on:{onChange:function(){getFilter()}},options:"controllers/reports.php?action=citylList"},{view:"combo",label:"Филиал",id:"filialFilter",on:{onChange:function(){getFilter()}},options:"controllers/reports.php?action=filialList"},{view:"combo",label:"Канал",id:"channel",on:{onChange:function(){getFilter()}},options:"controllers/reports.php?action=channelList"},{width:115,view:"button",type:"iconButton",icon:"wxi-sync",label:"Обновить",click:function(){getFilter()}},{view:"button",label:"Export to PDF",width:140,click:function(){a("charts")}},{}]},f=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{view:"scrollview",id:"verses",body:{rows:[p,d]}}},t.prototype.urlChange=function(){},t}(l.b);t.default=f},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(45),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(1),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e,t=[{id:1,value:"В очереди"},{id:2,value:"Вызывается"},{id:3,value:"Занят"},{id:4,value:"Ошибка"},{id:5,value:"Переход"},{id:6,value:"Завершен"},{id:7,value:"Остановлен"},{id:8,value:"Запланирован"}];return{id:"co-calls-window",view:"window",position:"center",move:!0,modal:!0,resize:!1,scroll:!0,height:500,width:900,head:{view:"toolbar",paddingY:1,height:40,cols:[{view:"label",label:"Звонки контакту",align:"left"},{view:"icon",icon:"wxi-close-circle",click:function(){$$("co-calls-window").hide()}}]},body:(e={view:"datatable",id:"co-calls-table",scroll:!0,tooltip:!0,resizeColumn:!0},e.scroll=!0,e.columns=[{id:"time",header:"Дата и время",fillspace:2,format:webix.Date.dateToStr("%d.%m.%y в %H:%i"),minWidth:100},{id:"rbt_duration",header:"Вызов(сек)",fillspace:2,minWidth:100},{id:"duration",header:"Разговор(сек)",fillspace:2,minWidth:100},{id:"hangup_code",header:"Код завершения",fillspace:4,minWidth:100,template:function(e){return e?e.status_text?e.status_text:e.hangup_code?e.hangup_code:"":""}},{id:"state",header:"Результат",width:100,template:function(e){if(console.log(e.state),6==e.state||3==e.state)var o=t[e.state].value+"(a)";else var o=t[e.state].value;return o}}],e)}},t.prototype.showWindow=function(e){e&&e.id&&this.$$("co-calls-table").load("/outgoingcampaign/result/"+e.id+"/calls"),this.getRoot().show()},t}(a.b),c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){for(var e=this,t=[],o=["00","10","20","30","40","50","59"],i=["1","3","5","10","15","20"],n=[{id:1,value:"В очереди"},{id:2,value:"Вызывается"},{id:3,value:"Занят"},{id:4,value:"Ошибка"},{id:5,value:"Переход"},{id:6,value:"Завершен"},{id:7,value:"Остановлен"},{id:8,value:"Запланирован"}],r=["OCA_MANAGER","OCS_PHONE","OCS_QUEUE","OCS_PLAYFILE"],a=function(e,t){r.forEach(function(t){if(t==e)return!1;$$(t)&&$$(t).setValue(0)})},s=function(e){var t={};return r.forEach(function(o){if(0!=e[o])return t.action=e[o],void(t.value=e[o+"value"])}),t},c=function(){$$("oc-queues").clearAll(),$$("oc-results").clearAll(),$$("co-form").setValues({}),$$("outgoingcampaign-toolbar").show(),$$("outgoingcampaigns").show(),$$("outgoingcampaign-form").hide(),$$("outgoingcampaigns").load("/outgoingcampaign/list")},u=function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")},d=function(e){var t=[],o=window.settingsResult?window.settingsResult:e.settings;return!!o&&(o.forEach(function(e){var o={};parseInt(e.pause)&&(o.pause=1,o.pause_time=e.pause_time),parseInt(e.stop)?o.stop=1:parseInt(e.postpone_for_radio)?o.postpone_for=e.postpone_for:parseInt(e.postpone_to)&&(o.postpone_to=e.postpone_to_date),o.result=e.id,t.push(o)}),t)},p=function(){var e=$$("co-form").getValues(),t={};t.id=parseInt(e.id)?e.id:0,0==t.id&&(t.state=1),t.name=e.name,t.description=e.description,t.date_finish=webix.Date.dateToStr("%Y-%m-%d")(e.date_finish),t.date_start=webix.Date.dateToStr("%Y-%m-%d")(e.date_start),t.time_start=e.hours_start.toString()+":"+e.minutes_start.toString()+":00",t.time_finish=e.hours_finish.toString()+":"+e.minutes_finish.toString()+":00",t.days=u($$("weekDays-form").getValues()),t.call_tries=e.call_tries;var o=s(e);t.action=o.action,t.action_value=o.value,t.min_call_time=window.min_call_time,t.concurrent_calls_limit=window.concurrent_calls_limit;var i=d(e);return i&&(t.settings=i),t.phones=$$("oc-queues").serialize(),t},f=0,h=function(){webix.ui({view:"window",id:"importPhoneWindow",position:"center",move:!0,resizw:!0,modal:!0,width:700,height:500,scroll:!0,head:{view:"toolbar",margin:-4,cols:[{view:"label",label:"Импорт телефонов"},{view:"icon",icon:"times-circle",click:function(){webix.confirm({text:"Внесенные изменения не будут сохранены. <br/> Продолжить?",ok:"Ок",cancel:"Отмена",callback:function(e){e&&$$("importPhoneWindow").close()}})}}]},body:{id:"importForm",view:"form",elements:[{view:"uploader",value:translate("Выберите CSV файл"),on:{onBeforeFileAdd:function(e){var t=[{id:"phone",value:translate("Номер телефона")},{id:"name",value:translate("Имя контакта")},{id:"description",value:translate("Примечание")},{id:"state",value:translate("Состояние")}];if("csv"==e.type){var o=new FileReader;return o.onload=function(e){for(var o=e.target.result.split("\n"),i=0;i<o.length;i++){var n={};o[i]=o[i].split("\t");for(var r=0;r<o[i].length;r++)n["field"+(r+1)]=o[i][r];o[i]=n}for(var a=[],i=0;i<o.length;i++)a.push(o[i].field1.split(";",-1));for(var l=webix.toArray($$("importData").config.columns),i=0;i<a[0].length;i++)l.insertAt({id:"field"+i,header:[{content:"selectFilter",options:t}]},i);$$("importData").refreshColumns(),$$("importData").clearAll();for(var i=0;i<a.length;i++){for(var n={},r=0;r<a[i].length;r++)n["field"+r]=a[i][r];a[i]=n,$$("importData").parse(a[i])}},o.readAsText(e.file),!1}webix.message({type:"error",text:"Неизвестный тип файла!"})}}},{view:"datatable",id:"importData",select:!0,resize:!0,resizeColumn:!0,columns:[],ready:function(){this.filterByAll=function(){}}},{margin:20,cols:[{view:"button",id:"importButton",type:"form",value:"Импортировать",align:"right",click:function(){var t=b(),o=[],i=$$("importData").serialize();if(!t||!t.phone)return webix.message({type:"error",text:"Выберите телефон"}),!1;for(var n in i)if(i[n]){var r={phone:String(i[n]["field"+t.phone]),name:"undefined"!=String(i[n]["field"+t.name])?String(i[n]["field"+t.name]):null,description:"undefined"!=String(i[n]["field"+t.description])?String(i[n]["field"+t.description]):null,state:"undefined"!=String(i[n]["field"+t.state])?String(i[n]["field"+t.state]):null,id:webix.uid()};r.phone.length&&o.push(r)}o?(e.$$("oc-queues").parse(o),w(),webix.message({type:"success",text:"Телефоны импортированы в таблицу!"}),$$("importPhoneWindow").close()):webix.message({type:"error",text:"Нет данных!"})}}]}]},ready:function(){webix.extend($$("importPhoneWindow"),webix.ProgressBar)}}).show()},b=function(){var e=$$("importData").serialize(),t=[];if(e&&e.length)for(var o in e[0])"id"!=o&&t.push($$("importData").getFilter(o).value);var i=!1;for(var n in t){if("phone"==t[n]){i=!0;break}i=!1}if(i){var r=[];for(var a in t)-1!=t[a].indexOf("phone")&&(r.phone=a),-1!=t[a].indexOf("name")&&(r.name=a),-1!=t[a].indexOf("description")&&(r.description=a),-1!=t[a].indexOf("state")&&(r.state=a);return r}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$$("oc-queues").serialize(),t=$$("oc-results").serialize().length,o=0,i=0,n=0;for(var r in e){var a=e[r];switch(parseInt(a.state)){case 1:++n;break;case 6:++t;break;case 3:++o;break;case 4:++i}}$$("phones-total-info").setValue("Контактов в списке: "+e.length+" Завершено: "+t+", Занят/не отвечает: "+o+", Ошибка дозвона: "+i+", В очереди: "+n)};f<=23;)f<=9&&(f="0"+f.toString()),t.push(f.toString()),f++;return{hidden:!0,id:"outgoingcampaign-form",rows:[{template:"Редактирование кампании",type:"header"},{view:"form",id:"co-form",padding:24,scroll:!0,rows:[{rows:[{margin:10,cols:[{view:"fieldset",label:"Название",body:{view:"text",name:"name",required:!0,tooltip:"Название кампании: #value#"}},{view:"fieldset",label:"Период проведения",body:{cols:[{required:!0,view:"datepicker",name:"date_start",label:"Начало",labelPosition:"left",placeholder:"Click to select"},{required:!0,view:"datepicker",name:"date_finish",label:"Конец",labelPosition:"left",placeholder:"Click to select"}]}},{view:"fieldset",label:"Время звонка",body:{cols:[{view:"label",label:"С:",width:20},{view:"richselect",name:"hours_start",options:t,required:!0},{view:"richselect",name:"minutes_start",options:o,required:!0},{view:"label",label:"По:",width:50},{view:"richselect",name:"hours_finish",options:t,required:!0},{view:"richselect",name:"minutes_finish",options:o,required:!0}]}}]},{margin:10,cols:[{view:"fieldset",label:"Описание кампании",body:{required:!0,view:"textarea",name:"description",tooltip:"Описание кампании: #value#"}},{view:"fieldset",label:"Дни недели",body:{view:"form",id:"weekDays-form",elements:[{name:"weekDays",rows:[{cols:[{view:"checkbox",name:1,labelRight:"Пн",labelWidth:0},{view:"checkbox",name:2,labelRight:"Вт",labelWidth:0},{view:"checkbox",name:3,labelRight:"Ср",labelWidth:0},{view:"checkbox",name:4,labelRight:"Чт",labelWidth:0},{view:"checkbox",name:5,labelRight:"Пт",labelWidth:0},{view:"checkbox",name:6,labelRight:"Сб",labelWidth:0},{view:"checkbox",name:7,labelRight:"Вс",labelWidth:0}]},{cols:[{view:"checkbox",name:8,labelRight:"Рабочие дни",labelWidth:0,disabled:!0},{view:"checkbox",name:9,labelRight:"Выходные",labelWidth:0,disabled:!0},{view:"checkbox",name:10,labelRight:"Праздники",labelWidth:0,disabled:!0}]}]}]}},{rows:[{view:"fieldset",label:"Настройка",body:{cols:[{view:"richselect",label:"Попыток",options:i,name:"call_tries",tooltip:"Попыток: #value#",required:!0},{view:"button",label:"Расширенные",click:function(){this.$scope.ui(l.OCRulesWnd).showWindow(this.$scope.$view);var e=$$("co-form").getValues();parseInt(e.id)?($$("co-settings-result").parse(e.settings),$$("co-settings-result").unselectAll(),$$("co-settings-result").select("0")):$$("co-settings-result").load("/outgoingcampaign/0/settings").then(function(){$$("co-settings-result").unselectAll(),$$("co-settings-result").select("0")})}}]}},{},{cols:[{view:"button",label:"Обновить статусы",click:function(){var e=$$("co-form").getValues();parseInt(e.id)||(e.id=0),$$("oc-queues").clearAll(),$$("oc-results").clearAll(),$$("oc-queues").load("outgoingcampaign/"+e.id+"/queues","json",function(){w()}),$$("oc-results").load("outgoingcampaign/"+e.id+"/results","json",function(){w()})}}]}]}]},{margin:10,cols:[{view:"tabview",id:"co-tabview",cells:[{header:"Очередь",width:150,body:{id:"oc-queues-tab",rows:[{view:"datatable",id:"oc-queues",select:!0,tooltip:!0,resizeColumn:!0,scroll:!0,minHeight:200,editable:!0,columns:[{id:"phone",header:"Номер телефона",width:150,minWidth:50,editor:"text"},{id:"name",header:"Имя контакта",fillspace:2,minWidth:90,editor:"text"},{id:"description",header:"Примечание",fillspace:2,minWidth:90,editor:"text"},{id:"state",header:"Состояние",fillspace:2,minWidth:90,options:n,editor:"select"}],on:{"data->onParse":function(e,t){w(t)}},scheme:{$init:function(e){parseInt(6==e.state||4==e.state)?e.$css="bad-row":e.$css="good-row"}}},{cols:[{view:"button",type:"iconButton",icon:"wxi-file",width:260,label:"Импорт из CSV...",click:function(){h()}},{view:"button",type:"iconButton",icon:"fa fa-plus",width:60,click:function(){var t=e.$$("oc-queues").add({});e.$$("oc-queues").select(t),$$("oc-queues").showCell(),$$("oc-queues").editCell(t,"phone",!0,!0),w()}},{},{}]}]}},{header:"Результаты",width:170,body:{id:"oc-results-tab",rows:[{view:"datatable",id:"oc-results",select:!0,tooltip:!0,resizeColumn:!0,scroll:!0,minHeight:200,columns:[{id:"phone",header:"Номер телефона",width:150,minWidth:50},{id:"name",header:"Имя контакта",fillspace:2,minWidth:90},{id:"description",header:"Примечание",fillspace:1,minWidth:90},{id:"state",header:"Состояние",fillspace:2,minWidth:90,template:function(e){var t="",o=parseInt(e.state)-1;return 6==e.state||3==e.state?t+=n[o].value+"(a)":t+=n[o].value,3!=e.state&&4!=e.state||(t+=" "+e.dial_result),t+=", звонков: "+e.tries+", последний: "+webix.Date.dateToStr("%d.%m в %H:%i")(e.last_call)}}],on:{onItemDblClick:function(){this.$scope.callsWindow.showWindow(this.getSelectedItem())}},scheme:{$init:function(e){parseInt(6==e.state||4==e.state)?e.$css="bad-row":e.$css="good-row"}}},{cols:[{view:"button",label:"Импорт из CSV...",width:150,disabled:!0},{},{view:"button",label:"Звонки контакту",width:150,click:function(){$$("oc-results").getSelectedItem()?this.$scope.callsWindow.showWindow($$("oc-results").getSelectedItem()):webix.alert({type:"error",text:"Выберите контакт для просмотра звонков"})}}]}]}},{header:"Журнал",width:120,body:{id:"oc-journal-tab",rows:[{view:"datatable",id:"oc-journal",minHeight:200,select:!0,tooltip:!0,resizeColumn:!0,scroll:!0,columns:[{id:"datatime",header:"Дата и время",width:150,minWidth:50},{id:"value",header:"Сообщение",fillspace:2,minWidth:90}],scheme:{$init:function(e){parseInt(6==e.state||4==e.state)?e.$css="bad-row":e.$css="good-row"}}},{cols:[{view:"button",label:"Импорт из CSV...",width:150,disabled:!0},{},{}]}]}}]}]},{margin:10,cols:[{view:"button",label:"Создать отчет",width:150,click:function(){switch($$("co-tabview").getValue()){case"oc-journal-tab":var e="oc-journal";break;case"oc-queues-tab":var e="oc-queues";break;case"oc-results-tab":var e="oc-results"}webix.csv.delimiter.cols=";",webix.toCSV($$(e),{filename:e})}},{view:"label",id:"phones-total-info",align:"right",label:"Контактов в списке: 0, Завершено: 0, Занят/не отвечает: 0, Ошибка дозвона: 0, В очереди: 1"}]},{margin:10,cols:[{view:"fieldset",label:"Действие при дозвоне",body:{rows:[{cols:[{view:"radio",value:0,name:r[0],id:r[0],options:[{id:1,value:"Соединение с менеджером"}],disabled:!0,on:{onChange:function(e,t){a(this.config.id)}}},{view:"radio",value:0,name:r[1],id:r[1],options:[{id:2,value:"Вызов номера или группы:"}],on:{onChange:function(e,t){e&&(a(this.config.id),$$(r[1]+"value").enable(),$$(r[2]+"value").disable())}}},{view:"text",name:r[1]+"value",id:r[1]+"value",disabled:!0,on:{onChange:function(e,t){""!=e&&$$(r[2]+"value").setValue("")}}},{view:"radio",value:0,name:r[2],id:r[2],options:[{id:3,value:"Вызов звонковой очереди"}],on:{onChange:function(e,t){e&&(a(this.config.id),$$(r[2]+"value").enable(),$$(r[1]+"value").disable())}}},{view:"text",name:r[2]+"value",id:r[2]+"value",disabled:!0,on:{onChange:function(e,t){""!=e&&$$(r[1]+"value").setValue("")}}}]},{cols:[{view:"radio",value:0,name:r[3],id:r[3],options:[{id:3,value:"Проигрывать записанный файл"}],disabled:!0,on:{onChange:function(e,t){a(this.config.id)}}},{view:"richselect",value:"Recorded file",options:["Recorded file"],disabled:!0},{view:"button",label:"Прослушать",disabled:!0},{view:"button",label:"Записать",disabled:!0}]}]}},{width:150,rows:[{view:"button",label:"Сохранить",click:function(){if(!$$("co-form").validate())return webix.message({type:"error",text:"Заполните обязательные параметры"}),!1;$$("oc-queues").editStop();var e=p();webix.ajax().post("outgoingcampaign/"+e.id+"/save",e).then(function(e){var t=e.json();t.result&&!t.errors.length?(t.message?webix.message({type:"success",text:t.message}):webix.message({type:"success",text:"Операция прошла успешно"}),c()):t.errors.length?(webix.message({type:"error",text:"При сохранении номеров произошла ошибка"}),t.errors.forEach(function(e){var t="";t=e.errorInfo[2]?e.errorInfo[2]:e.errorInfo?e.errorInfo.toString():e.toString(),webix.message({type:"error",text:t})})):webix.message({type:"error",text:"Произошла ошибка выполнения операции"})}).fail(function(e){webix.message({type:"error",text:"Произошла ошибка выполнения операции"})})}},{},{view:"button",label:"Отмена",click:function(){webix.confirm({text:"Не сохраненные изменения будут утеряны. Продолжить?",callback:function(e){if(e)return void c()}})}}]}]}]}],rules:{name:webix.rules.isNotEmpty},on:{onValues:function(){var e=$$("co-form").getValues();if(e[r[e.action-1]]==e.action)return!1;e[r[e.action-1]]=e.action,e[r[e.action-1]+"value"]=e.action_value,console.log(e),$$("co-form").setValues(e),$$("min_call_time")&&!$$("min_call_time").getValue()&&($$("min_call_time").setValue(e.min_call_time),$$("concurrent_calls_limit").setValue(e.concurrent_calls_limit))}}}]}},t.prototype.setFormValues=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(e),this.$$("co-form").setValues(e)},t.prototype.init=function(){this.callsWindow=this.ui(s)},t}(a.b);t.default=c},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if($$("outgoingcampaign-toolbar").hide(),$$("outgoingcampaigns").hide(),$$("outgoingcampaign-form").show(),e){if($$("co-form").setValues(e),!e.id)return;webix.ajax().get("outgoingcampaign/"+e.id+"/queues").then(function(e){var t=e.json();t.length&&$$("oc-queues").parse(t)}),webix.ajax().get("outgoingcampaign/"+e.id+"/results").then(function(e){var t=e.json();t.length&&$$("oc-results").parse(t)})}}return{view:"datatable",id:"outgoingcampaigns",select:!0,tooltip:!0,resizeColumn:!0,scroll:!0,columns:[{id:"tm_created",header:"Создан(а)",width:150,minWidth:50,template:function(e){var t="";switch(e.state){case"1":t+="<img src='./assets/imgs/oc-states/2.png'>";break;case"2":t+="<img src='./assets/imgs/oc-states/3.png'>";break;case"3":t+="<img src='./assets/imgs/oc-states/4.png'>";break;case"4":t+="<img src='./assets/imgs/oc-states/5.png'>";break;case"5":t+="<img src='./assets/imgs/oc-states/6.png'>";break;default:t+="<img src='./assets/imgs/oc-states/1.png'>"}return t+=webix.Date.dateToStr("%d.%m.%y в %H:%i")(e.tm_created)}},{id:"name",header:"Название",fillspace:2,minWidth:90},{id:"method",header:"Рассписание",fillspace:2,minWidth:90,template:function(e){var t=webix.Date.dateToStr("%d.%m")(e.date_start);return t+="-"+webix.Date.dateToStr("%d.%m")(e.date_finish),t+=" "+Object.values(e.days).join(","),t+=" c "+e.time_start,t+=" до "+e.time_finish}},{id:"state",header:"Статус",width:200,minWidth:90,sort:"text",template:function(e){if(!e)return"1";if(!e.state)return"2";switch(e.state){case"1":return"Создан(а)";case"2":return"Выполняется";case"3":return"Приостановлен(а)";case"4":return"Остановлен(а)";case"5":return"Завершен(а)";default:return""}}}],url:"/outgoingcampaign/list",ready:function(){},on:{onItemDblClick:function(t,o,i){var n=this.getSelectedItem();if(n.time_start){var r=n.time_start.split(":",2);2==r.length&&(n.minutes_start=r[1],n.hours_start=r[0]);var a=n.time_finish.split(":",2);2==a.length&&(n.minutes_finish=a[1],n.hours_finish=a[0])}var l={};for(var s in n.days)l[s]=1;$$("weekDays-form").setValues(l),n.settings.length?n.result=n.settings[0].result:n.result=0,console.log(n),e(n)}}}},t.prototype.init=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(46),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"phones",view:"datatable",resizeColumn:!0,resizeRow:!0,scrollY:!1,navigation:!0,select:!0,css:"my_style",columns:[{id:"id",header:[{text:"№"},{content:"serverFilter"}],width:50},{id:"phone",header:[{text:"Номер"},{content:"serverFilter"}],fillspace:1},{id:"model",header:[{text:"Модель"},{content:"serverFilter"}],fillspace:1,options:"./assets/options/models.json"},{id:"mac",header:[{text:"MAC-адрес "},{content:"serverFilter"}],fillspace:1},{id:"user_id",header:[{text:"Пользователь "},{content:"serverFilter"}],fillspace:1,options:"/groups/users/short"},{id:"login",header:[{text:"Логин"},{content:"serverFilter"}],fillspace:1},{id:"rules",header:[{text:"Правила набора номера "},{content:"serverFilter"}],fillspace:1,options:"./assets/options/rules.json"},{id:"default_phone",header:[{text:"Внешний номер по умолчанию"},{content:"serverFilter"}],fillspace:1}],url:"/phones/list",ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{id:"queues",view:"datatable",resizeColumn:!0,resizeRow:!0,scroll:!0,navigation:!0,select:!0,css:"my_style",columns:[{id:"id",header:[{text:"№"},{content:"serverFilter"}],width:50},{id:"name",header:[{text:"Код"},{content:"serverFilter"}],fillspace:1},{id:"fullname",header:[{text:"Название"},{content:"serverFilter"}],fillspace:1},{id:"url",header:[{text:"URI"},{content:"serverFilter"}],fillspace:1},{id:"close_on_hangup",header:[{text:"Закрытие страницы после обработки "},{content:"serverFilter"}],fillspace:1},{id:"sl",header:[{text:"SL"},{content:"serverFilter"}],fillspace:1},{id:"viq",header:[{text:"Приоритетная очередь"},{content:"serverRichSelectFilter"}],fillspace:1,options:[{id:"0",value:"Нет"},{id:"1",value:"Да"}]},{id:"service_id",header:[{text:"Сервис"},{content:"serverFilter"}],fillspace:1},{id:"pattern",header:[{text:"Шаблон"},{content:"serverFilter"}],fillspace:1,options:"./assets/options/pattern.json"},{id:"agents",header:["Операторы",""],fillspace:3,template:function(e){return e.agents&&e.agents.names?e.agents.names.join(","):""}},{id:"hidden",header:[{text:"Скрытая"},{content:"serverRichSelectFilter"}],fillspace:1,options:[{id:"0",value:"Нет"},{id:"1",value:"Да"}]}],url:"/queues/list",ready:function(){webix.extend(this,webix.ProgressBar)}}]}},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(47),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=o(51),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[l.default]}},t.prototype.urlChange=function(){},t}(a.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,o){$$("phone")&&($$("phone").setValue(e),$$("fio").setValue(t),$$("org").setValue(o),webix.ajax().get("bigam_getinfo.php",{cid:e},function(e,t){t=t.json(),$$("fio").setValue(t.fio),$$("org").setValue(t.org)}))}function l(e){for(e||(e=this),e.hide();e&&(!e.config.epbx_line||1!=e.config.epbx_line);)e=e.getParentView();var t=e.getParentView().getChildViews(),o=e.getParentView().index(e),i=e.getParentView().index(e)+1,n=t[o].getChildViews()[0],r=n.config;if(e.getChildViews()[1].hide(),"form"==r.type&&r.epbx_action&&"sendEmail"==r.epbx_action){if(!n.validate())return webix.message({type:"error",text:"Заполните обязательные поля."}),void e.getChildViews()[2].show();var a=n.getValues();a.epbx_rcpt=r.epbx_rcpt,a.epbx_subject=r.epbx_subject;var l=JSON.stringify(a);webix.message({type:"debug",text:"Отправляем письмо... Ожидайте."}),webix.ajax().post("/queues/send_mail.php",l,{error:function(t,o,i){e.getChildViews()[2].show()},success:function(o,n,r){0==n.json().result?t[i].show(!0,!0):(e.getChildViews()[2].show(),webix.message({type:"error",text:"Произошла ошибка при отправке письма."}))}})}else t[i].show(!0,!0)}function s(e){for(e||(e=this);e&&(!e.config.epbx_line||1!=e.config.epbx_line);)e=e.getParentView();var t=e.getParentView().getChildViews();e.hide();var o=e.getParentView().index(e)-1;0!=o&&t[o].getChildViews()[t[o].getChildViews().length-2].show(!0,!0),t[o].getChildViews()[t[o].getChildViews().length-1].show(!0,!0)}function c(e){var t=[],o=0;return e.forEach(function(i){o++,"object"!==(void 0===i?"undefined":h(i))&&(i={type:"template",css:"green-block",template:i,height:50}),t.push({epbx_line:1,hidden:1!=o,cols:[i,{view:"button",value:"Назад",hidden:1==o,click:function(){s(this)},width:100},{view:"button",value:"Дальше",hidden:o==e.length,click:function(){l(this)},width:100}]})}),t}function u(e,t){this&&this.data&&this.data.id&&0==e&&(e=this.data.id);var o=$$("mainView"),i="script_"+e;if($$(i))return $$(i).show({type:"flip",subtype:"horizontal"}),void o.showView(i);var n=$$("mainBody");n.disable(),webix.ajax().get("/legacy/scripts",{id:_,sid:e,nps_id:parseInt(g("nps"))||0},function(t,r,a){var l=r.json(),s=l.elements;window.actionsInfo=s,window.actionsId=e;var p;if(1==parseInt(l.autobuttons)){for(var f=[],h=0;h<l.substages.length;h++){var b={view:"button",label:l.substages[h].name,epbx_action:"next",epbx_action_block:l.substages[h].id,click:d,level:n.getChildViews().length,script_id:e};l.substages[h].used&&(p=b,u(b.epbx_action_block,b)),f.push(b)}s.push({cols:f})}else for(var g in s)s[g].used&&(p=s[g],u(s[g].epbx_action_block,s[g]));var _={animate:{type:"flip",subtype:"horizontal"},hidden:!0,rows:1==parseInt(l.show_prevnext)?c(s):s};_.id=i,n.addView(_,n.getChildViews().length-1),$$(i).show({type:"flip",subtype:"horizontal"}),o.showView(i),w=i,n.enable(),$$("$multiselect1")&&$$("$multiselect1").attachEvent("onChange",function(e,t){var o=$$("$multiselect1").getValue();-1!=o.indexOf(",Затрудняюсь ответить")&&(o=o.replace(",Затрудняюсь ответить",""),$$("$multiselect1").setValue(o)),-1!=o.indexOf("Затрудняюсь ответить,")&&(o=o.replace("Затрудняюсь ответить,",""),$$("$multiselect1").setValue(o))}),p&&p.id&&$$(p.id)&&webix.html.addCss($$(p.id).getNode().childNodes[0].childNodes[0],"toggleOn")})}function d(){for(var e=$$(this).config,t=$$(this).getParentView().getChildViews(),o=0;o<t.length;o++){var i=t[o].config.id;"button"==$$(i).config.view&&webix.html.removeCss($$(i).getNode().childNodes[0].childNodes[0],"toggleOn")}webix.html.addCss($$(e.id).getNode().childNodes[0].childNodes[0],"toggleOn");for(var n=$$(this).getParentView(),r=n.getParentView(),a=$$("mainBody"),l=0,o=0;o<a.getChildViews().length;o++)l&&$$(a.getChildViews()[o].config.id).hide({type:"flip",subtype:"horizontal"}),a.getChildViews()[o].config.id!=r.config.id&&a.getChildViews()[o].config.id!=n.config.id||(l=o);e.epbx_action_script;switch(e.epbx_action){case"next":if(94==e.epbx_action_block)window.close();else if(93==e.epbx_action_block)var s={nps_id:parseInt(g("nps")),answer:$$("$textarea1").getValue(),question_id:parseInt(e.script_id)||window.actionsId,answer_type:1};var c={nps_id:parseInt(g("nps")),answer:parseInt(e.epbx_action_block),question_id:parseInt(e.script_id)||window.actionsId,answer_type:2};if(window.actionsInfo&&!s)for(var d in window.actionsInfo)if(window.actionsInfo[d]&&("radio"==window.actionsInfo[d].view||"multiselect"==window.actionsInfo[d].view||"textarea"==window.actionsInfo[d].view)&&$$(window.actionsInfo[d].id)&&""!=$$(window.actionsInfo[d].id).getValue())var s={nps_id:parseInt(g("nps")),answer:$$(window.actionsInfo[d].id).getValue(),question_id:parseInt(window.actionsId),answer_type:1};s&&console.log("secondData",s),console.log("data",c),c?webix.ajax().post("/legacy/scripts/set_answer",{data:c},function(t){t=JSON.parse(t),t.result?(window.actionsInfo=[],s?webix.ajax().post("/legacy/scripts/set_answer",{data:s},function(t){t=JSON.parse(t),t.result?(91==s.question_id&&window.close(),u(e.epbx_action_block,e)):(webix.message({type:"error",text:t.msg}),console.log("err",t.data))}):u(e.epbx_action_block,e)):(webix.message({type:"error",text:t.msg}),console.log("err",t.data))}):u(e.epbx_action_block,e);break;case"jump":document.location.href="/#!/main/script?id="+e.epbx_action_script;break;default:alert("Unknow action: "+e.epbx_action)}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;10!=parseInt(g("id"))?webix.ui({view:"scrollview",scroll:"y",id:"mainView",body:{id:"mainBody",rows:[{cols:[{rows:[{type:"header",template:"Сценарий разговора"},{rows:c(["«Должность» «Имя оператора» <strong>Здравствуйте! Чем могу помочь?</strong>","<strong>Скажите пожалуйста, как я могу к Вам обращаться?</strong>","«Имя клиента»<strong>, очень приятно!  Из какого города Вы звоните?</strong>"])}]},{rows:[{type:"header",template:"Информация о клиенте"},{view:"form",id:"info_form",elements:[{cols:[{view:"text",label:"Телефон:",name:"phone",id:"phone",labelWidth:110,readonly:!0,labelAlign:"right"},{view:"text",label:"Организация",name:"org",id:"org",labelWidth:110,labelAlign:"right"}]},{view:"text",label:"ФИО клиента",name:"fio",id:"fio",labelWidth:110,labelAlign:"right"},{view:"text",label:"Город",name:"city",labelWidth:110,labelAlign:"right"}]}]}]},{}]},ready:function(){}}).show():webix.ui({view:"scrollview",scroll:"y",id:"mainView",body:{id:"mainBody",rows:[{}]},ready:function(){}}).show(),u(e)}Object.defineProperty(t,"__esModule",{value:!0});var f=o(0),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{rows:[{view:"form",id:"qwer",elements:[]}]}},t}(f.b);t.default=b;var w=0;window.epbxAction=d;var g=function(e){var t,o,i=decodeURIComponent(window.location.hash.substring(15)),n=i.split("&");for(o=0;o<n.length;o++)if(t=n[o].split("="),t[0]===e)return void 0===t[1]||t[1]},_=parseInt(g("id"));console.log(parseInt(g("id"))),$$("menuBar").hide(),webix.ajax().get("/legacy/scripts/getstageid",{id:_},function(e,t){t=t.json(),webix.ready(function(){p(parseInt(parseInt(t.result))),a()})})},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t,o=$$("scripts_lst").getValue();if(!o)return void webix.message({type:"error",text:"Выберите скрипт"});var i=$$("script_stages").getSelectedId(!1),n=e.id?e.id:0;if(!i)return void webix.message({type:"error",text:"Выберите этап скрипта перед добавление элементов этапа скрипта."});webix.ui((t={id:"add_script_element_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('add_script_element_win').close();"}},t.head={view:"toolbar",margin:-4,cols:[{view:"label",label:n?"Изменение элемента этапа скрипта":"Добавление элемент этапа скрипта"},{view:"icon",icon:"times-circle",click:"$$('add_script_element_win').close();"}]},t.resize=!0,t.width=700,t.height=500,t.center=!0,t.position="center",t.modal=!0,t.move=!0,t.body={view:"form",id:"stage_elements_form",elements:[{view:"richselect",name:"type",label:"Тип",options:[{id:"button",value:"Кнопка"},{id:"text",value:"Текст"},{id:"webpage",value:"Веб-страница"},{id:"form",value:"Форма"},{id:"transfer",value:"Выбор сотрудника для переадресации"},{id:"sms",value:"Отправить SMS клиенту"},{id:"email",value:"Отправить Email клиенту"}],on:{onChange:function(e){switch($$("label").hide(),$$("action").hide(),$$("text").hide(),$$("url").hide(),$$("form_elements").hide(),$$("form_to").hide(),e){case"button":$$("label").show(),$$("action").show();break;case"text":$$("text").show();break;case"webpage":$$("url").show();break;case"form":$$("form_elements").show(),$$("form_to").show();break;case"sms":case"email":$$("text").show()}}}},{view:"text",name:"label",label:"Лейбл",id:"label",hidden:!0},{view:"nic-editor",config:{},label:"Текст",name:"text",id:"text",hidden:!0},{view:"text",name:"url",label:"URL",id:"url",hidden:!0},{view:"datatable",id:"form_elements",autowidth:!0,editable:!0,hidden:!0,height:200,columns:[{id:"name",header:"Название",width:250,editor:"text"},{id:"type",header:"Тип",width:80,editor:"select",options:[{id:"text",value:"Текст"}]},{id:"placeholder",header:"Подсказка",width:250,editor:"text"}],data:[{}],on:{onItemClick:function(e){this.editColumn(e),this.focusEditor(e)},onBeforeContextMenu:function(e){webix.delay(function(){this.select(e)})}},ready:function(){webix.ui({id:"form_ctx",view:"contextmenu",width:300,data:[{id:"add",value:"Добавить"},{id:"remove",value:"Удалить"}],click:function(e,t){var o=this.getContext().id.row;"add"==e?$$("form_elements").add({},o):"remove"==e&&$$("form_elements").remove(o)}}).attachTo(this)}},{view:"text",id:"form_to",name:"form_to",label:"Email",hidden:!0},{hidden:!0,view:"richselect",name:"action",label:"Действие",id:"action",options:[{id:"jump",value:"Переход к другому скрипту"},{id:"next",value:"Переход к другому блоку"},{id:"transfer",value:"Переадресация вызова"},{id:"email",value:"Отправка Email"},{id:"sms",value:"Отправка SMS"}],on:{onChange:function(e){switch($$("action_script").hide(),$$("action_block").hide(),$$("action_text").hide(),$$("action_transfer").hide(),e){case"jump":$$("action_script").show();break;case"next":$$("action_block").show();break;case"transfer":$$("action_transfer").show();break;case"email":case"sms":$$("action_text").show()}}}},{view:"combo",label:"Скрипт",name:"action_script",id:"action_script",hidden:!0,options:"/legacy/ext/scripts/list"},{view:"combo",label:"Блок",name:"action_block",id:"action_block",hidden:!0,suggest:{body:{view:"tree",url:"/legacy/ext/scripts/liststages/"+o}}},{view:"textarea",label:"Текст",name:"action_text",id:"action_text",height:"400",hidden:!0},{view:"text",label:"Номер",name:"action_transfer",id:"action_transfer",hidden:!0},{cols:[{view:"button",label:"Сохранить",click:function(){var e=$$("stage_elements_form");if(e.validate()){e.disable();var t=e.getValues();t.stage_id=i,n&&(t.id=n),"form"==t.type&&(t.form=JSON.stringify($$("form_elements").serialize())),webix.ajax().post("/legacy/ext/scripts/save/stageelements",t,function(t,o,n){e.enable();var o=o.json();1==o.result?($$("add_script_element_win").close(),$$("script_elements").clearAll(),$$("script_elements").load("/legacy/ext/scripts/list/stageelements/"+i)):webix.message({type:"error",text:o.message})})}else webix.message({type:"error",text:"Заполните обязательные поля"})}},{view:"button",label:"Удалить",hidden:!n,click:function(){webix.confirm({title:"Подтверждение удаления",ok:"Удалить",cancel:"Отмена",text:'Вы действительно хотите удалить элемент этапа "'+e.label+'"?',type:"confirm-error",callback:function(e){if(e){var t={id:n,delete:1};webix.ajax().post("/legacy/ext/scripts/save/stageelements",t,function(e,t,o){var t=t.json();1==t.result?($$("add_script_element_win").close(),$$("script_elements").clearAll(),$$("script_elements").load("/legacy/ext/scripts/list/stageelements/"+i)):webix.message({type:"error",text:t.message})})}}})}}]}],rules:{type:webix.rules.isNotEmpty,label:webix.rules.isNotEmpty,action:webix.rules.isNotEmpty,url:webix.rules.isNotEmpty,action_script:webix.rules.isNotEmpty,action_block:webix.rules.isNotEmpty,action_text:webix.rules.isNotEmpty,action_transfer:webix.rules.isNotEmpty}},t.on={onShow:function(){$$("stage_elements_form").setValues(e),e.type&&"form"==e.type&&($$("form_elements").clearAll(),$$("form_elements").parse(e.form),0==$$("form_elements").count()&&$$("form_elements").add({}))}},t)).show()}Object.defineProperty(t,"__esModule",{value:!0});var l=o(0),s=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){return{type:"clean",rows:[{rows:[{cols:[{view:"organogram",id:"script_stages",borderless:!0,select:!0,scroll:"xy",data:[],on:{onSelectChange:function(){$$("script_elements").clearAll();var e=$$("script_stages").getSelectedId(!1);e&&$$("script_elements").load("/legacy/ext/scripts/list/stageelements/"+e)},onItemDblClick:function(e){$$("script_stages").getItem(e)}}},{view:"resizer"},{rows:[{type:"space",responsive:"e1",margin:0,padding:0,cols:[{view:"label",label:"<strong>Элементы этапа скрипта</strong>"},{view:"button",label:"Добавить",click:function(){a([])}},{view:"button",label:"Изменить",click:function(){var e=$$("script_elements").getSelectedId();if(e){var t=$$("script_elements").getItem(e);t&&a(t)}else webix.message({type:"error",text:"Выберите элемент этапа скрипта для редактирования."})}}]},{id:"script_elements",view:"treetable",resizeColumn:!0,resizeRow:!0,select:!0,columns:[{id:"id",header:[{text:""}],template:"{common.treetable()} #value#",width:50},{id:"type",header:[{text:"Тип"}],width:150},{id:"label",header:[{text:"Содержимое"}],width:200}],on:{onItemDblClick:function(e,t,o){}}}]}]}]}]}},t.prototype.urlChange=function(){},t}(l.b);t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.config=function(){var e=[{id:"1",value:"Активный"},{id:"2",value:"Заблокирован"},{id:"3",value:"Удален"},{id:"4",value:"Скрытый"}];return{type:"clean",rows:[{id:"users",view:"datatable",resizeColumn:!0,resizeRow:!0,scrollY:!0,scrollX:!0,navigation:!0,select:!0,tooltip:!0,fixedRowHeight:!1,css:"my_style",columns:[{id:"id",header:[{text:"#"},{}],width:50,template:function(e){return e.id}},{id:"name",header:[{text:"Логин"},{content:"serverFilter"}],fillspace:1},{id:"fullname",header:[{text:"Ф.И.О."},{content:"serverFilter"}],fillspace:1},{id:"phone",header:[{text:"Номер"},{content:"serverFilter"}],fillspace:1},{id:"user_groups",header:["Группы",""],fillspace:1},{id:"description",header:[{text:"Описание"},{content:"serverFilter"}],fillspace:1},{id:"state",header:[{text:"Статус"},{content:"serverSelectFilter",options:e}],fillspace:1,options:e}],url:"/users/list",on:{onAfterLoad:function(){this.adjustRowHeight("user_groups")}},ready:function(){webix.extend(this,webix.ProgressBar),this.adjustRowHeight("user_groups")}}]}},t.prototype.init=function(){this.win2=this.ui(WindowsView)},t.prototype.urlChange=function(){},t}(a.b);t.default=l},function(e,t){webix.protoUI({name:"ckeditor",$init:function(){this.$view.className+=" webix_selectable"},defaults:{borderless:!0,toolbar:[["Bold","Italic","-","NumberedList","BulletedList","-","Link","Unlink"],["FontSize","TextColor","BGColor"]]},_init_ckeditor_once:function(){var e=this.config.textAreaID="t"+webix.uid();this.$view.innerHTML="<textarea id='"+e+"'>"+this.config.value+"</textarea>",window.CKEDITOR_BASEPATH=webix.codebase+"ckeditor/";var t={toolbar:this.config.toolbar,width:this.$width-2,height:this.$height-44};webix.extend(t,this.config.editor||{}),webix.require("ckeditor/ckeditor.js",function(){this._3rd_editor=window.CKEDITOR.replace(this.config.textAreaID,t)},this)},_set_inner_size:function(e,t){this._3rd_editor&&this._3rd_editor.container&&this.$width&&this._3rd_editor.resize(e,t)},$setSize:function(e,t){webix.ui.view.prototype.$setSize.call(this,e,t)&&(this._init_ckeditor_once(),this._set_inner_size(e,t))},setValue:function(e){this.config.value=e,this._3rd_editor?this._3rd_editor.setData(e):webix.delay(function(){this.setValue(e)},this,[],100)},getValue:function(){return this._3rd_editor?this._3rd_editor.getData():this.config.value},focus:function(){this._focus_await=!0,this._3rd_editor&&this._3rd_editor.focus()},getEditor:function(){return this._3rd_editor.getData()}},webix.ui.view)},function(e,t){webix.protoUI({name:"dhx-scheduler",defaults:{tabs:["day","week","month"]},getScheduler:function(){return this._scheduler},$init:function(){this.$ready.push(function(){var e=this.config.tabs,t=["<div class='dhx_cal_container' style='width:100%; height:100%;'><div class='dhx_cal_navline'><div class='dhx_cal_prev_button'>&nbsp;</div><div class='dhx_cal_next_button'>&nbsp;</div><div class='dhx_cal_today_button'></div><div class='dhx_cal_date'></div>"];if(e)for(var o=0;o<e.length;o++)t.push("<div class='dhx_cal_tab"+(0===o?" dhx_cal_tab_first":"")+(o==e.length-1?" dhx_cal_tab_last":"")+"' name='"+e[o]+"_tab' ></div>");t.push("</div><div class='dhx_cal_header'></div><div class='dhx_cal_data'></div></div>"),this.$view.innerHTML=t.join(""),webix.delay(webix.bind(this._render_once,this))})},_render_once:function(){var e=this._scheduler=window.Scheduler?window.Scheduler.getSchedulerInstance():window.scheduler;this.config.init&&this.config.init.call(this),e.init(this.$view.firstChild,this.config.date||new Date,this.config.mode||"week"),this.config.ready&&this.config.ready.call(this)}},webix.ui.view)},function(e,t){webix.i18n.locales["en-US"]={groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2,dateFormat:"%m/%d/%Y",timeFormat:"%h:%i %A",longDateFormat:"%d %F %Y",fullDateFormat:"%m/%d/%Y %h:%i %A",am:["am","AM"],pm:["pm","PM"],price:"${obj}",priceSettings:{groupDelimiter:",",groupSize:3,decimalDelimiter:".",decimalSize:2},fileSize:["b","Kb","Mb","Gb","Tb","Pb","Eb"],calendar:{monthFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],hours:"Hours",minutes:"Minutes",done:"Done",clear:"Clear",today:"Today"},dataExport:{page:"Page",of:"of"},PDFviewer:{of:"of",automaticZoom:"Automatic Zoom",actualSize:"Actual Size",pageFit:"Page Fit",pageWidth:"Page Width",pageHeight:"Page Height"},aria:{calendar:"Calendar",increaseValue:"Increase value",decreaseValue:"Decrease value",navMonth:["Previous month","Next month"],navYear:["Previous year","Next year"],navDecade:["Previous decade","Next decade"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Hours: %h %A",minuteFormat:"Minutes: %i",removeItem:"Remove item",pages:["First page","Previous page","Next page","Last page"],page:"Page",headermenu:"Header menu",openGroup:"Open column group",closeGroup:"Close column group",closeTab:"Close tab",showTabs:"Show more tabs",resetTreeMap:"Reset tree map",navTreeMap:"Level up",nextTab:"Next tab",prevTab:"Previous tab",multitextSection:"Add section",multitextextraSection:"Remove section",showChart:"Show chart",hideChart:"Hide chart",resizeChart:"Resize chart"},richtext:{underline:"Underline",bold:"Bold",italic:"Italic"},combo:{select:"Select",selectAll:"Select all",unselectAll:"Unselect all"},message:{ok:"OK",cancel:"Cancel"}}},function(e,t){webix.i18n.locales["ru-RU"]={groupDelimiter:" ",groupSize:3,decimalDelimiter:",",decimalSize:2,dateFormat:"%d.%m.%Y",timeFormat:"%H:%i",longDateFormat:"%d %F %Y",fullDateFormat:"%d.%m.%Y %H:%i",price:"{obj} руб.",priceSettings:null,calendar:{monthFull:["Январь","Февраль","Март","Апрель","Maй","Июнь","Июль","Август","Сентябрь","Oктябрь","Ноябрь","Декабрь"],monthShort:["Янв","Фев","Maр","Aпр","Maй","Июн","Июл","Aвг","Сен","Окт","Ноя","Дек"],dayFull:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],hours:"Часы",minutes:"Минуты",done:"Гoтовo",clear:"Очистить",today:"Сегодня"},dataExport:{page:"Страница",of:"из"},PDFviewer:{of:"из",automaticZoom:"Автоматический зум",actualSize:"Настоящий размер",pageFit:"Размер страницы",pageWidth:"Ширина страницы",pageHeight:"Высота страницы"},aria:{calendar:"Календарь",increaseValue:"Увеличить значение",decreaseValue:"Уменьшить значение",navMonth:["Предыдущий месяц","Следующий месяц"],navYear:["Предыдущий год","Следующий год"],navDecade:["Предыдущие десять лет","Следующие десять лет"],dateFormat:"%d %F %Y",monthFormat:"%F %Y",yearFormat:"%Y",hourFormat:"Часы: %H",minuteFormat:"Минуты: %i",removeItem:"Удалить элемент",pages:["Первая страница","Предыдущая страница","Следующая страница","Последняя страница"],page:"Страница",headermenu:"Меню шапки таблицы",openGroup:"Развернуть группу столбцов",closeGroup:"Свернуть группу столбцов",closeTab:"Закрыть вкладку",showTabs:"Показать больше вкладок",resetTreeMap:"Вернуться к первоначальному представлению",navTreeMap:"Перейти на уровень выше",nextTab:"Следующая вкладка",prevTab:"Предыдущая вкладка",multitextSection:"Добавить элемент",multitextextraSection:"Удалить элемент",showChart:"Показать чарт",hideChart:"Спрятать чарт",resizeChart:"Изменить размер чарта"},richtext:{underline:"Подчеркивание",bold:"Жирный",italic:"Курсив"},combo:{select:"Выбрать",selectAll:"Выбрать все",unselectAll:"Сброс выбора"},message:{ok:"OK",cancel:"Отмена"}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(104),n=(o.n(i),o(105)),r=(o.n(n),o(106)),a=(o.n(r),o(0)),l=o(57),s=o(125);webix.codebase="/webix",webix.ready(function(){!webix.env.touch&&webix.ui.scrollSize&&webix.CustomScroll&&webix.CustomScroll.init();var e=new a.a({id:"erpicopbx",name:"ErpicoPBX",version:"3.0",start:"/main/cti"}),t=new s.a;webix.guiutils=t;var o=new l.a;webix.auth=o,webix.i18n.setLocale("ru-RU"),webix.Date.startOnMonday=!0,e.attachEvent("app:error:resolve",function(e,t){var o=this;window.console.error(t),webix.delay(function(){return o.show("/main/cti")})}),o.check(function(){e.render(),$$("person_template")&&$$("person_template").refresh()})})},function(e,t){},function(e,t){var o;webix.ui.datafilter.avgColumn=webix.extend({refresh:function(e,t,i){o=0,e.mapCells(null,i.columnId,null,1,function(e){return o++,e}),t.firstChild.innerHTML=o}},webix.ui.datafilter.summColumn),webix.ui.datafilter.minColumn=webix.extend({refresh:function(e,t,o){var i=0;e.mapCells(null,o.columnId,null,1,function(e){return e*=1,isNaN(e)||(i+=e),e}),t.firstChild.innerHTML=i.toFixed(2)}},webix.ui.datafilter.summColumn),webix.ui.datafilter.avaregeColumn=webix.extend({refresh:function(e,t,o){var i=0,n=0;e.mapCells(null,o.columnId,null,1,function(e){return e*=1,isNaN(e)||(i+=e,n++),e}),t.firstChild.innerHTML=(i/n).toFixed(2)}},webix.ui.datafilter.summColumn),webix.ui.datafilter.summTimeColumn=webix.extend({refresh:function(e,t,o){var i=0,n=0,r=0,a=0,l=0,s=0,c=0,u=new Array,d=new Array,p=new Array;for(e.mapCells(null,o.columnId,null,1,function(e){return e&&(u=e.split(" "),2==u.length?(d=u[0].split(translate("d")),i+=parseInt(d[0],10),p=u[1].split(":"),n+=parseInt(p[0],10),a+=parseInt(p[1],10),s+=parseInt(p[2],10)):(p=u[0].split(":"),3==p.length?(n+=parseInt(p[0],10),a+=parseInt(p[1],10),s+=parseInt(p[2],10)):(a+=parseInt(p[0],10),s+=parseInt(p[1],10)))),e});s>=60;)s-=60,c++;for(a+=c;a>=60;)a-=60,l++;for(n+=l;n>=24;)n-=24,r++;i+=r,s<10&&(s="0"+s),a<10&&(a="0"+a);var f="";i>0&&(f=f+i+translate("d")+" "),n>0?f=f+n+":":i>0&&(f+="0:"),a>0?f=f+a+":":f+="00:",f+=s>0?s:"00",t.firstChild.innerHTML=f}},webix.ui.datafilter.summColumn),webix.ui.datafilter.avaregeTimeColumn=webix.extend({refresh:function(e,t,o){var i=0,n=0,r=0,a=0,l=0,s=0,c=new Array;e.mapCells(null,o.columnId,null,1,function(e){return e&&(c=e.split(":"),n+=parseInt(c[0],10),a+=parseInt(c[1],10),s++),e});var u=60*n+a;for(a=u/s,a=Math.round(a);a>=60;)a-=60,l++;for(n=l;n>=60;)n-=60,r++;i+=r,a<10&&(a="0"+a),n<10&&(n="0"+n);var d=i+":";n>0?d=d+n+":":d+="00:",d+=a>0?a:"00",t.firstChild.innerHTML=d}},webix.ui.datafilter.summColumn)},function(e,t){webix.protoUI({name:"nic-editor",defaults:{config:{buttonList:["fontSize","bold","italic","underline","strikeThrough","subscript","superscript"]},value:""},$init:function(e){this.$view.innerHTML="<div style='padding:10px'>Loading...</div>",this.$view.className+=" webix_selectable",this._waitEditor=webix.promise.defer(),this.$ready.push(this._init_nic_editor)},_init_nic_editor:function(){if(!1===this.config.cdn)return void this._render_nic_editor();var e=[],t=this.config.cdn?this.config.cdn:"https://cdnjs.cloudflare.com/ajax/libs/NicEdit/0.93";e.push(t+"/nicEdit.js"),webix.require(e).then(webix.bind(this._render_nic_editor,this)).catch(function(e){console.log(e)})},_render_nic_editor:function(){if(!this._editorCss){var e=".nicEdit-panel{height:auto}\n";e+=".nicEdit-panelContain{border-top-width:0px !important;}\n",e+=".webix_selectable>div:nth-child(2){overflow-y:auto;}",webix.html.addStyle(e),this._editorCss=!0}this.config.cdn&&!this.config.config.iconsPath&&(this.config.config.iconsPath=cdn+"/nicEditorIcons.gif");var t=new nicEditor(this.config.config).panelInstance(this.$view.firstChild);this._3rd_editor=t.nicInstances[t.nicInstances.length-1],this._set_inner_size(),this._waitEditor.resolve(this._3rd_editor),this.setValue(this.config.value),this._focus_await&&this.focus()},_set_inner_size:function(){if(this._3rd_editor&&this.$width){var e=this.$view.firstChild;e.style.width=this.$width+"px",e=e.nextSibling,e.style.width=this.$width-20+"px",e.style.height=this.$height-46+"px"}},$setSize:function(e,t){webix.ui.view.prototype.$setSize.call(this,e,t)&&this._set_inner_size()},setValue:function(e){this.config.value=e,this._3rd_editor&&this._3rd_editor.setContent(e)},getValue:function(){return this._3rd_editor?this._3rd_editor.getContent():this.config.value},focus:function(){this._focus_await=!0,this._3rd_editor&&this._3rd_editor.elm.focus()},getEditor:function(e){return e?this._waitEditor:this._3rd_editor}},webix.ui.view)},function(e,t,o){"use strict";o.d(t,"a",function(){return d});var i=o(52),n=o(108),r=o(109),a=o(54),l=o(53),s=o(111),c=(o.n(s),"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),u=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),d=function(e){function t(t){var o=e.call(this)||this;return o.webix=t.webix||webix,o.config=o.webix.extend({name:"App",version:"1.0",start:"/home"},t,!0),o._name=o.config.name,o._services={},webix.extend(o,webix.EventSystem),o}return u(t,e),t.prototype.getService=function(e){var t=this._services[e];return"function"==typeof t&&(t=this._services[e]=t(this)),t},t.prototype.setService=function(e,t){this._services[e]=t},t.prototype.copyConfig=function(e,t,o){if(e.$ui?e={$subview:new n.a(this,"",e)}:(e instanceof i.a||"function"==typeof e&&e.prototype instanceof i.a)&&(e={$subview:e}),e.$subview)return this.addSubView(e,t,o);t=t||(e instanceof Array?[]:{});for(var r in e){var a=e[r];"function"==typeof a&&a.prototype instanceof i.a&&(a={$subview:a}),!a||"object"!==(void 0===a?"undefined":c(a))||a instanceof webix.DataCollection||a instanceof RegExp?t[r]=a:a instanceof Date?t[r]=new Date(a):t[r]=this.copyConfig(a,a instanceof Array?[]:{},o)}return t},t.prototype.getRouter=function(){return this.$router},t.prototype.clickHandler=function(e){if(e){var t=e.target||e.srcElement;if(t&&t.getAttribute){var o=t.getAttribute("trigger");o&&this.trigger(o);var i=t.getAttribute("route");i&&this.show(i)}}},t.prototype.refresh=function(){var e=this._container;this._view._name=webix.uid()+"",this._container=null,e.tagName&&this._view&&(this._view.destructor(),this._view=null),this.render(e,Object(l.a)(this.getRouter().get()),this._parent)},t.prototype.loadView=function(e){var t=this,i=this.config.views,n=null;if(""===e)return Promise.resolve(this._loadError("",new Error("Webix Jet: Empty url segment")));try{i&&"string"==typeof(n="function"==typeof i?i(e):i[e])&&(e=n,n=null),n||(e=e.replace(/\./g,"/"),n=o(112)("./"+e))}catch(t){n=this._loadError(e,t)}return n.then||(n=Promise.resolve(n)),n=n.then(function(e){return e.__esModule?e.default:e}).catch(function(o){return t._loadError(e,o)})},t.prototype.createFromURL=function(e,t){var o=this,i=e[0],n=i.page;return t&&t.getName()===n?Promise.resolve(t):this.loadView(i.page).then(function(e){return o.createView(e,n)})},t.prototype.createView=function(e,t){if("function"==typeof e){if(e.prototype instanceof i.a)return new e(this,t);e=e()}return e instanceof i.a?e:e.$ui?new n.a(this,t,e):new r.a(this,t,e)},t.prototype.show=function(e){return this.$router.get()!==e?this._render(e):Promise.resolve(!0)},t.prototype.canNavigate=function(e,t){var o={url:Object(l.a)(e),redirect:e,confirm:Promise.resolve(!0)};return this.callEvent("app:guard",[e,t||this._view,o])?o.confirm.catch(function(){return o.redirect=null}).then(function(){return o.redirect}):Promise.reject("")},t.prototype.destructor=function(){this._view.destructor()},t.prototype.trigger=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.apply(e,t)},t.prototype.apply=function(e,t){this.callEvent(e,t)},t.prototype.action=function(e){return this.webix.bind(function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this.apply(e,t)},this)},t.prototype.on=function(e,t){this.attachEvent(e,t)},t.prototype.use=function(e,t){e(this,null,t)},t.prototype.error=function(e,t){if(this.callEvent(e,t),this.callEvent("app:error",t),this.config.debug)for(var o=0;o<t.length;o++)if(console.error(t[o]),t[o]instanceof Error){var i=t[o].message;0===i.indexOf("Module build failed")?(i=i.replace(/\x1b\[[0-9;]*m/g,""),document.body.innerHTML="<pre style='font-size:16px; background-color: #ec6873; color: #000; padding:10px;'>"+i+"</pre>"):(i+="<br><br>Check console for more details",webix.message({type:"error",text:i,expire:-1}))}},t.prototype._render=function(e){var t=this;!this.$router&&(webix.attachEvent("onClick",function(e){return t.clickHandler(e)}),e=this._first_start(e));var o="string"==typeof e?e:Object(l.b)(e);return this.canNavigate(o).then(function(e){return null!==e?(t.$router.set(e,{silent:!0}),t._render_stage(e)):null})},t.prototype._render_stage=function(e){var t=this,o="string"==typeof e?Object(l.a)(e):e;return webix.ui.freeze(function(){return t.createFromURL(o,t._view).then(function(e){var i=t._view;return t._view=e,e.render(t._container,o,t._parent).then(function(n){return i&&i!==t._view&&i.destructor(),t._view.getRoot().getParentView()&&(t._container=n),t._root=n,t.callEvent("app:route",[o]),e})}).catch(function(e){t.error("app:error:render",[e])})})},t.prototype._urlChange=function(e){return alert("Not implemented"),Promise.resolve(!0)},t.prototype._first_start=function(e){var t=this,o=function(e){return setTimeout(function(){t._render(e)},1)};if(this.$router=new(this.config.router||a.a)(o,this.config),this._container===document.body&&!1!==this.config.animation){var i=this._container;webix.html.addCss(i,"webixappstart"),setTimeout(function(){webix.html.removeCss(i,"webixappstart"),webix.html.addCss(i,"webixapp")},10)}return e&&1!==e.length||(e=this.$router.get()||this.config.start,this.$router.set(e,{silent:!0})),e},t.prototype._loadError=function(e,t){return this.error("app:error:resolve",[t,e]),{template:" "}},t.prototype.addSubView=function(e,t,o){var n=!0!==e.$subview?e.$subview:null,r=e.name||(n?this.webix.uid():"default");t.id=e.id||"s"+this.webix.uid();var a=o[r]={id:t.id,url:n};return a.url instanceof i.a&&(a.view=a.url),t},t}(i.a)},function(e,t,o){"use strict";o.d(t,"a",function(){return r});var i=o(4),n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),r=function(e){function t(t,o,i){var n=e.call(this,t,o)||this;return n._ui=i,n._windows=[],n}return n(t,e),t.prototype.getRoot=function(){if(this.app.config.jet1xMode){var e=this.getParentView();if(e)return e.getRoot()}return this._root},t.prototype.config=function(){return this._ui.$ui||this._ui},t.prototype.destructor=function(){var t=this._ui.$ondestroy;t&&t();for(var o=0,i=this._windows;o<i.length;o++){i[o].destructor()}e.prototype.destructor.call(this)},t.prototype.show=function(t,o){if(0===t.indexOf("/")||0===t.indexOf("./"))return e.prototype.show.call(this,t,o);e.prototype.show.call(this,"../"+t,o)},t.prototype.init=function(){this.app.config.legacyEarlyInit&&this._realInitHandler()},t.prototype.ready=function(){this.app.config.legacyEarlyInit||this._realInitHandler()},t.prototype._realInitHandler=function(){var e=this._ui.$oninit;if(e){var o=this.getRoot();e(o,o.$scope)}var i=this._ui.$onevent;if(i)for(var n in i)this.on(this.app,n,i[n]);var r=this._ui.$windows;if(r)for(var a=0,l=r;a<l.length;a++){var s=l[a];if(s.$ui){var c=new t(this.app,this.getName(),s);c.render(document.body),this._windows.push(c)}else this.ui(s)}},t.prototype._urlChange=function(t){var o=this;return e.prototype._urlChange.call(this,t).then(function(){var e=o._ui.$onurlchange;if(e){var i=o.getRoot();e(t[0].params,t.slice(1),i.$scope)}})},t}(i.a)},function(e,t,o){"use strict";o.d(t,"a",function(){return r});var i=o(4),n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),r=function(e){function t(t,o,i){var n=e.call(this,t,o)||this;return n._ui=i,n}return n(t,e),t.prototype.config=function(){return this._ui},t}(i.a)},function(e,t,o){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t){var o,n=[],r={},a=e.routie,l=function(e,t){this.name=t,this.path=e,this.keys=[],this.fns=[],this.params={},this.regex=s(this.path,this.keys,!1,!1)};l.prototype.addHandler=function(e){this.fns.push(e)},l.prototype.removeHandler=function(e){for(var t=0,o=this.fns.length;t<o;t++){if(e==this.fns[t])return void this.fns.splice(t,1)}},l.prototype.run=function(e){for(var t=0,o=this.fns.length;t<o;t++)if(!1===this.fns[t].apply(this,e))return!1;return!0},l.prototype.match=function(e,t){var o=this.regex.exec(e);if(!o)return!1;for(var i=1,n=o.length;i<n;++i){var r=this.keys[i-1],a="string"==typeof o[i]?decodeURIComponent(o[i]):o[i];r&&(this.params[r.name]=a),t.push(a)}return!0},l.prototype.toURL=function(e){var t=this.path;for(var o in e)t=t.replace("/:"+o,"/"+e[o]);if(t=t.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=t.indexOf(":"))throw new Error("missing parameters for url: "+t);return t};var s=function(e,t,o,i){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,o,i,n,r,a){return t.push({name:n,optional:!!a}),o=o||"",(a?"":o)+"(?:"+(a?o:"")+(i||"")+(r||i&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",o?"":"i"))},c=function(e,t){var o=e.split(" "),i=2==o.length?o[0]:null;e=2==o.length?o[1]:o[0],r[e]||(r[e]=new l(e,i),n.push(r[e])),r[e].addHandler(t)},u=function e(t,o){if("function"==typeof o)c(t,o),e.reload();else if("object"==(void 0===t?"undefined":i(t))){for(var n in t)c(n,t[n]);e.reload()}else void 0===o&&e.navigate(t)};u.lookup=function(e,t){for(var o=0,i=n.length;o<i;o++){var r=n[o];if(r.name==e)return r.toURL(t)}},u.remove=function(e,t){var o=r[e];o&&o.removeHandler(t)},u.removeAll=function(){r={},n=[],o=""},u.navigate=function(e,t){t=t||{};var o=t.silent||!1;o&&b(),setTimeout(function(){window.location.hash=e,o&&setTimeout(function(){h()},1)},1)},u.noConflict=function(){return e.routie=a,u};var d=function(){return window.location.hash.substring(1)},p=function(e,t){var o=[];return t.match(e,o)?!1!==t.run(o)?1:0:-1},f=u.reload=function(){for(var e=d(),t=0,i=n.length;t<i;t++){var r=n[t],a=p(e,r);if(1===a){o=e;break}if(0===a){u.navigate(o,{silent:!0});break}}},h=function(){e.addEventListener?e.addEventListener("hashchange",f,!1):e.attachEvent("onhashchange",f)},b=function(){e.removeEventListener?e.removeEventListener("hashchange",f):e.detachEvent("onhashchange",f)};if(h(),o=d(),t)return u;e.routie=u};e.exports=n(window,!0),e.exports.default=e.exports},function(e,t){var o=webix,i=webix.version.split(".");10*i[0]+1*i[1]<53&&(o.ui.freeze=function(e){var t=e();return t&&t.then?t.then(function(e){return o.ui.$freeze=!1,o.ui.resize(),e}):(o.ui.$freeze=!1,o.ui.resize()),t});var n=o.ui.baselayout.prototype.addView,r=o.ui.baselayout.prototype.removeView,a={addView:function(e,t){if(this.$scope&&this.$scope.webixJet){var o=this.$scope,i={};e=o.app.copyConfig(e,{},i),n.apply(this,[e,t]);for(var r in i)!function(e){o._renderFrame(e,i[e],o.getUrl()).then(function(){o._subs[e]=i[e]})}(r);return e.id}return n.apply(this,arguments)},removeView:function(){if(r.apply(this,arguments),this.$scope&&this.$scope.webixJet){var e=this.$scope._subs;for(var t in e)webix.$$(e[t].id)||delete e[t]}}};o.extend(o.ui.layout.prototype,a,!0),o.extend(o.ui.baselayout.prototype,a,!0),webix.protoUI({name:"jetapp",$init:function(e){this.$app=new this.app(e);var t=webix.uid().toString();e.body={id:t},this.$ready.push(function(){this.$app.render(webix.$$(t))})}},webix.ui.proxy)},function(e,t,o){function i(e){return o(n(e))}function n(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./analysis_outgoing_calls":55,"./analysis_outgoing_calls.js":55,"./app":56,"./app.js":56,"./call_recording":58,"./call_recording.js":58,"./cdr_reports":59,"./cdr_reports.js":59,"./channels":60,"./channels.js":60,"./checklist":61,"./checklist.js":61,"./clients":62,"./clients.js":62,"./compare_calls":63,"./compare_calls.js":63,"./contact_cdr_report":64,"./contact_cdr_report.js":64,"./contact_groups":65,"./contact_groups.js":65,"./cti":66,"./cti.js":66,"./daily_report":67,"./daily_report.js":67,"./dashboard":68,"./dashboard.js":68,"./ext_dashboard":69,"./ext_dashboard.js":69,"./ext_incoming_external":70,"./ext_incoming_external.js":70,"./ext_incoming_internal":71,"./ext_incoming_internal.js":71,"./ext_outgoing":72,"./ext_outgoing.js":72,"./grouped_reports":73,"./grouped_reports.js":73,"./grouped_reports_by_agents":74,"./grouped_reports_by_agents.js":74,"./groups":75,"./groups.js":75,"./hourly_load":76,"./hourly_load.js":76,"./interval_reports":77,"./interval_reports.js":77,"./lost_calls":78,"./lost_calls.js":78,"./main":79,"./main.js":79,"./menu":19,"./menu.js":19,"./menus/list":80,"./menus/list.js":80,"./menus/profile":5,"./menus/profile.js":5,"./menus/sidebar":6,"./menus/sidebar.js":6,"./models/analysis_outgoing_calls_layout":81,"./models/analysis_outgoing_calls_layout.js":81,"./models/call_recording_tables":9,"./models/call_recording_tables.js":9,"./models/cdr_report_tables":10,"./models/cdr_report_tables.js":10,"./models/clientwnd":35,"./models/clientwnd.js":35,"./models/contact_cdr_report":11,"./models/contact_cdr_report.js":11,"./models/contact_group_wnd":39,"./models/contact_group_wnd.js":39,"./models/daily_reports":12,"./models/daily_reports.js":12,"./models/groupwnd":37,"./models/groupwnd.js":37,"./models/interval_reports_main":17,"./models/interval_reports_main.js":17,"./models/lost_calls":18,"./models/lost_calls.js":18,"./models/menudata":20,"./models/menudata.js":20,"./models/operators_work_report":45,"./models/operators_work_report.js":45,"./models/phonesTable":46,"./models/phonesTable.js":46,"./models/record_contact_center":47,"./models/record_contact_center.js":47,"./models/settings_wnd":2,"./models/settings_wnd.js":2,"./modules/agents_grouped_reports_filter":44,"./modules/agents_grouped_reports_filter.js":44,"./modules/channels_toolbar":42,"./modules/channels_toolbar.js":42,"./modules/checklist_toolbar":29,"./modules/checklist_toolbar.js":29,"./modules/clients_toolbar":32,"./modules/clients_toolbar.js":32,"./modules/compare_calls_toolbar":25,"./modules/compare_calls_toolbar.js":25,"./modules/contact_groups_toolbar":38,"./modules/contact_groups_toolbar.js":38,"./modules/daily_report_toolbar":22,"./modules/daily_report_toolbar.js":22,"./modules/dashboard_toolbar":30,"./modules/dashboard_toolbar.js":30,"./modules/dashboardnps":82,"./modules/dashboardnps.js":82,"./modules/ext_dashboard_calls":16,"./modules/ext_dashboard_calls.js":16,"./modules/ext_dashboard_charts":15,"./modules/ext_dashboard_charts.js":15,"./modules/ext_dashboard_gages":13,"./modules/ext_dashboard_gages.js":13,"./modules/ext_dashboard_managers":14,"./modules/ext_dashboard_managers.js":14,"./modules/ext_incoming_external_toolbar":26,"./modules/ext_incoming_external_toolbar.js":26,"./modules/ext_incoming_internal_toolbar":27,"./modules/ext_incoming_internal_toolbar.js":27,"./modules/ext_outgoing_toolbar":28,"./modules/ext_outgoing_toolbar.js":28,"./modules/grouped_reports_filter":83,"./modules/grouped_reports_filter.js":83,"./modules/groups_toolbar":36,"./modules/groups_toolbar.js":36,"./modules/hourly_traffic_toolbar":24,"./modules/hourly_traffic_toolbar.js":24,"./modules/interval_reports_filter":21,"./modules/interval_reports_filter.js":21,"./modules/month_traffic_toolbar":23,"./modules/month_traffic_toolbar.js":23,"./modules/npsTooltip":84,"./modules/npsTooltip.js":84,"./modules/phones_toolbar":40,"./modules/phones_toolbar.js":40,"./modules/queues_toolbar":41,"./modules/queues_toolbar.js":41,"./modules/reports_toolbar":31,"./modules/reports_toolbar.js":31,"./modules/scripts_toolbar":43,"./modules/scripts_toolbar.js":43,"./modules/users_toolbar":34,"./modules/users_toolbar.js":34,"./month_traffic":85,"./month_traffic.js":85,"./nps/DetrProm":48,"./nps/DetrProm.js":48,"./nps/clientsTable":86,"./nps/clientsTable.js":86,"./nps/npscity":49,"./nps/npscity.js":49,"./nps/npsfilial":50,"./nps/npsfilial.js":50,"./nps/reportsTable":51,"./nps/reportsTable.js":51,"./npsdashboard":87,"./npsdashboard.js":87,"./operators_work_report":88,"./operators_work_report.js":88,"./outgoingcampaign":3,"./outgoingcampaign/":3,"./outgoingcampaign/form":89,"./outgoingcampaign/form.js":89,"./outgoingcampaign/index":3,"./outgoingcampaign/index.js":3,"./outgoingcampaign/outgoingcampaigns":90,"./outgoingcampaign/outgoingcampaigns.js":90,"./outgoingcampaign/ruleswnd":1,"./outgoingcampaign/ruleswnd.js":1,"./outgoingcampaign/toolbar":33,"./outgoingcampaign/toolbar.js":33,"./phone":91,"./phone.js":91,"./phones":92,"./phones.js":92,"./queues":93,"./queues.js":93,"./record_contact_center":94,"./record_contact_center.js":94,"./reports":95,"./reports.js":95,"./script":96,"./script.js":96,"./scripts":97,"./scripts.js":97,"./users":98,"./users.js":98,"./webix/ckeditor":99,"./webix/ckeditor.js":99,"./webix/icon":7,"./webix/icon.js":7,"./webix/menutree":8,"./webix/menutree.js":8,"./webix/scheduler":100,"./webix/scheduler.js":100};i.keys=function(){return Object.keys(r)},i.resolve=n,e.exports=i,i.id=112},function(e,t,o){"use strict";!function(){function e(e,t){this.name=t.storeName||t.id+":route",this.cb=e}e.prototype.set=function(e,t){var o=this;webix.storage.session.put(this.name,e),t&&t.silent||setTimeout(function(){return o.cb(e)},1)},e.prototype.get=function(){return webix.storage.session.get(this.name)}}()},function(e,t,o){"use strict";!function(){function e(e,t){var o=this;this.cb=e,window.onpopstate=function(){return o.cb(o.get())},this.prefix=t.routerPrefix||""}e.prototype.set=function(e,t){var o=this;this.get()!==e&&window.history.pushState(null,null,this.prefix+e),t&&t.silent||setTimeout(function(){return o.cb(e)},1)},e.prototype.get=function(){var e=window.location.pathname.replace(this.prefix,"");return"/"!==e?e:""}}()},function(e,t,o){"use strict";!function(){function e(e,t){this.path="",this.cb=e}e.prototype.set=function(e,t){var o=this;this.path=e,t&&t.silent||setTimeout(function(){return o.cb(e)},1)},e.prototype.get=function(){return this.path}}()},function(e,t,o){"use strict";function i(e,t,o){t.on(e,"app:guard",function(e,i,n){if(i===t||i.contains(t)){var r=o();n.confirm=!1===r?Promise.reject(r):n.confirm.then(function(){return r})}})}t.a=i},function(e,t,o){"use strict";function i(e,t,i){i=i||{};var n=i.storage,a=n?n.get("lang")||"en":i.lang||"en",l={_:null,polyglot:null,getLang:function(){return a},setLang:function(t,s){var c=(i.path?i.path+"/":"")+t,u=o(119)("./"+c);u.__esModule&&(u=u.default);var d=l.polyglot=new r.a({phrases:u});d.locale(t),l._=webix.bind(d.t,d),a=t,n&&n.put("lang",a),s||e.refresh()}};e.setService("locale",l),l.setLang(a,!0)}t.a=i;var n=o(118),r=o.n(n)},function(e,t,o){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function n(e,t,o){for(var n in e)i(e,n)&&t.call(o||e,e[n],n,e)}function r(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function a(e){e="Warning: "+e,"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}function l(e){var t={};return n(e,function(e,o){n(e,function(e){t[e]=o})}),t}function s(e){var t=l(v);return t[e]||t[w.call(e,/-/,1)[0]]||t.en}function c(e,t){return m[s(e)](t)}function u(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(e){var t=e&&e.prefix||"%{",o=e&&e.suffix||"}";if(t===g||o===g)throw new RangeError('"'+g+'" token is reserved for pluralization');return new RegExp(u(t)+"(.*?)"+u(o),"g")}function p(e,t,o,n){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var a=e,l=n||$,s="number"==typeof t?{smart_count:t}:t;if(null!=s.smart_count&&a){var u=w.call(a,g);a=r(u[c(o||"en",s.smart_count)]||u[0])}return a=b.call(a,l,function(e,t){return i(s,t)&&null!=s[t]?b.call(s[t],y,x):e})}function f(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var o=t.allowMissing?p:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:o,this.warn=t.warn||a,this.tokenRegex=d(t.interpolation)}var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b=String.prototype.replace,w=String.prototype.split,g="||||",_=function(e){var t=e%10;return 11!==e&&1===t?0:2<=t&&t<=4&&!(e>=12&&e<=14)?1:2},m={arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:_,chinese:function(){return 0},croatian:_,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:_,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},v={arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]},y=/\$/g,x="$$",$=/%\{(.*?)\}/g;f.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},f.prototype.extend=function(e,t){n(e,function(e,o){var i=t?t+"."+o:o;"object"===(void 0===e?"undefined":h(e))?this.extend(e,i):this.phrases[i]=e},this)},f.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:n(e,function(e,o){var i=t?t+"."+o:o;"object"===(void 0===e?"undefined":h(e))?this.unset(e,i):delete this.phrases[i]},this)},f.prototype.clear=function(){this.phrases={}},f.prototype.replace=function(e){this.clear(),this.extend(e)},f.prototype.t=function(e,t){var o,i,n=null==t?{}:t;if("string"==typeof this.phrases[e])o=this.phrases[e];else if("string"==typeof n._)o=n._;else if(this.onMissingKey){var r=this.onMissingKey;i=r(e,n,this.currentLocale,this.tokenRegex)}else this.warn('Missing translation for key: "'+e+'"'),i=e;return"string"==typeof o&&(i=p(o,n,this.currentLocale,this.tokenRegex)),i},f.prototype.has=function(e){return i(this.phrases,e)},f.transformPhrase=function(e,t,o){return p(e,t,o)},e.exports=f},function(e,t,o){function i(e){return o(n(e))}function n(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./en":101,"./en.js":101,"./ru":102,"./ru.js":102};i.keys=function(){return Object.keys(r)},i.resolve=n,e.exports=i,i.id=119},function(e,t,o){"use strict";function i(e,t,o){t.urls&&(o=t.urls[o]||o),e.show("./"+o)}function n(e,t,o){var n=t.$$(o.id||o),r=!1;n.attachEvent("onchange",function(){r||i(t,o,this.getValue())}),n.attachEvent("onafterselect",function(){if(!r){var e=null;n.setValue?e=this.getValue():n.getSelectedId&&(e=n.getSelectedId()),i(t,o,e)}}),t.on(e,"app:route",function(e){var o=e[t.getIndex()];if(o){r=!0;var i=o.page;n.setValue&&n.getValue()!==i?n.setValue(i):n.select&&n.exists(i)&&n.getSelectedId()!==i&&n.select(i),r=!1}})}t.a=n},function(e,t,o){"use strict";function i(e,t,o){function i(e){var i=t.$$(o.target);i&&(e||(e="<div class='status_"+f+"'><span class='webix_icon fa-"+_[f]+"'></span> "+g[f]+"</div>"),i.setHTML(e))}function a(){h--,d("good")}function l(e){h--,d("error",e)}function s(e){h++,d("saving"),e&&e.then&&e.then(a,l)}function c(){return f}function u(){0===h&&i(" ")}function d(t,o){h<0&&(h=0),"saving"===t?(f="saving",i()):(b="error"===t,0===h&&(f=b?"error":"good",b?e.error("app:error:server",[o.responseText||o]):w&&setTimeout(u,w),i()))}function p(e){var o=webix.dp(e);o&&(t.on(o,"onAfterDataSend",s),t.on(o,"onAfterSaveError",function(e,t,o){return l(o)}),t.on(o,"onAfterSave",a))}var f="good",h=0,b=!1,w=o.expire;w||!1===w||(w=2e3);var g=o.texts||r,_=o.icons||n;"string"==typeof o&&(o={target:o}),e.setService("status",{getStatus:c,setStatus:d,track:p}),o.remote&&t.on(webix,"onRemoteCall",s),o.ajax&&t.on(webix,"onBeforeAjax",function(e,t,o,i,n,r,a){s(a)}),o.data&&p(o.data)}t.a=i;var n={good:"check",error:"warning",saving:"refresh fa-spin"},r={good:"Ok",error:"Error",saving:"Connecting..."}},function(e,t,o){"use strict";function i(e,t,o){o=o||{};var i=o.storage,n=i?i.get("theme")||"flat-default":o.theme||"flat-default",r={getTheme:function(){return n},setTheme:function(t,o){for(var r=t.split("-"),a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var s=a[l].getAttribute("title");s&&(s===t||s===r[0]?a[l].disabled=!1:a[l].disabled=!0)}webix.skin.set(r[0]),webix.html.removeCss(document.body,"theme-"+n),webix.html.addCss(document.body,"theme-"+t),n=t,i&&i.put("theme",t),o||e.refresh()}};e.setService("theme",r),r.setTheme(n,!0)}t.a=i},function(e,t,o){"use strict";function i(e,t,o){for(var i=0;i<o.length;i++)e.setParam(o[i],t[i+1]?t[i+1].page:"")}function n(e,t,o){var n=o.route||o;t.on(e,"app:urlchange",function(e,o){t===e&&(i(t,o,n),o.splice(1,n.length))}),t.on(e,"app:paramchange",function(e,o,i,r){if(t===e&&r)for(var a=0;a<n.length;a++)if(n[a]===o)return t.show([a,i]),!1}),i(t,t.getUrl(),n)}t.a=n},function(e,t,o){"use strict";function i(e,t,o){function i(e,t){e===r?(d.logout(),t.redirect=l):e===n||d.getStatus()||(t.redirect=n)}o=o||{};var n=o.login||"/login",r=o.logout||"/logout",a=o.afterLogin||e.config.start,l=o.afterLogout||"/login",s=o.ping||3e5,c=o.model,u=o.user,d={getUser:function(){return u},getStatus:function(e){return e?c.status().catch(function(){return null}).then(function(e){u=e}):null!==u},login:function(t,o){return c.login(t,o).then(function(t){if(u=t,!t)throw new Error("Access denied");e.callEvent("app:user:login",[u]),e.show(a)})},logout:function(){return u=null,c.logout().then(function(t){return e.callEvent("app:user:logout",[]),t})}};e.setService("user",d),e.attachEvent("app:guard",function(e,t,o){return void 0===u&&(o.confirm=d.getStatus(!0).then(function(){return i(e,o)})),i(e,o)}),s&&setInterval(function(){return d.getStatus(!0)},s)}t.a=i},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}o.d(t,"a",function(){return n});var n=function(){function e(){i(this,e),this.filter_grouped_reports=1,this.queue_grouped_reports="",this.type_grouped_reports=1}return e.prototype.yesterday=function(e){return e.setDate(e.getDate()-1),e},e.prototype.hideAllToolbars=function(){$$("analysis_outgoing_calls_toolbar").hide(),$$("grouped_reports_toolbar").hide(),$$("phoneExcelButton").hide(),$$("lost_calls_toolbar").hide(),$$("agents_grouped_reports_filter").hide(),$$("operators_work_report_toolbar").hide(),$$("interval_reports_toolbar").hide(),$$("daily_report_toolbar").hide(),$$("month_traffic_toolbar").hide(),$$("hourly_traffic_toolbar").hide(),$$("compare_calls_toolbar").hide(),$$("ext_incoming_external_toolbar").hide(),$$("ext_incoming_internal_toolbar").hide(),$$("ext_outgoing_toolbar").hide(),$$("checklist_toolbar").hide(),$$("dashboard_toolbar").hide(),$$("reports_toolbar").hide(),$$("outgoingcampaign-toolbar").hide(),$$("users_toolbar").hide(),$$("groups_toolbar").hide(),$$("contact_groups_toolbar").hide(),$$("phones_toolbar").hide(),$$("queues_toolbar").hide(),$$("channels_toolbar").hide(),$$("scripts_toolbar").hide(),$$("clients_toolbar").hide()},e.prototype.loadUserTable=function(){$$("users").load("/users/list")},e.prototype.contact_lost_calls_refresh=function(){$$("lost_calls").enable(),$$("lost_calls_list").enable();var e=$$("startDate_lost_calls").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_lost_calls").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":59",a={t1:o,t2:r},l="filter[t1]="+a.t1+"&filter[t2]="+a.t2;$$("lost_calls_list").showProgress(),$$("lost_calls").showProgress(),webix.ajax().get("legacy/lost_calls_total",l,{error:function(e,t,o){$$("lost_calls_list").hideProgress(),$$("lost_calls").hideProgress(),webix.message({type:"error",text:"Произошла ошибка при получении данных."})},success:function(e,t,o){var i=t.json();$$("lost_calls_list").clearAll(),i.data.lost_cals&&$$("lost_calls_list").parse(i.data.lost_cals),$$("lost_calls").clearAll(),i.data&&$$("lost_calls").parse(i.data),$$("lost_calls_list").hideProgress(),$$("lost_calls").hideProgress()}}),$$("startDate_lost_calls").setValue(""),$$("finishDate_lost_calls").setValue(""),$$("startDate_lost_calls").setValue(dateSetHM(new Date,7,0)),$$("finishDate_lost_calls").setValue(dateSetHM(new Date,20,0))},e.prototype.contact_grouped_reports_refresh=function(){var e=$$("startDate_grouped_reports").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_grouped_reports").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":59",a={t1:o,t2:r},l="?filter[t1]="+a.t1+"&filter[t2]="+a.t2,s="/legacy/grouped_reports_total_chart";$$("grouped_reports").load(s+"1"+l),$$("grouped_reports2").load(s+"2"+l),$$("grouped_reports3").load(s+"3"+l),$$("grouped_reports4").load(s+"4"+l),$$("grouped_reports5").load(s+"5"+l),$$("grouped_reports6").load(s+"6"+l),$$("grouped_reports7").load(s+"7"+l),$$("startDate_grouped_reports").setValue(""),$$("finishDate_grouped_reports").setValue(""),$$("startDate_grouped_reports").setValue(dateSetHM(new Date,7,0)),$$("finishDate_grouped_reports").setValue(dateSetHM(new Date,20,0)),this.filter_grouped_reports=1,this.queue_grouped_reports="",this.type_grouped_reports=1,$$("option_grouped_reports").define("badge",0),$$("option_grouped_reports").define("label",translate("Add options")),$$("option_grouped_reports").define("icon","plus"),$$("option_grouped_reports").refresh(),$$("grouped_reports_layout").showBatch(1)},e.prototype.billing_analysis_outgoing_calls_refresh=function(){var e=$$("startDate_analysis_outgoing_calls").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_analysis_outgoing_calls").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":59",a="?filter[t1]="+o+"&filter[t2]="+r;$$("traffic_for_period").load("/legacy/traffic_for_period"+a),$$("popular_city_for_period").load("/legacy/popular_city_for_period"+a),$$("popular_longdistance_over_period").load("/legacy/popular_longdistance_over_period"+a),$$("popular_cell_for_period").load("/legacy/popular_cell_for_period"+a),$$("most_calling_employees_for_period").load("/legacy/most_calling_employees_for_period"+a)},e.prototype.contact_operators_work_report_refresh=function(){var e=$$("startDate_operators_work_report").getValue(),t=e.getMonth()+1,o=e.getFullYear()+"-"+t+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds(),i=$$("finishDate_operators_work_report").getValue(),n=i.getMonth()+1,r=i.getFullYear()+"-"+n+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":59",a="?filter[t1]="+o+"&filter[t2]="+r;$$("operators_work_report").load("/legacy/operators_work_report"+a),$$("operators_work_report_list").load("legacy/operators_work_report_list"+a)},e.prototype.checklistFillWindow=function(e,t,o){var i;webix.ui((i={id:"checklist_fill_win",view:"window",title:"",head:{view:"button",label:"Закрыть",width:70,click:"$$('checklist_fill_win').close();"}},i.head={view:"toolbar",margin:-4,cols:[{view:"label",label:o?"Результаты заполнения чеклиста":"Заполнение чеклиста"},{view:"icon",icon:"wxi-close-circle",click:"$$('checklist_fill_win').close();"}]},i.resize=!0,i.width=700,i.height=500,i.center=!0,i.position="center",i.modal=!0,i.move=!0,i.body={rows:[{view:"datepicker",label:"Дата",labelWidth:100,labelAlign:"right",editable:!0,timepicker:!1,format:"%D, %d.%m.%Y",value:o?t:new Date,id:"questions_answers_date",stringResult:!1},{view:"richselect",id:"questions_answers_agent",label:"Менеджер",labelWidth:100,labelAlign:"right",options:"/legacy/ext_dashboard_agentslist/"+e+"/short"},{view:"richselect",id:"questions_answers_checklist",label:"Группа",labelWidth:100,labelAlign:"right",options:"/legacy/ext/checklists/groups/",on:{onChange:function(e,t){$$("questions_answers").clearAll();var o=$$("questions_answers_checklist_block");o.getList().clearAll(),o.getList().load("/legacy/ext/checklists/groups/"+e),o.setValue(0),o.show()}}},{view:"richselect",id:"questions_answers_checklist_block",label:"Блок",labelWidth:100,labelAlign:"right",options:[],hidden:!0,on:{onChange:function(o,i){$$("questions_answers").clearAll(),o?($$("questions_answers").load("/legacy/ext/checklist/list/"+o+"/"+e+"/"+t),$$("questions_answers_save").enable()):$$("questions_answers_save").disable()}}},{view:"datatable",id:"questions_answers",autowidth:!0,editable:!0,columns:[{id:"question",header:"Вопрос",width:250},{id:"answer",header:"Ответ",width:80,editor:"select",options:["0","3","5"]},{id:"comment",header:"Комментарий",width:250,editor:"text"}],on:{onItemClick:function(e){this.editColumn(e),this.focusEditor(e)}}},{cols:[{id:"questions_answers_save",view:"button",label:"Сохранить",disable:!0,click:function(){var e=[];$$("questions_answers").editStop();var t=$$("questions_answers_agent").getValue();$$("questions_answers").data.each&&$$("questions_answers").data.each(function(o){o.user_id=t,e.push(o)});var o=JSON.stringify(e),i=webix.Date.dateToStr("%Y-%m-%d")($$("questions_answers_date").getValue());webix.ajax().post("/legacy/ext/checklists/fill/"+i,o,{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при сохранении."})},success:function(e,t,o){webix.message({type:"success",text:"Операция сохранения успешно завершена."}),$$("checklist_fill_win").close()}})}},{view:"button",label:"Закрыть",click:"$$('checklist_fill_win').close();"},{view:"button",id:"delete_change_answers",label:"Удалить запись",click:function(){var e=[];$$("questions_answers").editStop();$$("questions_answers_agent").getValue();$$("questions_answers").data.each&&$$("questions_answers").data.each(function(t){e.push(t)});var t=JSON.stringify(e);webix.Date.dateToStr("%Y-%m-%d")($$("questions_answers_date").getValue());webix.ajax().post("/legacy/ext/checklist/deleteanswer",t,{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при удалении"})},success:function(e,t,o){webix.message({type:"success",text:"Успешно удалено."}),$$("checklist_fill_win").close();var i=$$("ext_checklist_table"),n=i.getSelectedItem();i.remove(n.id);var r=$$("ext_checklist_start").getValue(),a=$$("ext_checklist_finish").getValue();i.load("/legacy/ext/checklist/tree/"+r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()+"/"+a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+"/"+n.$parent)}})}},{view:"button",id:"save_change_answers",label:"Сохранить изменения",click:function(){var t=[];$$("questions_answers").editStop();$$("questions_answers_agent").getValue();$$("questions_answers").data.each&&$$("questions_answers").data.each(function(o){o.user_id=e,t.push(o)});var o=JSON.stringify(t),i=webix.Date.dateToStr("%Y-%m-%d")($$("questions_answers_date").getValue());webix.ajax().post("/legacy/ext/checklists/change/"+i,o,{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при изменении."})},success:function(e,t,o){webix.message({type:"success",text:"Успешно изменено."}),$$("checklist_fill_win").close();var n=$$("ext_checklist_table"),r=n.getSelectedItem();i!=r.date&&n.remove(r.id),1==r.open&&n.remove(r.id);var a=$$("ext_checklist_start").getValue(),l=$$("ext_checklist_finish").getValue();n.load("/legacy/ext/checklist/tree/"+a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+"/"+l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()+"/"+r.$parent)}})}}]}]},i.on={onShow:function(){0==o&&($$("delete_change_answers").hide(),$$("save_change_answers").hide()),0!=o&&($$("questions_answers").clearAll(),$$("questions_answers").load("/legacy/ext/checklist/list/"+o+"/"+e+"/"+t),$$("questions_answers_save").hide(),$$("questions_answers_agent").hide(),$$("questions_answers_checklist").hide(),$$("questions_answers_checklist_block").hide())}},i)).show()},e.prototype.getNpsFilter=function(){if($$("rangePickerFilter")){var e=$$("rangePickerFilter").getValue();if(e.start)var t=webix.Date.dateToStr("%Y-%m-%d %H:%i:%s")(new Date(e.start));if(e.end)var o=webix.Date.dateToStr("%Y-%m-%d %H:%i:%s")(new Date(e.end))}if($$("filialFilter"))var i=$$("filialFilter").getText();if($$("cityFilter"))var n=$$("cityFilter").getText();if($$("channel"))var r=$$("channel").getText();webix.ajax().headers({"Content-type":"application/json"}).get("legacy/nps/count",{filter:{end:o,start:t,city:n,filial:i,channel:r}},{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при выполнении запроса.<br/>"+e})},success:function(e,t,o){var i=t.json();$$("countList").clearAll(),$$("countList").parse(i)}}),webix.ajax().headers({"Content-type":"application/json"}).get("legacy/nps/count",{filter:{end:o,start:t,city:n,filial:i,channel:r},byCities:1},{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при выполнении запроса.<br/>"+e})},success:function(e,t,o){var i=t.json();$$("countListByCities").clearAll(),$$("countListByCities").parse(i)}}),webix.ajax().headers({"Content-type":"application/json"}).get("legacy/nps/promoters",{filter:{end:o,start:t,city:n,filial:i,channel:r}},{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при выполнении запроса.<br/>"+e})},success:function(e,a,l){webix.ajax().headers({"Content-type":"application/json"}).get("legacy/nps/detractors",{filter:{end:o,start:t,city:n,filial:i,channel:r}},{error:function(e,t,o){webix.message({type:"error",text:"Произошла ошибка при выполнении запроса.<br/>"+e})},success:function(e,t,o){var i=a.json(),n=t.json(),r=[],l=[];if(n&&i){for(var s in n)n[s].sales==i[s].sales&&0==i[s].sales||(r.push(i[s]),l.push(n[s]));$$("detractorsList").clearAll(),$$("detractorsList").parse(l),$$("promotersList").clearAll(),$$("promotersList").parse(r)}}})}})},e.prototype.getPdfChart=function(e){webix.require("https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js").then(function(){domtoimage.toJpeg($$(e).$view,{quality:.95,bgcolor:"#fff"}).then(function(e){pdfjs.load("//cdn.webix.com//extras/pt-sans.regular.ttf",function(t,o){var i=new pdfjs.Document;pdfjs.load(e,function(e,t){var o=new pdfjs.Image(t);i.image(o);var n=i.render(),r=new Blob([n.toString()],{type:"application/pdf"}),a=$$("rangePickerFilter").getValue();if(a.start)var l=webix.Date.dateToStr("%d.%m.%Y")(new Date(a.start));else if(a.end)var l=webix.Date.dateToStr("%d.%m%Y")(new Date(a.end));if(a.end)var s=webix.Date.dateToStr("%d.%m%Y")(new Date(a.end));else var s=l;webix.html.download(r,"NPS_Dashboard_"+l+"-"+s+".pdf")})})})})},e.prototype.getUrlParameter=function(e){var t,o,i=decodeURIComponent(window.location.search.substring(1)),n=i.split("&");for(o=0;o<n.length;o++)if(t=n[o].split("="),t[0]===e)return void 0===t[1]||t[1]},e}()}]);